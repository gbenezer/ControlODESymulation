<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>visualization.controlplotter – ControlDESymulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-64209fde6f94c7ab255c4d888f9dae80.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ControlDESymulation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/installation.qmd"> 
<span class="menu-text">Installation Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-architecture" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Architecture</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-architecture">    
        <li>
    <a class="dropdown-item" href="../architecture/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../architecture/cdesym_Design_Philosophy.html">
 <span class="dropdown-text">ControlDESymulation: Design Philosophy and Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/UI_Framework_Architecture.html">
 <span class="dropdown-text">UI Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Type_System_Architecture.html">
 <span class="dropdown-text">Type System Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Integration_Framework_Architecture.html">
 <span class="dropdown-text">Integration Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Control_Framework_Architecture.html">
 <span class="dropdown-text">Control Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Visualization_Framework_Architecture.html">
 <span class="dropdown-text">Visualization Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Delegation_Layer_Architecture.html">
 <span class="dropdown-text">Delegation Layer Architecture</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li class="dropdown-header">tutorials/basic_usage.qmd</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li class="dropdown-header">examples/pendulum_control.qmd</li>
        <li class="dropdown-header">examples/cartpole_swingup.qmd</li>
        <li class="dropdown-header">examples/quadrotor_lqr.qmd</li>
        <li class="dropdown-header">examples/cstr_multiplicity.qmd</li>
        <li class="dropdown-header">examples/lorenz_chaos.qmd</li>
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../api/index.html"> 
<span class="menu-text">API Reference</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gilbenezer/ControlDESymulation"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cdesym.visualization.ControlPlotter" id="toc-cdesym.visualization.ControlPlotter" class="nav-link active" data-scroll-target="#cdesym.visualization.ControlPlotter">visualization.ControlPlotter</a>
  <ul>
  <li><a href="#attributes" id="toc-attributes" class="nav-link" data-scroll-target="#attributes">Attributes</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul>
  <li><a href="#cdesym.visualization.ControlPlotter.list_available_color_schemes" id="toc-cdesym.visualization.ControlPlotter.list_available_color_schemes" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.list_available_color_schemes">list_available_color_schemes</a>
  <ul class="collapse">
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns</a></li>
  <li><a href="#examples-1" id="toc-examples-1" class="nav-link" data-scroll-target="#examples-1">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.list_available_themes" id="toc-cdesym.visualization.ControlPlotter.list_available_themes" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.list_available_themes">list_available_themes</a>
  <ul class="collapse">
  <li><a href="#returns-1" id="toc-returns-1" class="nav-link" data-scroll-target="#returns-1">Returns</a></li>
  <li><a href="#examples-2" id="toc-examples-2" class="nav-link" data-scroll-target="#examples-2">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_controllability_gramian" id="toc-cdesym.visualization.ControlPlotter.plot_controllability_gramian" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_controllability_gramian">plot_controllability_gramian</a>
  <ul class="collapse">
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#returns-2" id="toc-returns-2" class="nav-link" data-scroll-target="#returns-2">Returns</a></li>
  <li><a href="#examples-3" id="toc-examples-3" class="nav-link" data-scroll-target="#examples-3">Examples</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_eigenvalue_map" id="toc-cdesym.visualization.ControlPlotter.plot_eigenvalue_map" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_eigenvalue_map">plot_eigenvalue_map</a>
  <ul class="collapse">
  <li><a href="#parameters-1" id="toc-parameters-1" class="nav-link" data-scroll-target="#parameters-1">Parameters</a></li>
  <li><a href="#returns-3" id="toc-returns-3" class="nav-link" data-scroll-target="#returns-3">Returns</a></li>
  <li><a href="#examples-4" id="toc-examples-4" class="nav-link" data-scroll-target="#examples-4">Examples</a></li>
  <li><a href="#notes-1" id="toc-notes-1" class="nav-link" data-scroll-target="#notes-1">Notes</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See Also</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_frequency_response" id="toc-cdesym.visualization.ControlPlotter.plot_frequency_response" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_frequency_response">plot_frequency_response</a>
  <ul class="collapse">
  <li><a href="#parameters-2" id="toc-parameters-2" class="nav-link" data-scroll-target="#parameters-2">Parameters</a></li>
  <li><a href="#returns-4" id="toc-returns-4" class="nav-link" data-scroll-target="#returns-4">Returns</a></li>
  <li><a href="#examples-5" id="toc-examples-5" class="nav-link" data-scroll-target="#examples-5">Examples</a></li>
  <li><a href="#notes-2" id="toc-notes-2" class="nav-link" data-scroll-target="#notes-2">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_gain_comparison" id="toc-cdesym.visualization.ControlPlotter.plot_gain_comparison" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_gain_comparison">plot_gain_comparison</a>
  <ul class="collapse">
  <li><a href="#parameters-3" id="toc-parameters-3" class="nav-link" data-scroll-target="#parameters-3">Parameters</a></li>
  <li><a href="#returns-5" id="toc-returns-5" class="nav-link" data-scroll-target="#returns-5">Returns</a></li>
  <li><a href="#examples-6" id="toc-examples-6" class="nav-link" data-scroll-target="#examples-6">Examples</a></li>
  <li><a href="#notes-3" id="toc-notes-3" class="nav-link" data-scroll-target="#notes-3">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_impulse_response" id="toc-cdesym.visualization.ControlPlotter.plot_impulse_response" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_impulse_response">plot_impulse_response</a>
  <ul class="collapse">
  <li><a href="#parameters-4" id="toc-parameters-4" class="nav-link" data-scroll-target="#parameters-4">Parameters</a></li>
  <li><a href="#returns-6" id="toc-returns-6" class="nav-link" data-scroll-target="#returns-6">Returns</a></li>
  <li><a href="#examples-7" id="toc-examples-7" class="nav-link" data-scroll-target="#examples-7">Examples</a></li>
  <li><a href="#notes-4" id="toc-notes-4" class="nav-link" data-scroll-target="#notes-4">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_nyquist" id="toc-cdesym.visualization.ControlPlotter.plot_nyquist" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_nyquist">plot_nyquist</a>
  <ul class="collapse">
  <li><a href="#parameters-5" id="toc-parameters-5" class="nav-link" data-scroll-target="#parameters-5">Parameters</a></li>
  <li><a href="#returns-7" id="toc-returns-7" class="nav-link" data-scroll-target="#returns-7">Returns</a></li>
  <li><a href="#examples-8" id="toc-examples-8" class="nav-link" data-scroll-target="#examples-8">Examples</a></li>
  <li><a href="#notes-5" id="toc-notes-5" class="nav-link" data-scroll-target="#notes-5">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_observability_gramian" id="toc-cdesym.visualization.ControlPlotter.plot_observability_gramian" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_observability_gramian">plot_observability_gramian</a>
  <ul class="collapse">
  <li><a href="#parameters-6" id="toc-parameters-6" class="nav-link" data-scroll-target="#parameters-6">Parameters</a></li>
  <li><a href="#returns-8" id="toc-returns-8" class="nav-link" data-scroll-target="#returns-8">Returns</a></li>
  <li><a href="#examples-9" id="toc-examples-9" class="nav-link" data-scroll-target="#examples-9">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_riccati_convergence" id="toc-cdesym.visualization.ControlPlotter.plot_riccati_convergence" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_riccati_convergence">plot_riccati_convergence</a>
  <ul class="collapse">
  <li><a href="#parameters-7" id="toc-parameters-7" class="nav-link" data-scroll-target="#parameters-7">Parameters</a></li>
  <li><a href="#returns-9" id="toc-returns-9" class="nav-link" data-scroll-target="#returns-9">Returns</a></li>
  <li><a href="#examples-10" id="toc-examples-10" class="nav-link" data-scroll-target="#examples-10">Examples</a></li>
  <li><a href="#notes-6" id="toc-notes-6" class="nav-link" data-scroll-target="#notes-6">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_root_locus" id="toc-cdesym.visualization.ControlPlotter.plot_root_locus" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_root_locus">plot_root_locus</a>
  <ul class="collapse">
  <li><a href="#parameters-8" id="toc-parameters-8" class="nav-link" data-scroll-target="#parameters-8">Parameters</a></li>
  <li><a href="#returns-10" id="toc-returns-10" class="nav-link" data-scroll-target="#returns-10">Returns</a></li>
  <li><a href="#examples-11" id="toc-examples-11" class="nav-link" data-scroll-target="#examples-11">Examples</a></li>
  <li><a href="#notes-7" id="toc-notes-7" class="nav-link" data-scroll-target="#notes-7">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.visualization.ControlPlotter.plot_step_response" id="toc-cdesym.visualization.ControlPlotter.plot_step_response" class="nav-link" data-scroll-target="#cdesym.visualization.ControlPlotter.plot_step_response">plot_step_response</a>
  <ul class="collapse">
  <li><a href="#parameters-9" id="toc-parameters-9" class="nav-link" data-scroll-target="#parameters-9">Parameters</a></li>
  <li><a href="#returns-11" id="toc-returns-11" class="nav-link" data-scroll-target="#returns-11">Returns</a></li>
  <li><a href="#examples-12" id="toc-examples-12" class="nav-link" data-scroll-target="#examples-12">Examples</a></li>
  <li><a href="#notes-8" id="toc-notes-8" class="nav-link" data-scroll-target="#notes-8">Notes</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/visualization.ControlPlotter.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7"></h1></header><div class="quarto-title-block"><div class="quarto-title-tools-only"><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>




<section id="cdesym.visualization.ControlPlotter" class="level1">
<h1>visualization.ControlPlotter</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter(backend<span class="op">=</span><span class="st">'numpy'</span>, default_theme<span class="op">=</span><span class="st">'default'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Control system analysis visualization.</p>
<p>Provides interactive Plotly-based plotting for control-specific analysis including eigenvalue maps, gain comparisons, and performance metrics.</p>
<section id="attributes" class="level2 doc-section doc-section-attributes">
<h2 class="doc-section doc-section-attributes anchored" data-anchor-id="attributes">Attributes</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>backend</td>
<td>Backend</td>
<td>Default computational backend for array conversion</td>
</tr>
<tr class="even">
<td>default_theme</td>
<td>str</td>
<td>Default plot theme to apply</td>
</tr>
</tbody>
</table>
</section>
<section id="examples" class="level2 doc-section doc-section-examples">
<h2 class="doc-section doc-section-examples anchored" data-anchor-id="examples">Examples</h2>
<p>Eigenvalue stability map:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> plotter <span class="op">=</span> ControlPlotter()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> result <span class="op">=</span> system.design_lqr(Q, R)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>...     result[<span class="st">'closed_loop_eigenvalues'</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compare LQR gains:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gains <span class="op">=</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Light Q'</span>: K1,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Heavy Q'</span>: K2,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_gain_comparison(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>...     gains,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#cdesym.visualization.ControlPlotter.list_available_color_schemes">list_available_color_schemes</a></td>
<td>List available color schemes.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.visualization.ControlPlotter.list_available_themes">list_available_themes</a></td>
<td>List available plot themes.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.visualization.ControlPlotter.plot_controllability_gramian">plot_controllability_gramian</a></td>
<td>Visualize controllability Gramian as heatmap.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.visualization.ControlPlotter.plot_eigenvalue_map">plot_eigenvalue_map</a></td>
<td>Plot eigenvalues with stability region.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.visualization.ControlPlotter.plot_frequency_response">plot_frequency_response</a></td>
<td>Plot frequency response (Bode plot).</td>
</tr>
<tr class="even">
<td><a href="#cdesym.visualization.ControlPlotter.plot_gain_comparison">plot_gain_comparison</a></td>
<td>Compare feedback gains across different designs.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.visualization.ControlPlotter.plot_impulse_response">plot_impulse_response</a></td>
<td>Plot impulse response with performance metrics.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.visualization.ControlPlotter.plot_nyquist">plot_nyquist</a></td>
<td>Plot Nyquist diagram.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.visualization.ControlPlotter.plot_observability_gramian">plot_observability_gramian</a></td>
<td>Visualize observability Gramian as heatmap.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.visualization.ControlPlotter.plot_riccati_convergence">plot_riccati_convergence</a></td>
<td>Plot Riccati equation solver convergence.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.visualization.ControlPlotter.plot_root_locus">plot_root_locus</a></td>
<td>Plot root locus (pole migration as gain varies).</td>
</tr>
<tr class="even">
<td><a href="#cdesym.visualization.ControlPlotter.plot_step_response">plot_step_response</a></td>
<td>Plot step response with performance metrics.</td>
</tr>
</tbody>
</table>
<section id="cdesym.visualization.ControlPlotter.list_available_color_schemes" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.list_available_color_schemes">list_available_color_schemes</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.list_available_color_schemes()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>List available color schemes.</p>
<section id="returns" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>List[str]</td>
<td>Available color scheme names</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-1" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-1">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> schemes <span class="op">=</span> ControlPlotter.list_available_color_schemes()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(schemes)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>[<span class="st">'plotly'</span>, <span class="st">'d3'</span>, <span class="st">'colorblind_safe'</span>, <span class="st">'tableau'</span>, ...]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.list_available_themes" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.list_available_themes">list_available_themes</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.list_available_themes()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>List available plot themes.</p>
<section id="returns-1" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>List[str]</td>
<td>Available theme names</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-2" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-2">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> themes <span class="op">=</span> ControlPlotter.list_available_themes()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(themes)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>[<span class="st">'default'</span>, <span class="st">'publication'</span>, <span class="st">'dark'</span>, <span class="st">'presentation'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_controllability_gramian" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_controllability_gramian">plot_controllability_gramian</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_controllability_gramian(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    W_c,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    state_names<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Controllability Gramian'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Visualize controllability Gramian as heatmap.</p>
<p>Shows coupling between states for controllability analysis.</p>
<section id="parameters" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 62%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>W_c</td>
<td>np.ndarray</td>
<td>Controllability Gramian, shape (nx, nx) Symmetric positive semi-definite matrix</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>state_names</td>
<td>Optional[List[str]]</td>
<td>Names for states</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Controllability Gramian'</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-2" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-2">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Gramian heatmap</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-3" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-3">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute controllability Gramian</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy.linalg <span class="im">import</span> solve_continuous_lyapunov</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> W_c <span class="op">=</span> solve_continuous_lyapunov(A, <span class="op">-</span>B <span class="op">@</span> B.T)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_controllability_gramian(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>...     W_c,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>...     state_names<span class="op">=</span>[<span class="st">'Position'</span>, <span class="st">'Velocity'</span>],</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes">Notes</h4>
<ul>
<li>Diagonal elements: controllability of individual states</li>
<li>Off-diagonal: coupling between states</li>
<li>Small eigenvalues → difficult to control</li>
<li>Can also visualize observability Gramian W_o</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_eigenvalue_map" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_eigenvalue_map">plot_eigenvalue_map</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_eigenvalue_map(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    eigenvalues,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Eigenvalue Map'</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    show_stability_margin<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    show_stability_region<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    color_scheme<span class="op">=</span><span class="st">'plotly'</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot eigenvalues with stability region.</p>
<p>Creates complex plane plot showing eigenvalue locations with stability region highlighted. Supports multiple eigenvalue sets for comparative analysis.</p>
<section id="parameters-1" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 80%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>eigenvalues</td>
<td>Union[np.ndarray, Dict[str, np.ndarray]]</td>
<td>Complex eigenvalues in one of two formats: <strong>Format 1: Single array</strong> Shape (n,) - single set of eigenvalues Use with <code>labels</code> parameter for individual point labels <strong>Format 2: Dictionary</strong> (recommended for multiple sets) Dict mapping set names to eigenvalue arrays Example: {‘Open-loop’: eigs_ol, ‘Closed-loop’: eigs_cl} Each array: shape (n_eigs,)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>system_type</td>
<td>str</td>
<td>System type determining stability criterion: - ‘continuous’: Re(λ) &lt; 0 (left half-plane stable) - ‘discrete’: |λ| &lt; 1 (inside unit circle stable)</td>
<td><code>'continuous'</code></td>
</tr>
<tr class="odd">
<td>labels</td>
<td>Optional[Union[List[str], str]]</td>
<td>Labels for eigenvalues (only used if eigenvalues is array): - <strong>List[str]</strong>: Individual label per eigenvalue, length must match - <strong>str</strong>: Single label for entire set - <strong>None</strong>: Default to “Eigenvalues” Ignored if eigenvalues is Dict (uses dict keys instead)</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Eigenvalue Map'</code></td>
</tr>
<tr class="odd">
<td>show_stability_margin</td>
<td>bool</td>
<td>If True, annotate stability margin (distance to boundary) - Continuous: margin = -max(Re(λ)) - Discrete: margin = 1 - max(|λ|)</td>
<td><code>True</code></td>
</tr>
<tr class="even">
<td>show_stability_region</td>
<td>bool</td>
<td>If True, shade stability region - Continuous: shade left half-plane (green) - Discrete: draw unit circle</td>
<td><code>True</code></td>
</tr>
<tr class="odd">
<td>color_scheme</td>
<td>str</td>
<td>Color scheme for eigenvalue sets Options: ‘plotly’, ‘d3’, ‘colorblind_safe’, ‘tableau’, etc. Used when plotting multiple sets (dict format)</td>
<td><code>'plotly'</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional customization arguments - marker_size : int - Size of eigenvalue markers (default: 12) - show_grid : bool - Show grid lines (default: True)</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-3" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-3">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Interactive eigenvalue map with stability region</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-4" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-4">Examples</h4>
<p><strong>Single set of eigenvalues:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> lqr <span class="op">=</span> system.design_lqr(Q, R)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>...     lqr[<span class="st">'closed_loop_eigenvalues'</span>],</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>...     labels<span class="op">=</span><span class="st">'Closed-loop (LQR)'</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Multiple sets using dictionary (recommended):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> eigenvalue_sets <span class="op">=</span> {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Open-loop'</span>: eigs_open,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Closed-loop (LQR)'</span>: eigs_lqr,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Closed-loop (H∞)'</span>: eigs_hinf,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>...     eigenvalue_sets,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Multiple sets using concatenation + labels:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> eigs_all <span class="op">=</span> np.concatenate([eigs_ol, eigs_cl])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> labels_all <span class="op">=</span> (</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>...     [<span class="st">'Open-loop'</span>] <span class="op">*</span> <span class="bu">len</span>(eigs_ol) <span class="op">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>...     [<span class="st">'Closed-loop'</span>] <span class="op">*</span> <span class="bu">len</span>(eigs_cl)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>...     eigs_all,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>...     labels<span class="op">=</span>labels_all,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Discrete system:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>...     discrete_lqr[<span class="st">'closed_loop_eigenvalues'</span>],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'discrete'</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Custom marker size and grid:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>...     eigenvalue_sets,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>...     marker_size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>...     show_grid<span class="op">=</span><span class="va">True</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-1" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-1">Notes</h4>
<p><strong>Stability Criteria:</strong></p>
<ul>
<li><p><strong>Continuous systems</strong>: Stable if Re(λ) &lt; 0 for all eigenvalues (left half-plane of complex plane)</p></li>
<li><p><strong>Discrete systems</strong>: Stable if |λ| &lt; 1 for all eigenvalues (inside unit circle)</p></li>
</ul>
<p><strong>Stability Margin:</strong></p>
<p>Distance from least stable eigenvalue to stability boundary:</p>
<ul>
<li><p>Continuous: margin = -max(Re(λ))</p></li>
<li><p>Positive: stable with margin</p></li>
<li><p>Negative: unstable</p></li>
<li><p>Larger is better (more robustness)</p></li>
<li><p>Discrete: margin = 1 - max(|λ|)</p></li>
<li><p>Positive: stable with margin</p></li>
<li><p>Negative: unstable</p></li>
<li><p>Larger is better</p></li>
</ul>
<p><strong>Visual Encoding:</strong></p>
<ul>
<li>Stable region: Shaded green/highlighted</li>
<li>Unstable region: Shaded red/unmarked</li>
<li>Stability boundary: Solid black line</li>
<li>Eigenvalues: Colored circles (one color per set)</li>
<li>Margin: Annotated with arrow</li>
</ul>
<p><strong>Multiple Sets:</strong></p>
<p>When comparing multiple designs: - Each set gets unique color from color_scheme - Legend shows which eigenvalues belong to which design - Useful for visualizing controller tuning effects</p>
</section>
<section id="see-also" class="level4 doc-section doc-section-see-also">
<h4 class="doc-section doc-section-see-also anchored" data-anchor-id="see-also">See Also</h4>
<p>plot_root_locus : Shows eigenvalue migration as gain varies plot_gain_comparison : Compare feedback gains</p>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_frequency_response" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_frequency_response">plot_frequency_response</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_frequency_response(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    frequencies,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    magnitude,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    phase,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Frequency Response (Bode Plot)'</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    show_margins<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot frequency response (Bode plot).</p>
<p>Creates magnitude and phase plots vs frequency, with optional gain and phase margin annotations.</p>
<section id="parameters-2" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 62%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>frequencies</td>
<td>np.ndarray</td>
<td>Frequency points in rad/s, shape (n_freq,)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>magnitude</td>
<td>np.ndarray</td>
<td>Magnitude response in dB, shape (n_freq,)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>phase</td>
<td>np.ndarray</td>
<td>Phase response in degrees, shape (n_freq,)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Frequency Response (Bode Plot)'</code></td>
</tr>
<tr class="odd">
<td>show_margins</td>
<td>bool</td>
<td>If True, annotate gain and phase margins</td>
<td><code>True</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-4" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-4">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Bode plot with magnitude and phase subplots</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-5" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-5">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute frequency response</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Closed-loop transfer function</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> A_cl <span class="op">=</span> A <span class="op">-</span> B <span class="op">@</span> K</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> sys <span class="op">=</span> signal.StateSpace(A_cl, B, C, D)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Frequency response</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1000</span>)  <span class="co"># rad/s</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w, H <span class="op">=</span> signal.freqresp(sys, w)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Convert to dB and degrees</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> mag_dB <span class="op">=</span> <span class="dv">20</span> <span class="op">*</span> np.log10(np.<span class="bu">abs</span>(H).flatten())</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> phase_deg <span class="op">=</span> np.angle(H, deg<span class="op">=</span><span class="va">True</span>).flatten()</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Plot with publication theme</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_frequency_response(</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>...     w, mag_dB, phase_deg,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-2" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-2">Notes</h4>
<ul>
<li>Magnitude in dB: 20*log10(|H(jω)|)</li>
<li>Phase in degrees: ∠H(jω)</li>
<li>Gain margin: Amount gain can increase before instability</li>
<li>Phase margin: Amount phase can decrease before instability</li>
<li>Crossover frequencies automatically detected</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_gain_comparison" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_gain_comparison">plot_gain_comparison</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_gain_comparison(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    gains,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Feedback Gain Comparison'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    color_scheme<span class="op">=</span><span class="st">'plotly'</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compare feedback gains across different designs.</p>
<p>Creates grouped bar chart or heatmap showing gain values for different control designs.</p>
<section id="parameters-3" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 61%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>gains</td>
<td>Dict[str, np.ndarray]</td>
<td>Dictionary mapping design names to gain matrices Each gain: (nu, nx) array</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>labels</td>
<td>Optional[List[str]]</td>
<td>Labels for gain entries (state names) If None, uses generic labels</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Feedback Gain Comparison'</code></td>
</tr>
<tr class="even">
<td>color_scheme</td>
<td>str</td>
<td>Color scheme name for bar charts Options: ‘plotly’, ‘d3’, ‘colorblind_safe’, ‘tableau’, etc. Default: ‘plotly’</td>
<td><code>'plotly'</code></td>
</tr>
<tr class="odd">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-5" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-5">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Gain comparison plot</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-6" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-6">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compare different Q weights with colorblind-safe colors</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gains <span class="op">=</span> {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Q=10*I'</span>: system.design_lqr(<span class="dv">10</span><span class="op">*</span>np.eye(<span class="dv">2</span>), R)[<span class="st">'gain'</span>],</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Q=100*I'</span>: system.design_lqr(<span class="dv">100</span><span class="op">*</span>np.eye(<span class="dv">2</span>), R)[<span class="st">'gain'</span>],</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Q=1000*I'</span>: system.design_lqr(<span class="dv">1000</span><span class="op">*</span>np.eye(<span class="dv">2</span>), R)[<span class="st">'gain'</span>],</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_gain_comparison(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>...     gains,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># With state labels</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_gain_comparison(</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>...     gains,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>...     labels<span class="op">=</span>[<span class="st">'Position'</span>, <span class="st">'Velocity'</span>],</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-3" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-3">Notes</h4>
<ul>
<li>Each design shown as separate bar group</li>
<li>Useful for parameter studies</li>
<li>Shows effect of Q/R tuning on gains</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_impulse_response" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_impulse_response">plot_impulse_response</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_impulse_response(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Impulse Response'</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot impulse response with performance metrics.</p>
<p>Shows closed-loop impulse response (response to Dirac delta input) with annotations for peak, decay rate, and settling characteristics.</p>
<section id="parameters-4" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-4">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 67%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>t</td>
<td>np.ndarray</td>
<td>Time points, shape (T,)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>y</td>
<td>np.ndarray</td>
<td>Output response, shape (T,) or (T, ny)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>show_metrics</td>
<td>bool</td>
<td>If True, annotate performance metrics</td>
<td><code>True</code></td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Impulse Response'</code></td>
</tr>
<tr class="odd">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-6" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-6">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Impulse response plot with metrics</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-7" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-7">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Simulate closed-loop impulse response</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># For continuous systems: y(t) = C @ expm(A_cl*t) @ B</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy.linalg <span class="im">import</span> expm</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> A_cl <span class="op">=</span> A <span class="op">-</span> B <span class="op">@</span> K</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> y <span class="op">=</span> np.array([C <span class="op">@</span> expm(A_cl <span class="op">*</span> t_i) <span class="op">@</span> B <span class="cf">for</span> t_i <span class="kw">in</span> t]).flatten()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_impulse_response(</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>...     t, y,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>...     show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># For discrete systems: simulate with impulse at k=0</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="op">=</span> np.zeros(nx)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> y_discrete <span class="op">=</span> []</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>...     u_k <span class="op">=</span> <span class="fl">1.0</span> <span class="cf">if</span> k <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.0</span>  <span class="co"># Impulse at k=0</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>...     y_discrete.append(C <span class="op">@</span> x)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>...     x <span class="op">=</span> A_cl <span class="op">@</span> x <span class="op">+</span> B <span class="op">*</span> u_k</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_impulse_response(t_discrete, np.array(y_discrete))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-4" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-4">Notes</h4>
<ul>
<li>Peak value: Maximum absolute response</li>
<li>Peak time: Time to peak</li>
<li>Decay rate: Exponential decay constant (if applicable)</li>
<li>Settling time: Time to settle within 2% of zero</li>
<li>Energy: Integral of squared response (L2 norm)</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_nyquist" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_nyquist">plot_nyquist</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_nyquist(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    real,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    imag,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    frequencies<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Nyquist Plot'</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    show_critical_point<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot Nyquist diagram.</p>
<p>Shows frequency response in complex plane, useful for stability analysis via Nyquist stability criterion.</p>
<section id="parameters-5" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-5">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 64%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>real</td>
<td>np.ndarray</td>
<td>Real part of frequency response, shape (n_freq,)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>imag</td>
<td>np.ndarray</td>
<td>Imaginary part of frequency response, shape (n_freq,)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>frequencies</td>
<td>Optional[np.ndarray]</td>
<td>Frequency points in rad/s (for hover info)</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Nyquist Plot'</code></td>
</tr>
<tr class="odd">
<td>show_critical_point</td>
<td>bool</td>
<td>If True, mark critical point (-1, 0j)</td>
<td><code>True</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-7" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-7">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Nyquist plot</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-8" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-8">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute open-loop frequency response</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Open-loop system: G(s) = C(sI - A)^(-1)B</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> sys_ol <span class="op">=</span> signal.StateSpace(A, B, C, D)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Frequency response</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1000</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w, H <span class="op">=</span> signal.freqresp(sys_ol, w)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> H <span class="op">=</span> H.flatten()</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Plot Nyquist with dark theme</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_nyquist(</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>...     np.real(H), np.imag(H), frequencies<span class="op">=</span>w,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-5" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-5">Notes</h4>
<ul>
<li>Nyquist plot: H(jω) in complex plane as ω varies</li>
<li>Critical point: (-1, 0j)</li>
<li>Stability: Number of encirclements of (-1, 0j) determines stability</li>
<li>Gain margin: Distance from curve to (-1, 0j)</li>
<li>Phase margin: Angle from curve to (-1, 0j)</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_observability_gramian" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_observability_gramian">plot_observability_gramian</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_observability_gramian(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    W_o,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    state_names<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Observability Gramian'</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Visualize observability Gramian as heatmap.</p>
<p>Shows coupling between states for observability analysis.</p>
<section id="parameters-6" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-6">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 63%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>W_o</td>
<td>np.ndarray</td>
<td>Observability Gramian, shape (nx, nx)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>state_names</td>
<td>Optional[List[str]]</td>
<td>Names for states</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Observability Gramian'</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-8" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-8">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Gramian heatmap</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-9" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-9">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute observability Gramian</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy.linalg <span class="im">import</span> solve_continuous_lyapunov</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> W_o <span class="op">=</span> solve_continuous_lyapunov(A.T, <span class="op">-</span>C.T <span class="op">@</span> C)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_observability_gramian(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>...     W_o,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_riccati_convergence" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_riccati_convergence">plot_riccati_convergence</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_riccati_convergence(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    P_history,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Riccati Equation Convergence'</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot Riccati equation solver convergence.</p>
<p>Shows how Riccati matrix P converges during iterative solution.</p>
<section id="parameters-7" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-7">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 63%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P_history</td>
<td>List[np.ndarray]</td>
<td>List of P matrices at each iteration Each P: (nx, nx) array</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Riccati Equation Convergence'</code></td>
</tr>
<tr class="odd">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-9" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-9">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Convergence plot</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-10" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-10">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># During iterative Riccati solving</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> P_history <span class="op">=</span> []</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> P <span class="op">=</span> np.eye(nx)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>...     P <span class="op">=</span> riccati_iteration(P, A, B, Q, R)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>...     P_history.append(P.copy())</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_riccati_convergence(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>...     P_history,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-6" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-6">Notes</h4>
<ul>
<li>Plots Frobenius norm vs iteration</li>
<li>Shows convergence rate</li>
<li>Useful for debugging custom solvers</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_root_locus" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_root_locus">plot_root_locus</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_root_locus(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    root_locus_data,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Root Locus'</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    show_grid<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    color_scheme<span class="op">=</span><span class="st">'plotly'</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot root locus (pole migration as gain varies).</p>
<p>Shows how closed-loop poles move in complex plane as control gain varies from 0 to infinity.</p>
<section id="parameters-8" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-8">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 72%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>root_locus_data</td>
<td>Dict[str, np.ndarray]</td>
<td>Dictionary with: - ‘gains’: Array of gain values, shape (n_gains,) - ‘poles’: Array of poles, shape (n_gains, n_poles) - Optional ‘zeros’: Open-loop zeros</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Root Locus'</code></td>
</tr>
<tr class="odd">
<td>show_grid</td>
<td>bool</td>
<td>If True, show stability grid</td>
<td><code>True</code></td>
</tr>
<tr class="even">
<td>system_type</td>
<td>str</td>
<td>‘continuous’ or ‘discrete’ (affects stability region)</td>
<td><code>'continuous'</code></td>
</tr>
<tr class="odd">
<td>color_scheme</td>
<td>str</td>
<td>Color scheme for pole branches Options: ‘plotly’, ‘d3’, ‘colorblind_safe’, ‘tableau’, etc. Default: ‘plotly’</td>
<td><code>'plotly'</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-10" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-10">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Root locus plot</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-11" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-11">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute root locus for LQR as Q varies</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gains <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">50</span>)  <span class="co"># Q weight values</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> poles_list <span class="op">=</span> []</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> q <span class="kw">in</span> gains:</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>...     lqr <span class="op">=</span> system.design_lqr(q <span class="op">*</span> np.eye(nx), R)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>...     poles_list.append(lqr[<span class="st">'closed_loop_eigenvalues'</span>])</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> root_locus_data <span class="op">=</span> {</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'gains'</span>: gains,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'poles'</span>: np.array(poles_list)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_root_locus(</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>...     root_locus_data,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-7" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-7">Notes</h4>
<ul>
<li>Each branch shows one pole’s trajectory</li>
<li>Starts at open-loop pole (K=0)</li>
<li>Ends at zero or infinity (K→∞)</li>
<li>Stability: poles must stay in stable region</li>
<li>Continuous: left half-plane (Re &lt; 0)</li>
<li>Discrete: inside unit circle (|z| &lt; 1)</li>
</ul>
</section>
</section>
<section id="cdesym.visualization.ControlPlotter.plot_step_response" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.visualization.ControlPlotter.plot_step_response">plot_step_response</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_step_response(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    reference<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Step Response'</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Plot step response with performance metrics.</p>
<p>Shows closed-loop step response with annotations for rise time, settling time, overshoot, etc.</p>
<section id="parameters-9" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-9">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 69%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>t</td>
<td>np.ndarray</td>
<td>Time points, shape (T,)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>y</td>
<td>np.ndarray</td>
<td>Output response, shape (T,) or (T, ny)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>reference</td>
<td>float</td>
<td>Reference value (step height)</td>
<td><code>1.0</code></td>
</tr>
<tr class="even">
<td>show_metrics</td>
<td>bool</td>
<td>If True, annotate performance metrics</td>
<td><code>True</code></td>
</tr>
<tr class="odd">
<td>title</td>
<td>str</td>
<td>Plot title</td>
<td><code>'Step Response'</code></td>
</tr>
<tr class="even">
<td>theme</td>
<td>Optional[str]</td>
<td>Plot theme to apply Options: ‘default’, ‘publication’, ‘dark’, ‘presentation’ If None, uses self.default_theme</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>**kwargs</td>
<td></td>
<td>Additional arguments</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-11" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-11">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>go.Figure</td>
<td>Step response plot with metrics</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-12" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-12">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Simulate closed-loop step response</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> A_cl <span class="op">=</span> A <span class="op">-</span> B <span class="op">@</span> K  <span class="co"># Closed-loop A matrix</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> result <span class="op">=</span> system.integrate(x0, u<span class="op">=</span><span class="va">None</span>, A_override<span class="op">=</span>A_cl, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> y <span class="op">=</span> result[<span class="st">'x'</span>][:, <span class="dv">0</span>]  <span class="co"># First state</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_step_response(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>...     result[<span class="st">'t'</span>],</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>...     y,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>...     reference<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>...     show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>... )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-8" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-8">Notes</h4>
<ul>
<li>Rise time: 10% to 90% of final value</li>
<li>Settling time: Within 2% of final value</li>
<li>Overshoot: Peak value above reference</li>
<li>Steady-state error: Final value vs reference</li>
</ul>


<!-- -->

</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/gilbenezer\.github\.io\/ControlDESymulation");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># visualization.ControlPlotter { #cdesym.visualization.ControlPlotter }</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter(backend<span class="op">=</span><span class="st">'numpy'</span>, default_theme<span class="op">=</span><span class="st">'default'</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>Control system analysis visualization.</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>Provides interactive Plotly-based plotting for control-specific analysis</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>including eigenvalue maps, gain comparisons, and performance metrics.</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Attributes {.doc-section .doc-section-attributes}</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name          <span class="pp">|</span> Type    <span class="pp">|</span> Description                                        <span class="pp">|</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------|---------|----------------------------------------------------|</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> backend       <span class="pp">|</span> Backend <span class="pp">|</span> Default computational backend for array conversion <span class="pp">|</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> default_theme <span class="pp">|</span> str     <span class="pp">|</span> Default plot theme to apply                        <span class="pp">|</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>Eigenvalue stability map:</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> plotter <span class="op">=</span> ControlPlotter()</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> result <span class="op">=</span> system.design_lqr(Q, R)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>...     result[<span class="st">'closed_loop_eigenvalues'</span>],</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>Compare LQR gains:</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gains <span class="op">=</span> {</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Light Q'</span>: K1,</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Heavy Q'</span>: K2,</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_gain_comparison(</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>...     gains,</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name <span class="pp">|</span> Description <span class="pp">|</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="pp">| ---</span> <span class="pp">| ---</span> <span class="pp">|</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">list_available_color_schemes</span><span class="co">](#cdesym.visualization.ControlPlotter.list_available_color_schemes)</span> <span class="pp">|</span> List available color schemes. <span class="pp">|</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">list_available_themes</span><span class="co">](#cdesym.visualization.ControlPlotter.list_available_themes)</span> <span class="pp">|</span> List available plot themes. <span class="pp">|</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_controllability_gramian</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_controllability_gramian)</span> <span class="pp">|</span> Visualize controllability Gramian as heatmap. <span class="pp">|</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_eigenvalue_map</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_eigenvalue_map)</span> <span class="pp">|</span> Plot eigenvalues with stability region. <span class="pp">|</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_frequency_response</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_frequency_response)</span> <span class="pp">|</span> Plot frequency response (Bode plot). <span class="pp">|</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_gain_comparison</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_gain_comparison)</span> <span class="pp">|</span> Compare feedback gains across different designs. <span class="pp">|</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_impulse_response</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_impulse_response)</span> <span class="pp">|</span> Plot impulse response with performance metrics. <span class="pp">|</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_nyquist</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_nyquist)</span> <span class="pp">|</span> Plot Nyquist diagram. <span class="pp">|</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_observability_gramian</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_observability_gramian)</span> <span class="pp">|</span> Visualize observability Gramian as heatmap. <span class="pp">|</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_riccati_convergence</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_riccati_convergence)</span> <span class="pp">|</span> Plot Riccati equation solver convergence. <span class="pp">|</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_root_locus</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_root_locus)</span> <span class="pp">|</span> Plot root locus (pole migration as gain varies). <span class="pp">|</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">plot_step_response</span><span class="co">](#cdesym.visualization.ControlPlotter.plot_step_response)</span> <span class="pp">|</span> Plot step response with performance metrics. <span class="pp">|</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### list_available_color_schemes { #cdesym.visualization.ControlPlotter.list_available_color_schemes }</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.list_available_color_schemes()</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>List available color schemes.</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type        <span class="pp">|</span> Description                  <span class="pp">|</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-------------|------------------------------|</span></span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> List<span class="sc">\[</span>str<span class="sc">\]</span> <span class="pp">|</span> Available color scheme names <span class="pp">|</span></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> schemes <span class="op">=</span> ControlPlotter.list_available_color_schemes()</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(schemes)</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>[<span class="st">'plotly'</span>, <span class="st">'d3'</span>, <span class="st">'colorblind_safe'</span>, <span class="st">'tableau'</span>, ...]</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a><span class="fu">### list_available_themes { #cdesym.visualization.ControlPlotter.list_available_themes }</span></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.list_available_themes()</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>List available plot themes.</span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type        <span class="pp">|</span> Description           <span class="pp">|</span></span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-------------|-----------------------|</span></span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> List<span class="sc">\[</span>str<span class="sc">\]</span> <span class="pp">|</span> Available theme names <span class="pp">|</span></span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> themes <span class="op">=</span> ControlPlotter.list_available_themes()</span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(themes)</span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>[<span class="st">'default'</span>, <span class="st">'publication'</span>, <span class="st">'dark'</span>, <span class="st">'presentation'</span>]</span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_controllability_gramian { #cdesym.visualization.ControlPlotter.plot_controllability_gramian }</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_controllability_gramian(</span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a>    W_c,</span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a>    state_names<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Controllability Gramian'</span>,</span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>Visualize controllability Gramian as heatmap.</span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>Shows coupling between states for controllability analysis.</span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name        <span class="pp">|</span> Type                    <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default                     <span class="pp">|</span></span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------------|-------------------------|----------------------------------------------------------------------------------------------------------------|-----------------------------|</span></span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> W_c         <span class="pp">|</span> np.ndarray              <span class="pp">|</span> Controllability Gramian, shape (nx, nx) Symmetric positive semi-definite matrix                                <span class="pp">|</span> _required_                  <span class="pp">|</span></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> state_names <span class="pp">|</span> Optional<span class="sc">\[</span>List<span class="sc">\[</span>str<span class="sc">\]\]</span> <span class="pp">|</span> Names for states                                                                                               <span class="pp">|</span> <span class="in">`None`</span>                      <span class="pp">|</span></span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title       <span class="pp">|</span> str                     <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Controllability Gramian'`</span> <span class="pp">|</span></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme       <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>         <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>                      <span class="pp">|</span></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs    <span class="pp">|</span>                         <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>                        <span class="pp">|</span></span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description     <span class="pp">|</span></span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|-----------------|</span></span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Gramian heatmap <span class="pp">|</span></span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute controllability Gramian</span></span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy.linalg <span class="im">import</span> solve_continuous_lyapunov</span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> W_c <span class="op">=</span> solve_continuous_lyapunov(A, <span class="op">-</span>B <span class="op">@</span> B.T)</span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_controllability_gramian(</span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a>...     W_c,</span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>...     state_names<span class="op">=</span>[<span class="st">'Position'</span>, <span class="st">'Velocity'</span>],</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Diagonal elements: controllability of individual states</span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Off-diagonal: coupling between states</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small eigenvalues → difficult to control</span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Can also visualize observability Gramian W_o</span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_eigenvalue_map { #cdesym.visualization.ControlPlotter.plot_eigenvalue_map }</span></span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_eigenvalue_map(</span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>    eigenvalues,</span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>    system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Eigenvalue Map'</span>,</span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a>    show_stability_margin<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>    show_stability_region<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>    color_scheme<span class="op">=</span><span class="st">'plotly'</span>,</span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a>Plot eigenvalues with stability region.</span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a>Creates complex plane plot showing eigenvalue locations with</span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>stability region highlighted. Supports multiple eigenvalue sets</span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>for comparative analysis.</span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name                  <span class="pp">|</span> Type                                         <span class="pp">|</span> Description                                                                                                                                                                                                                                                                                                                                                                         <span class="pp">|</span> Default            <span class="pp">|</span></span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------------------|----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|</span></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> eigenvalues           <span class="pp">|</span> Union<span class="sc">\[</span>np.ndarray, Dict<span class="sc">\[</span>str, np.ndarray<span class="sc">\]\]</span> <span class="pp">|</span> Complex eigenvalues in one of two formats:  **Format 1: Single array**     Shape (n,) - single set of eigenvalues     Use with `labels` parameter for individual point labels  **Format 2: Dictionary** (recommended for multiple sets)     Dict mapping set names to eigenvalue arrays     Example: {'Open-loop': eigs_ol, 'Closed-loop': eigs_cl}     Each array: shape (n_eigs,) <span class="pp">|</span> _required_         <span class="pp">|</span></span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> system_type           <span class="pp">|</span> str                                          <span class="pp">|</span> System type determining stability criterion: - 'continuous': Re(λ) &lt; 0 (left half-plane stable) - 'discrete': <span class="sc">\|</span>λ<span class="sc">\|</span> &lt; 1 (inside unit circle stable)                                                                                                                                                                                                                                 <span class="pp">|</span> <span class="in">`'continuous'`</span>     <span class="pp">|</span></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> labels                <span class="pp">|</span> Optional<span class="sc">\[</span>Union<span class="sc">\[</span>List<span class="sc">\[</span>str<span class="sc">\]</span>, str<span class="sc">\]\]</span>        <span class="pp">|</span> Labels for eigenvalues (only used if eigenvalues is array):  - **List[str]**: Individual label per eigenvalue, length must match - **str**: Single label for entire set - **None**: Default to "Eigenvalues"  Ignored if eigenvalues is Dict (uses dict keys instead)                                                                                                               <span class="pp">|</span> <span class="in">`None`</span>             <span class="pp">|</span></span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title                 <span class="pp">|</span> str                                          <span class="pp">|</span> Plot title                                                                                                                                                                                                                                                                                                                                                                          <span class="pp">|</span> <span class="in">`'Eigenvalue Map'`</span> <span class="pp">|</span></span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_stability_margin <span class="pp">|</span> bool                                         <span class="pp">|</span> If True, annotate stability margin (distance to boundary) - Continuous: margin = -max(Re(λ)) - Discrete: margin = 1 - max(<span class="sc">\|</span>λ<span class="sc">\|</span>)                                                                                                                                                                                                                                                    <span class="pp">|</span> <span class="in">`True`</span>             <span class="pp">|</span></span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_stability_region <span class="pp">|</span> bool                                         <span class="pp">|</span> If True, shade stability region - Continuous: shade left half-plane (green) - Discrete: draw unit circle                                                                                                                                                                                                                                                                            <span class="pp">|</span> <span class="in">`True`</span>             <span class="pp">|</span></span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> color_scheme          <span class="pp">|</span> str                                          <span class="pp">|</span> Color scheme for eigenvalue sets Options: 'plotly', 'd3', 'colorblind_safe', 'tableau', etc. Used when plotting multiple sets (dict format)                                                                                                                                                                                                                                         <span class="pp">|</span> <span class="in">`'plotly'`</span>         <span class="pp">|</span></span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme                 <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>                              <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme                                                                                                                                                                                                                                                                      <span class="pp">|</span> <span class="in">`None`</span>             <span class="pp">|</span></span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs              <span class="pp">|</span>                                              <span class="pp">|</span> Additional customization arguments - marker_size : int - Size of eigenvalue markers (default: 12) - show_grid : bool - Show grid lines (default: True)                                                                                                                                                                                                                              <span class="pp">|</span> <span class="in">`{}`</span>               <span class="pp">|</span></span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description                                      <span class="pp">|</span></span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|--------------------------------------------------|</span></span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Interactive eigenvalue map with stability region <span class="pp">|</span></span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a>**Single set of eigenvalues:**</span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> lqr <span class="op">=</span> system.design_lqr(Q, R)</span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a>...     lqr[<span class="st">'closed_loop_eigenvalues'</span>],</span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a>...     labels<span class="op">=</span><span class="st">'Closed-loop (LQR)'</span>,</span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-219"><a href="#cb32-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-220"><a href="#cb32-220" aria-hidden="true" tabindex="-1"></a>**Multiple sets using dictionary (recommended):**</span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> eigenvalue_sets <span class="op">=</span> {</span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Open-loop'</span>: eigs_open,</span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Closed-loop (LQR)'</span>: eigs_lqr,</span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Closed-loop (H∞)'</span>: eigs_hinf,</span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a>...     eigenvalue_sets,</span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb32-231"><a href="#cb32-231" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb32-232"><a href="#cb32-232" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a>**Multiple sets using concatenation + labels:**</span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-239"><a href="#cb32-239" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-240"><a href="#cb32-240" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> eigs_all <span class="op">=</span> np.concatenate([eigs_ol, eigs_cl])</span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> labels_all <span class="op">=</span> (</span>
<span id="cb32-242"><a href="#cb32-242" aria-hidden="true" tabindex="-1"></a>...     [<span class="st">'Open-loop'</span>] <span class="op">*</span> <span class="bu">len</span>(eigs_ol) <span class="op">+</span> </span>
<span id="cb32-243"><a href="#cb32-243" aria-hidden="true" tabindex="-1"></a>...     [<span class="st">'Closed-loop'</span>] <span class="op">*</span> <span class="bu">len</span>(eigs_cl)</span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a>...     eigs_all,</span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a>...     labels<span class="op">=</span>labels_all,</span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span></span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a>**Discrete system:**</span>
<span id="cb32-253"><a href="#cb32-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-254"><a href="#cb32-254" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a>...     discrete_lqr[<span class="st">'closed_loop_eigenvalues'</span>],</span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'discrete'</span>,</span>
<span id="cb32-258"><a href="#cb32-258" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb32-259"><a href="#cb32-259" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-260"><a href="#cb32-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a>**Custom marker size and grid:**</span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_eigenvalue_map(</span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a>...     eigenvalue_sets,</span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a>...     marker_size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a>...     show_grid<span class="op">=</span><span class="va">True</span></span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-274"><a href="#cb32-274" aria-hidden="true" tabindex="-1"></a>**Stability Criteria:**</span>
<span id="cb32-275"><a href="#cb32-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Continuous systems**: Stable if Re(λ) &lt; 0 for all eigenvalues</span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a>(left half-plane of complex plane)</span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Discrete systems**: Stable if |λ| &lt; 1 for all eigenvalues</span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a>(inside unit circle)</span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a>**Stability Margin:**</span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a>Distance from least stable eigenvalue to stability boundary:</span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuous: margin = -max(Re(λ))</span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Positive: stable with margin</span>
<span id="cb32-288"><a href="#cb32-288" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Negative: unstable</span>
<span id="cb32-289"><a href="#cb32-289" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Larger is better (more robustness)</span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Discrete: margin = 1 - max(|λ|)</span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Positive: stable with margin</span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Negative: unstable</span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Larger is better</span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a>**Visual Encoding:**</span>
<span id="cb32-297"><a href="#cb32-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-298"><a href="#cb32-298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stable region: Shaded green/highlighted</span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unstable region: Shaded red/unmarked</span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stability boundary: Solid black line</span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Eigenvalues: Colored circles (one color per set)</span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Margin: Annotated with arrow</span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a>**Multiple Sets:**</span>
<span id="cb32-305"><a href="#cb32-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-306"><a href="#cb32-306" aria-hidden="true" tabindex="-1"></a>When comparing multiple designs:</span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each set gets unique color from color_scheme</span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Legend shows which eigenvalues belong to which design</span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Useful for visualizing controller tuning effects</span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a><span class="fu">#### See Also {.doc-section .doc-section-see-also}</span></span>
<span id="cb32-312"><a href="#cb32-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-313"><a href="#cb32-313" aria-hidden="true" tabindex="-1"></a>plot_root_locus : Shows eigenvalue migration as gain varies</span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a>plot_gain_comparison : Compare feedback gains</span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_frequency_response { #cdesym.visualization.ControlPlotter.plot_frequency_response }</span></span>
<span id="cb32-317"><a href="#cb32-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-318"><a href="#cb32-318" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_frequency_response(</span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a>    frequencies,</span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a>    magnitude,</span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a>    phase,</span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Frequency Response (Bode Plot)'</span>,</span>
<span id="cb32-324"><a href="#cb32-324" aria-hidden="true" tabindex="-1"></a>    show_margins<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-325"><a href="#cb32-325" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a>Plot frequency response (Bode plot).</span>
<span id="cb32-331"><a href="#cb32-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-332"><a href="#cb32-332" aria-hidden="true" tabindex="-1"></a>Creates magnitude and phase plots vs frequency, with optional</span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a>gain and phase margin annotations.</span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name         <span class="pp">|</span> Type            <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default                            <span class="pp">|</span></span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|-----------------|----------------------------------------------------------------------------------------------------------------|------------------------------------|</span></span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> frequencies  <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Frequency points in rad/s, shape (n_freq,)                                                                     <span class="pp">|</span> _required_                         <span class="pp">|</span></span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> magnitude    <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Magnitude response in dB, shape (n_freq,)                                                                      <span class="pp">|</span> _required_                         <span class="pp">|</span></span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> phase        <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Phase response in degrees, shape (n_freq,)                                                                     <span class="pp">|</span> _required_                         <span class="pp">|</span></span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title        <span class="pp">|</span> str             <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Frequency Response (Bode Plot)'`</span> <span class="pp">|</span></span>
<span id="cb32-343"><a href="#cb32-343" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_margins <span class="pp">|</span> bool            <span class="pp">|</span> If True, annotate gain and phase margins                                                                       <span class="pp">|</span> <span class="in">`True`</span>                             <span class="pp">|</span></span>
<span id="cb32-344"><a href="#cb32-344" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme        <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span> <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>                             <span class="pp">|</span></span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs     <span class="pp">|</span>                 <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>                               <span class="pp">|</span></span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-349"><a href="#cb32-349" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description                                 <span class="pp">|</span></span>
<span id="cb32-350"><a href="#cb32-350" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|---------------------------------------------|</span></span>
<span id="cb32-351"><a href="#cb32-351" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Bode plot with magnitude and phase subplots <span class="pp">|</span></span>
<span id="cb32-352"><a href="#cb32-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute frequency response</span></span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-359"><a href="#cb32-359" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Closed-loop transfer function</span></span>
<span id="cb32-360"><a href="#cb32-360" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> A_cl <span class="op">=</span> A <span class="op">-</span> B <span class="op">@</span> K</span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> sys <span class="op">=</span> signal.StateSpace(A_cl, B, C, D)</span>
<span id="cb32-362"><a href="#cb32-362" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-363"><a href="#cb32-363" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Frequency response</span></span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1000</span>)  <span class="co"># rad/s</span></span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w, H <span class="op">=</span> signal.freqresp(sys, w)</span>
<span id="cb32-366"><a href="#cb32-366" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-367"><a href="#cb32-367" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Convert to dB and degrees</span></span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> mag_dB <span class="op">=</span> <span class="dv">20</span> <span class="op">*</span> np.log10(np.<span class="bu">abs</span>(H).flatten())</span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> phase_deg <span class="op">=</span> np.angle(H, deg<span class="op">=</span><span class="va">True</span>).flatten()</span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-371"><a href="#cb32-371" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Plot with publication theme</span></span>
<span id="cb32-372"><a href="#cb32-372" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_frequency_response(</span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a>...     w, mag_dB, phase_deg,</span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-380"><a href="#cb32-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-381"><a href="#cb32-381" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Magnitude in dB: 20*log10(|H(jω)|)</span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Phase in degrees: ∠H(jω)</span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gain margin: Amount gain can increase before instability</span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Phase margin: Amount phase can decrease before instability</span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Crossover frequencies automatically detected</span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_gain_comparison { #cdesym.visualization.ControlPlotter.plot_gain_comparison }</span></span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-389"><a href="#cb32-389" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-390"><a href="#cb32-390" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_gain_comparison(</span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a>    gains,</span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Feedback Gain Comparison'</span>,</span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a>    color_scheme<span class="op">=</span><span class="st">'plotly'</span>,</span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-397"><a href="#cb32-397" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-398"><a href="#cb32-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a>Compare feedback gains across different designs.</span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a>Creates grouped bar chart or heatmap showing gain values</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a>for different control designs.</span>
<span id="cb32-404"><a href="#cb32-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-405"><a href="#cb32-405" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name         <span class="pp">|</span> Type                    <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default                      <span class="pp">|</span></span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|-------------------------|----------------------------------------------------------------------------------------------------------------|------------------------------|</span></span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> gains        <span class="pp">|</span> Dict<span class="sc">\[</span>str, np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Dictionary mapping design names to gain matrices Each gain: (nu, nx) array                                     <span class="pp">|</span> _required_                   <span class="pp">|</span></span>
<span id="cb32-410"><a href="#cb32-410" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> labels       <span class="pp">|</span> Optional<span class="sc">\[</span>List<span class="sc">\[</span>str<span class="sc">\]\]</span> <span class="pp">|</span> Labels for gain entries (state names) If None, uses generic labels                                             <span class="pp">|</span> <span class="in">`None`</span>                       <span class="pp">|</span></span>
<span id="cb32-411"><a href="#cb32-411" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title        <span class="pp">|</span> str                     <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Feedback Gain Comparison'`</span> <span class="pp">|</span></span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> color_scheme <span class="pp">|</span> str                     <span class="pp">|</span> Color scheme name for bar charts Options: 'plotly', 'd3', 'colorblind_safe', 'tableau', etc. Default: 'plotly' <span class="pp">|</span> <span class="in">`'plotly'`</span>                   <span class="pp">|</span></span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme        <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>         <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>                       <span class="pp">|</span></span>
<span id="cb32-414"><a href="#cb32-414" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs     <span class="pp">|</span>                         <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>                         <span class="pp">|</span></span>
<span id="cb32-415"><a href="#cb32-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-416"><a href="#cb32-416" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-417"><a href="#cb32-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description          <span class="pp">|</span></span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|----------------------|</span></span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Gain comparison plot <span class="pp">|</span></span>
<span id="cb32-421"><a href="#cb32-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-422"><a href="#cb32-422" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-423"><a href="#cb32-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-424"><a href="#cb32-424" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-425"><a href="#cb32-425" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compare different Q weights with colorblind-safe colors</span></span>
<span id="cb32-426"><a href="#cb32-426" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gains <span class="op">=</span> {</span>
<span id="cb32-427"><a href="#cb32-427" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Q=10*I'</span>: system.design_lqr(<span class="dv">10</span><span class="op">*</span>np.eye(<span class="dv">2</span>), R)[<span class="st">'gain'</span>],</span>
<span id="cb32-428"><a href="#cb32-428" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Q=100*I'</span>: system.design_lqr(<span class="dv">100</span><span class="op">*</span>np.eye(<span class="dv">2</span>), R)[<span class="st">'gain'</span>],</span>
<span id="cb32-429"><a href="#cb32-429" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'Q=1000*I'</span>: system.design_lqr(<span class="dv">1000</span><span class="op">*</span>np.eye(<span class="dv">2</span>), R)[<span class="st">'gain'</span>],</span>
<span id="cb32-430"><a href="#cb32-430" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb32-431"><a href="#cb32-431" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_gain_comparison(</span>
<span id="cb32-432"><a href="#cb32-432" aria-hidden="true" tabindex="-1"></a>...     gains,</span>
<span id="cb32-433"><a href="#cb32-433" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb32-434"><a href="#cb32-434" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-435"><a href="#cb32-435" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-436"><a href="#cb32-436" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-437"><a href="#cb32-437" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-438"><a href="#cb32-438" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># With state labels</span></span>
<span id="cb32-439"><a href="#cb32-439" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_gain_comparison(</span>
<span id="cb32-440"><a href="#cb32-440" aria-hidden="true" tabindex="-1"></a>...     gains,</span>
<span id="cb32-441"><a href="#cb32-441" aria-hidden="true" tabindex="-1"></a>...     labels<span class="op">=</span>[<span class="st">'Position'</span>, <span class="st">'Velocity'</span>],</span>
<span id="cb32-442"><a href="#cb32-442" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb32-443"><a href="#cb32-443" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-444"><a href="#cb32-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-445"><a href="#cb32-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-446"><a href="#cb32-446" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-447"><a href="#cb32-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-448"><a href="#cb32-448" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each design shown as separate bar group</span>
<span id="cb32-449"><a href="#cb32-449" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Useful for parameter studies</span>
<span id="cb32-450"><a href="#cb32-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Shows effect of Q/R tuning on gains</span>
<span id="cb32-451"><a href="#cb32-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-452"><a href="#cb32-452" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_impulse_response { #cdesym.visualization.ControlPlotter.plot_impulse_response }</span></span>
<span id="cb32-453"><a href="#cb32-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-454"><a href="#cb32-454" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-455"><a href="#cb32-455" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_impulse_response(</span>
<span id="cb32-456"><a href="#cb32-456" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb32-457"><a href="#cb32-457" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb32-458"><a href="#cb32-458" aria-hidden="true" tabindex="-1"></a>    show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-459"><a href="#cb32-459" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Impulse Response'</span>,</span>
<span id="cb32-460"><a href="#cb32-460" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-461"><a href="#cb32-461" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-462"><a href="#cb32-462" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-463"><a href="#cb32-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-464"><a href="#cb32-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-465"><a href="#cb32-465" aria-hidden="true" tabindex="-1"></a>Plot impulse response with performance metrics.</span>
<span id="cb32-466"><a href="#cb32-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-467"><a href="#cb32-467" aria-hidden="true" tabindex="-1"></a>Shows closed-loop impulse response (response to Dirac delta input)</span>
<span id="cb32-468"><a href="#cb32-468" aria-hidden="true" tabindex="-1"></a>with annotations for peak, decay rate, and settling characteristics.</span>
<span id="cb32-469"><a href="#cb32-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-470"><a href="#cb32-470" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-471"><a href="#cb32-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-472"><a href="#cb32-472" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name         <span class="pp">|</span> Type            <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default              <span class="pp">|</span></span>
<span id="cb32-473"><a href="#cb32-473" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|-----------------|----------------------------------------------------------------------------------------------------------------|----------------------|</span></span>
<span id="cb32-474"><a href="#cb32-474" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> t            <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Time points, shape (T,)                                                                                        <span class="pp">|</span> _required_           <span class="pp">|</span></span>
<span id="cb32-475"><a href="#cb32-475" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> y            <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Output response, shape (T,) or (T, ny)                                                                         <span class="pp">|</span> _required_           <span class="pp">|</span></span>
<span id="cb32-476"><a href="#cb32-476" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_metrics <span class="pp">|</span> bool            <span class="pp">|</span> If True, annotate performance metrics                                                                          <span class="pp">|</span> <span class="in">`True`</span>               <span class="pp">|</span></span>
<span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title        <span class="pp">|</span> str             <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Impulse Response'`</span> <span class="pp">|</span></span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme        <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span> <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>               <span class="pp">|</span></span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs     <span class="pp">|</span>                 <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>                 <span class="pp">|</span></span>
<span id="cb32-480"><a href="#cb32-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-481"><a href="#cb32-481" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-482"><a href="#cb32-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-483"><a href="#cb32-483" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description                        <span class="pp">|</span></span>
<span id="cb32-484"><a href="#cb32-484" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|------------------------------------|</span></span>
<span id="cb32-485"><a href="#cb32-485" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Impulse response plot with metrics <span class="pp">|</span></span>
<span id="cb32-486"><a href="#cb32-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-487"><a href="#cb32-487" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-488"><a href="#cb32-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-489"><a href="#cb32-489" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-490"><a href="#cb32-490" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Simulate closed-loop impulse response</span></span>
<span id="cb32-491"><a href="#cb32-491" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># For continuous systems: y(t) = C @ expm(A_cl*t) @ B</span></span>
<span id="cb32-492"><a href="#cb32-492" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy.linalg <span class="im">import</span> expm</span>
<span id="cb32-493"><a href="#cb32-493" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> A_cl <span class="op">=</span> A <span class="op">-</span> B <span class="op">@</span> K</span>
<span id="cb32-494"><a href="#cb32-494" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb32-495"><a href="#cb32-495" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> y <span class="op">=</span> np.array([C <span class="op">@</span> expm(A_cl <span class="op">*</span> t_i) <span class="op">@</span> B <span class="cf">for</span> t_i <span class="kw">in</span> t]).flatten()</span>
<span id="cb32-496"><a href="#cb32-496" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-497"><a href="#cb32-497" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_impulse_response(</span>
<span id="cb32-498"><a href="#cb32-498" aria-hidden="true" tabindex="-1"></a>...     t, y,</span>
<span id="cb32-499"><a href="#cb32-499" aria-hidden="true" tabindex="-1"></a>...     show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-500"><a href="#cb32-500" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-501"><a href="#cb32-501" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-502"><a href="#cb32-502" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-503"><a href="#cb32-503" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># For discrete systems: simulate with impulse at k=0</span></span>
<span id="cb32-504"><a href="#cb32-504" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="op">=</span> np.zeros(nx)</span>
<span id="cb32-505"><a href="#cb32-505" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> y_discrete <span class="op">=</span> []</span>
<span id="cb32-506"><a href="#cb32-506" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb32-507"><a href="#cb32-507" aria-hidden="true" tabindex="-1"></a>...     u_k <span class="op">=</span> <span class="fl">1.0</span> <span class="cf">if</span> k <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.0</span>  <span class="co"># Impulse at k=0</span></span>
<span id="cb32-508"><a href="#cb32-508" aria-hidden="true" tabindex="-1"></a>...     y_discrete.append(C <span class="op">@</span> x)</span>
<span id="cb32-509"><a href="#cb32-509" aria-hidden="true" tabindex="-1"></a>...     x <span class="op">=</span> A_cl <span class="op">@</span> x <span class="op">+</span> B <span class="op">*</span> u_k</span>
<span id="cb32-510"><a href="#cb32-510" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_impulse_response(t_discrete, np.array(y_discrete))</span>
<span id="cb32-511"><a href="#cb32-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-512"><a href="#cb32-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-513"><a href="#cb32-513" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-514"><a href="#cb32-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-515"><a href="#cb32-515" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Peak value: Maximum absolute response</span>
<span id="cb32-516"><a href="#cb32-516" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Peak time: Time to peak</span>
<span id="cb32-517"><a href="#cb32-517" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Decay rate: Exponential decay constant (if applicable)</span>
<span id="cb32-518"><a href="#cb32-518" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Settling time: Time to settle within 2% of zero</span>
<span id="cb32-519"><a href="#cb32-519" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Energy: Integral of squared response (L2 norm)</span>
<span id="cb32-520"><a href="#cb32-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-521"><a href="#cb32-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_nyquist { #cdesym.visualization.ControlPlotter.plot_nyquist }</span></span>
<span id="cb32-522"><a href="#cb32-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-523"><a href="#cb32-523" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-524"><a href="#cb32-524" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_nyquist(</span>
<span id="cb32-525"><a href="#cb32-525" aria-hidden="true" tabindex="-1"></a>    real,</span>
<span id="cb32-526"><a href="#cb32-526" aria-hidden="true" tabindex="-1"></a>    imag,</span>
<span id="cb32-527"><a href="#cb32-527" aria-hidden="true" tabindex="-1"></a>    frequencies<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-528"><a href="#cb32-528" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Nyquist Plot'</span>,</span>
<span id="cb32-529"><a href="#cb32-529" aria-hidden="true" tabindex="-1"></a>    show_critical_point<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-530"><a href="#cb32-530" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-531"><a href="#cb32-531" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-532"><a href="#cb32-532" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-533"><a href="#cb32-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-534"><a href="#cb32-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-535"><a href="#cb32-535" aria-hidden="true" tabindex="-1"></a>Plot Nyquist diagram.</span>
<span id="cb32-536"><a href="#cb32-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-537"><a href="#cb32-537" aria-hidden="true" tabindex="-1"></a>Shows frequency response in complex plane, useful for stability analysis</span>
<span id="cb32-538"><a href="#cb32-538" aria-hidden="true" tabindex="-1"></a>via Nyquist stability criterion.</span>
<span id="cb32-539"><a href="#cb32-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-540"><a href="#cb32-540" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-541"><a href="#cb32-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-542"><a href="#cb32-542" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name                <span class="pp">|</span> Type                   <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default          <span class="pp">|</span></span>
<span id="cb32-543"><a href="#cb32-543" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------------|------------------------|----------------------------------------------------------------------------------------------------------------|------------------|</span></span>
<span id="cb32-544"><a href="#cb32-544" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> real                <span class="pp">|</span> np.ndarray             <span class="pp">|</span> Real part of frequency response, shape (n_freq,)                                                               <span class="pp">|</span> _required_       <span class="pp">|</span></span>
<span id="cb32-545"><a href="#cb32-545" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> imag                <span class="pp">|</span> np.ndarray             <span class="pp">|</span> Imaginary part of frequency response, shape (n_freq,)                                                          <span class="pp">|</span> _required_       <span class="pp">|</span></span>
<span id="cb32-546"><a href="#cb32-546" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> frequencies         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Frequency points in rad/s (for hover info)                                                                     <span class="pp">|</span> <span class="in">`None`</span>           <span class="pp">|</span></span>
<span id="cb32-547"><a href="#cb32-547" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title               <span class="pp">|</span> str                    <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Nyquist Plot'`</span> <span class="pp">|</span></span>
<span id="cb32-548"><a href="#cb32-548" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_critical_point <span class="pp">|</span> bool                   <span class="pp">|</span> If True, mark critical point (-1, 0j)                                                                          <span class="pp">|</span> <span class="in">`True`</span>           <span class="pp">|</span></span>
<span id="cb32-549"><a href="#cb32-549" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme               <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>        <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>           <span class="pp">|</span></span>
<span id="cb32-550"><a href="#cb32-550" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs            <span class="pp">|</span>                        <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>             <span class="pp">|</span></span>
<span id="cb32-551"><a href="#cb32-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-552"><a href="#cb32-552" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-553"><a href="#cb32-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-554"><a href="#cb32-554" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description   <span class="pp">|</span></span>
<span id="cb32-555"><a href="#cb32-555" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|---------------|</span></span>
<span id="cb32-556"><a href="#cb32-556" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Nyquist plot  <span class="pp">|</span></span>
<span id="cb32-557"><a href="#cb32-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-558"><a href="#cb32-558" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-559"><a href="#cb32-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-560"><a href="#cb32-560" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-561"><a href="#cb32-561" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute open-loop frequency response</span></span>
<span id="cb32-562"><a href="#cb32-562" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb32-563"><a href="#cb32-563" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-564"><a href="#cb32-564" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Open-loop system: G(s) = C(sI - A)^(-1)B</span></span>
<span id="cb32-565"><a href="#cb32-565" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> sys_ol <span class="op">=</span> signal.StateSpace(A, B, C, D)</span>
<span id="cb32-566"><a href="#cb32-566" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-567"><a href="#cb32-567" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Frequency response</span></span>
<span id="cb32-568"><a href="#cb32-568" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1000</span>)</span>
<span id="cb32-569"><a href="#cb32-569" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> w, H <span class="op">=</span> signal.freqresp(sys_ol, w)</span>
<span id="cb32-570"><a href="#cb32-570" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> H <span class="op">=</span> H.flatten()</span>
<span id="cb32-571"><a href="#cb32-571" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-572"><a href="#cb32-572" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Plot Nyquist with dark theme</span></span>
<span id="cb32-573"><a href="#cb32-573" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_nyquist(</span>
<span id="cb32-574"><a href="#cb32-574" aria-hidden="true" tabindex="-1"></a>...     np.real(H), np.imag(H), frequencies<span class="op">=</span>w,</span>
<span id="cb32-575"><a href="#cb32-575" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'dark'</span></span>
<span id="cb32-576"><a href="#cb32-576" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-577"><a href="#cb32-577" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-578"><a href="#cb32-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-579"><a href="#cb32-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-580"><a href="#cb32-580" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-581"><a href="#cb32-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-582"><a href="#cb32-582" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Nyquist plot: H(jω) in complex plane as ω varies</span>
<span id="cb32-583"><a href="#cb32-583" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Critical point: (-1, 0j)</span>
<span id="cb32-584"><a href="#cb32-584" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stability: Number of encirclements of (-1, 0j) determines stability</span>
<span id="cb32-585"><a href="#cb32-585" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gain margin: Distance from curve to (-1, 0j)</span>
<span id="cb32-586"><a href="#cb32-586" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Phase margin: Angle from curve to (-1, 0j)</span>
<span id="cb32-587"><a href="#cb32-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-588"><a href="#cb32-588" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_observability_gramian { #cdesym.visualization.ControlPlotter.plot_observability_gramian }</span></span>
<span id="cb32-589"><a href="#cb32-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-590"><a href="#cb32-590" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-591"><a href="#cb32-591" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_observability_gramian(</span>
<span id="cb32-592"><a href="#cb32-592" aria-hidden="true" tabindex="-1"></a>    W_o,</span>
<span id="cb32-593"><a href="#cb32-593" aria-hidden="true" tabindex="-1"></a>    state_names<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-594"><a href="#cb32-594" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Observability Gramian'</span>,</span>
<span id="cb32-595"><a href="#cb32-595" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-596"><a href="#cb32-596" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-597"><a href="#cb32-597" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-598"><a href="#cb32-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-599"><a href="#cb32-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-600"><a href="#cb32-600" aria-hidden="true" tabindex="-1"></a>Visualize observability Gramian as heatmap.</span>
<span id="cb32-601"><a href="#cb32-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-602"><a href="#cb32-602" aria-hidden="true" tabindex="-1"></a>Shows coupling between states for observability analysis.</span>
<span id="cb32-603"><a href="#cb32-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-604"><a href="#cb32-604" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-605"><a href="#cb32-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-606"><a href="#cb32-606" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name        <span class="pp">|</span> Type                    <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default                   <span class="pp">|</span></span>
<span id="cb32-607"><a href="#cb32-607" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------------|-------------------------|----------------------------------------------------------------------------------------------------------------|---------------------------|</span></span>
<span id="cb32-608"><a href="#cb32-608" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> W_o         <span class="pp">|</span> np.ndarray              <span class="pp">|</span> Observability Gramian, shape (nx, nx)                                                                          <span class="pp">|</span> _required_                <span class="pp">|</span></span>
<span id="cb32-609"><a href="#cb32-609" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> state_names <span class="pp">|</span> Optional<span class="sc">\[</span>List<span class="sc">\[</span>str<span class="sc">\]\]</span> <span class="pp">|</span> Names for states                                                                                               <span class="pp">|</span> <span class="in">`None`</span>                    <span class="pp">|</span></span>
<span id="cb32-610"><a href="#cb32-610" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title       <span class="pp">|</span> str                     <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Observability Gramian'`</span> <span class="pp">|</span></span>
<span id="cb32-611"><a href="#cb32-611" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme       <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>         <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>                    <span class="pp">|</span></span>
<span id="cb32-612"><a href="#cb32-612" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs    <span class="pp">|</span>                         <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>                      <span class="pp">|</span></span>
<span id="cb32-613"><a href="#cb32-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-614"><a href="#cb32-614" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-615"><a href="#cb32-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-616"><a href="#cb32-616" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description     <span class="pp">|</span></span>
<span id="cb32-617"><a href="#cb32-617" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|-----------------|</span></span>
<span id="cb32-618"><a href="#cb32-618" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Gramian heatmap <span class="pp">|</span></span>
<span id="cb32-619"><a href="#cb32-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-620"><a href="#cb32-620" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-621"><a href="#cb32-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-622"><a href="#cb32-622" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-623"><a href="#cb32-623" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute observability Gramian</span></span>
<span id="cb32-624"><a href="#cb32-624" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy.linalg <span class="im">import</span> solve_continuous_lyapunov</span>
<span id="cb32-625"><a href="#cb32-625" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> W_o <span class="op">=</span> solve_continuous_lyapunov(A.T, <span class="op">-</span>C.T <span class="op">@</span> C)</span>
<span id="cb32-626"><a href="#cb32-626" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-627"><a href="#cb32-627" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_observability_gramian(</span>
<span id="cb32-628"><a href="#cb32-628" aria-hidden="true" tabindex="-1"></a>...     W_o,</span>
<span id="cb32-629"><a href="#cb32-629" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-630"><a href="#cb32-630" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-631"><a href="#cb32-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-632"><a href="#cb32-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-633"><a href="#cb32-633" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_riccati_convergence { #cdesym.visualization.ControlPlotter.plot_riccati_convergence }</span></span>
<span id="cb32-634"><a href="#cb32-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-635"><a href="#cb32-635" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-636"><a href="#cb32-636" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_riccati_convergence(</span>
<span id="cb32-637"><a href="#cb32-637" aria-hidden="true" tabindex="-1"></a>    P_history,</span>
<span id="cb32-638"><a href="#cb32-638" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Riccati Equation Convergence'</span>,</span>
<span id="cb32-639"><a href="#cb32-639" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-640"><a href="#cb32-640" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-641"><a href="#cb32-641" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-642"><a href="#cb32-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-643"><a href="#cb32-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-644"><a href="#cb32-644" aria-hidden="true" tabindex="-1"></a>Plot Riccati equation solver convergence.</span>
<span id="cb32-645"><a href="#cb32-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-646"><a href="#cb32-646" aria-hidden="true" tabindex="-1"></a>Shows how Riccati matrix P converges during iterative solution.</span>
<span id="cb32-647"><a href="#cb32-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-648"><a href="#cb32-648" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-649"><a href="#cb32-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-650"><a href="#cb32-650" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name      <span class="pp">|</span> Type               <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default                          <span class="pp">|</span></span>
<span id="cb32-651"><a href="#cb32-651" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|--------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------|</span></span>
<span id="cb32-652"><a href="#cb32-652" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> P_history <span class="pp">|</span> List<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> List of P matrices at each iteration Each P: (nx, nx) array                                                    <span class="pp">|</span> _required_                       <span class="pp">|</span></span>
<span id="cb32-653"><a href="#cb32-653" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title     <span class="pp">|</span> str                <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Riccati Equation Convergence'`</span> <span class="pp">|</span></span>
<span id="cb32-654"><a href="#cb32-654" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme     <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>    <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>                           <span class="pp">|</span></span>
<span id="cb32-655"><a href="#cb32-655" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs  <span class="pp">|</span>                    <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>                             <span class="pp">|</span></span>
<span id="cb32-656"><a href="#cb32-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-657"><a href="#cb32-657" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-658"><a href="#cb32-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-659"><a href="#cb32-659" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description      <span class="pp">|</span></span>
<span id="cb32-660"><a href="#cb32-660" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|------------------|</span></span>
<span id="cb32-661"><a href="#cb32-661" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Convergence plot <span class="pp">|</span></span>
<span id="cb32-662"><a href="#cb32-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-663"><a href="#cb32-663" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-664"><a href="#cb32-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-665"><a href="#cb32-665" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-666"><a href="#cb32-666" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># During iterative Riccati solving</span></span>
<span id="cb32-667"><a href="#cb32-667" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> P_history <span class="op">=</span> []</span>
<span id="cb32-668"><a href="#cb32-668" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> P <span class="op">=</span> np.eye(nx)</span>
<span id="cb32-669"><a href="#cb32-669" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb32-670"><a href="#cb32-670" aria-hidden="true" tabindex="-1"></a>...     P <span class="op">=</span> riccati_iteration(P, A, B, Q, R)</span>
<span id="cb32-671"><a href="#cb32-671" aria-hidden="true" tabindex="-1"></a>...     P_history.append(P.copy())</span>
<span id="cb32-672"><a href="#cb32-672" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-673"><a href="#cb32-673" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_riccati_convergence(</span>
<span id="cb32-674"><a href="#cb32-674" aria-hidden="true" tabindex="-1"></a>...     P_history,</span>
<span id="cb32-675"><a href="#cb32-675" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-676"><a href="#cb32-676" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-677"><a href="#cb32-677" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-678"><a href="#cb32-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-679"><a href="#cb32-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-680"><a href="#cb32-680" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-681"><a href="#cb32-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-682"><a href="#cb32-682" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plots Frobenius norm vs iteration</span>
<span id="cb32-683"><a href="#cb32-683" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Shows convergence rate</span>
<span id="cb32-684"><a href="#cb32-684" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Useful for debugging custom solvers</span>
<span id="cb32-685"><a href="#cb32-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-686"><a href="#cb32-686" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_root_locus { #cdesym.visualization.ControlPlotter.plot_root_locus }</span></span>
<span id="cb32-687"><a href="#cb32-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-688"><a href="#cb32-688" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-689"><a href="#cb32-689" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_root_locus(</span>
<span id="cb32-690"><a href="#cb32-690" aria-hidden="true" tabindex="-1"></a>    root_locus_data,</span>
<span id="cb32-691"><a href="#cb32-691" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Root Locus'</span>,</span>
<span id="cb32-692"><a href="#cb32-692" aria-hidden="true" tabindex="-1"></a>    show_grid<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-693"><a href="#cb32-693" aria-hidden="true" tabindex="-1"></a>    system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb32-694"><a href="#cb32-694" aria-hidden="true" tabindex="-1"></a>    color_scheme<span class="op">=</span><span class="st">'plotly'</span>,</span>
<span id="cb32-695"><a href="#cb32-695" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-696"><a href="#cb32-696" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-697"><a href="#cb32-697" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-698"><a href="#cb32-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-699"><a href="#cb32-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-700"><a href="#cb32-700" aria-hidden="true" tabindex="-1"></a>Plot root locus (pole migration as gain varies).</span>
<span id="cb32-701"><a href="#cb32-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-702"><a href="#cb32-702" aria-hidden="true" tabindex="-1"></a>Shows how closed-loop poles move in complex plane as control</span>
<span id="cb32-703"><a href="#cb32-703" aria-hidden="true" tabindex="-1"></a>gain varies from 0 to infinity.</span>
<span id="cb32-704"><a href="#cb32-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-705"><a href="#cb32-705" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-706"><a href="#cb32-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-707"><a href="#cb32-707" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name            <span class="pp">|</span> Type                    <span class="pp">|</span> Description                                                                                                                                                <span class="pp">|</span> Default        <span class="pp">|</span></span>
<span id="cb32-708"><a href="#cb32-708" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------------|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------|</span></span>
<span id="cb32-709"><a href="#cb32-709" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> root_locus_data <span class="pp">|</span> Dict<span class="sc">\[</span>str, np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Dictionary with: - 'gains': Array of gain values, shape (n_gains,) - 'poles': Array of poles, shape (n_gains, n_poles) - Optional 'zeros': Open-loop zeros <span class="pp">|</span> _required_     <span class="pp">|</span></span>
<span id="cb32-710"><a href="#cb32-710" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title           <span class="pp">|</span> str                     <span class="pp">|</span> Plot title                                                                                                                                                 <span class="pp">|</span> <span class="in">`'Root Locus'`</span> <span class="pp">|</span></span>
<span id="cb32-711"><a href="#cb32-711" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_grid       <span class="pp">|</span> bool                    <span class="pp">|</span> If True, show stability grid                                                                                                                               <span class="pp">|</span> <span class="in">`True`</span>         <span class="pp">|</span></span>
<span id="cb32-712"><a href="#cb32-712" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> system_type     <span class="pp">|</span> str                     <span class="pp">|</span> 'continuous' or 'discrete' (affects stability region)                                                                                                      <span class="pp">|</span> <span class="in">`'continuous'`</span> <span class="pp">|</span></span>
<span id="cb32-713"><a href="#cb32-713" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> color_scheme    <span class="pp">|</span> str                     <span class="pp">|</span> Color scheme for pole branches Options: 'plotly', 'd3', 'colorblind_safe', 'tableau', etc. Default: 'plotly'                                               <span class="pp">|</span> <span class="in">`'plotly'`</span>     <span class="pp">|</span></span>
<span id="cb32-714"><a href="#cb32-714" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme           <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span>         <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme                                             <span class="pp">|</span> <span class="in">`None`</span>         <span class="pp">|</span></span>
<span id="cb32-715"><a href="#cb32-715" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs        <span class="pp">|</span>                         <span class="pp">|</span> Additional arguments                                                                                                                                       <span class="pp">|</span> <span class="in">`{}`</span>           <span class="pp">|</span></span>
<span id="cb32-716"><a href="#cb32-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-717"><a href="#cb32-717" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-718"><a href="#cb32-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-719"><a href="#cb32-719" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description     <span class="pp">|</span></span>
<span id="cb32-720"><a href="#cb32-720" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|-----------------|</span></span>
<span id="cb32-721"><a href="#cb32-721" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Root locus plot <span class="pp">|</span></span>
<span id="cb32-722"><a href="#cb32-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-723"><a href="#cb32-723" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-724"><a href="#cb32-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-725"><a href="#cb32-725" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-726"><a href="#cb32-726" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Compute root locus for LQR as Q varies</span></span>
<span id="cb32-727"><a href="#cb32-727" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb32-728"><a href="#cb32-728" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-729"><a href="#cb32-729" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gains <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">50</span>)  <span class="co"># Q weight values</span></span>
<span id="cb32-730"><a href="#cb32-730" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> poles_list <span class="op">=</span> []</span>
<span id="cb32-731"><a href="#cb32-731" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-732"><a href="#cb32-732" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> q <span class="kw">in</span> gains:</span>
<span id="cb32-733"><a href="#cb32-733" aria-hidden="true" tabindex="-1"></a>...     lqr <span class="op">=</span> system.design_lqr(q <span class="op">*</span> np.eye(nx), R)</span>
<span id="cb32-734"><a href="#cb32-734" aria-hidden="true" tabindex="-1"></a>...     poles_list.append(lqr[<span class="st">'closed_loop_eigenvalues'</span>])</span>
<span id="cb32-735"><a href="#cb32-735" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-736"><a href="#cb32-736" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> root_locus_data <span class="op">=</span> {</span>
<span id="cb32-737"><a href="#cb32-737" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'gains'</span>: gains,</span>
<span id="cb32-738"><a href="#cb32-738" aria-hidden="true" tabindex="-1"></a>...     <span class="st">'poles'</span>: np.array(poles_list)</span>
<span id="cb32-739"><a href="#cb32-739" aria-hidden="true" tabindex="-1"></a>... }</span>
<span id="cb32-740"><a href="#cb32-740" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-741"><a href="#cb32-741" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_root_locus(</span>
<span id="cb32-742"><a href="#cb32-742" aria-hidden="true" tabindex="-1"></a>...     root_locus_data,</span>
<span id="cb32-743"><a href="#cb32-743" aria-hidden="true" tabindex="-1"></a>...     system_type<span class="op">=</span><span class="st">'continuous'</span>,</span>
<span id="cb32-744"><a href="#cb32-744" aria-hidden="true" tabindex="-1"></a>...     color_scheme<span class="op">=</span><span class="st">'colorblind_safe'</span>,</span>
<span id="cb32-745"><a href="#cb32-745" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-746"><a href="#cb32-746" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-747"><a href="#cb32-747" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig.show()</span>
<span id="cb32-748"><a href="#cb32-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-749"><a href="#cb32-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-750"><a href="#cb32-750" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-751"><a href="#cb32-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-752"><a href="#cb32-752" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each branch shows one pole's trajectory</span>
<span id="cb32-753"><a href="#cb32-753" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Starts at open-loop pole (K=0)</span>
<span id="cb32-754"><a href="#cb32-754" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ends at zero or infinity (K→∞)</span>
<span id="cb32-755"><a href="#cb32-755" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stability: poles must stay in stable region</span>
<span id="cb32-756"><a href="#cb32-756" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuous: left half-plane (Re &lt; 0)</span>
<span id="cb32-757"><a href="#cb32-757" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Discrete: inside unit circle (|z| &lt; 1)</span>
<span id="cb32-758"><a href="#cb32-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-759"><a href="#cb32-759" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot_step_response { #cdesym.visualization.ControlPlotter.plot_step_response }</span></span>
<span id="cb32-760"><a href="#cb32-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-761"><a href="#cb32-761" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-762"><a href="#cb32-762" aria-hidden="true" tabindex="-1"></a>visualization.ControlPlotter.plot_step_response(</span>
<span id="cb32-763"><a href="#cb32-763" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb32-764"><a href="#cb32-764" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb32-765"><a href="#cb32-765" aria-hidden="true" tabindex="-1"></a>    reference<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb32-766"><a href="#cb32-766" aria-hidden="true" tabindex="-1"></a>    show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-767"><a href="#cb32-767" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Step Response'</span>,</span>
<span id="cb32-768"><a href="#cb32-768" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-769"><a href="#cb32-769" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb32-770"><a href="#cb32-770" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-771"><a href="#cb32-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-772"><a href="#cb32-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-773"><a href="#cb32-773" aria-hidden="true" tabindex="-1"></a>Plot step response with performance metrics.</span>
<span id="cb32-774"><a href="#cb32-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-775"><a href="#cb32-775" aria-hidden="true" tabindex="-1"></a>Shows closed-loop step response with annotations for</span>
<span id="cb32-776"><a href="#cb32-776" aria-hidden="true" tabindex="-1"></a>rise time, settling time, overshoot, etc.</span>
<span id="cb32-777"><a href="#cb32-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-778"><a href="#cb32-778" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb32-779"><a href="#cb32-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-780"><a href="#cb32-780" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name         <span class="pp">|</span> Type            <span class="pp">|</span> Description                                                                                                    <span class="pp">|</span> Default           <span class="pp">|</span></span>
<span id="cb32-781"><a href="#cb32-781" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|-----------------|----------------------------------------------------------------------------------------------------------------|-------------------|</span></span>
<span id="cb32-782"><a href="#cb32-782" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> t            <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Time points, shape (T,)                                                                                        <span class="pp">|</span> _required_        <span class="pp">|</span></span>
<span id="cb32-783"><a href="#cb32-783" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> y            <span class="pp">|</span> np.ndarray      <span class="pp">|</span> Output response, shape (T,) or (T, ny)                                                                         <span class="pp">|</span> _required_        <span class="pp">|</span></span>
<span id="cb32-784"><a href="#cb32-784" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> reference    <span class="pp">|</span> float           <span class="pp">|</span> Reference value (step height)                                                                                  <span class="pp">|</span> <span class="in">`1.0`</span>             <span class="pp">|</span></span>
<span id="cb32-785"><a href="#cb32-785" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> show_metrics <span class="pp">|</span> bool            <span class="pp">|</span> If True, annotate performance metrics                                                                          <span class="pp">|</span> <span class="in">`True`</span>            <span class="pp">|</span></span>
<span id="cb32-786"><a href="#cb32-786" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> title        <span class="pp">|</span> str             <span class="pp">|</span> Plot title                                                                                                     <span class="pp">|</span> <span class="in">`'Step Response'`</span> <span class="pp">|</span></span>
<span id="cb32-787"><a href="#cb32-787" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> theme        <span class="pp">|</span> Optional<span class="sc">\[</span>str<span class="sc">\]</span> <span class="pp">|</span> Plot theme to apply Options: 'default', 'publication', 'dark', 'presentation' If None, uses self.default_theme <span class="pp">|</span> <span class="in">`None`</span>            <span class="pp">|</span></span>
<span id="cb32-788"><a href="#cb32-788" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **kwargs     <span class="pp">|</span>                 <span class="pp">|</span> Additional arguments                                                                                           <span class="pp">|</span> <span class="in">`{}`</span>              <span class="pp">|</span></span>
<span id="cb32-789"><a href="#cb32-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-790"><a href="#cb32-790" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb32-791"><a href="#cb32-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-792"><a href="#cb32-792" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type      <span class="pp">|</span> Description                     <span class="pp">|</span></span>
<span id="cb32-793"><a href="#cb32-793" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|---------------------------------|</span></span>
<span id="cb32-794"><a href="#cb32-794" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> go.Figure <span class="pp">|</span> Step response plot with metrics <span class="pp">|</span></span>
<span id="cb32-795"><a href="#cb32-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-796"><a href="#cb32-796" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb32-797"><a href="#cb32-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-798"><a href="#cb32-798" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb32-799"><a href="#cb32-799" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Simulate closed-loop step response</span></span>
<span id="cb32-800"><a href="#cb32-800" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> A_cl <span class="op">=</span> A <span class="op">-</span> B <span class="op">@</span> K  <span class="co"># Closed-loop A matrix</span></span>
<span id="cb32-801"><a href="#cb32-801" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> result <span class="op">=</span> system.integrate(x0, u<span class="op">=</span><span class="va">None</span>, A_override<span class="op">=</span>A_cl, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb32-802"><a href="#cb32-802" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> y <span class="op">=</span> result[<span class="st">'x'</span>][:, <span class="dv">0</span>]  <span class="co"># First state</span></span>
<span id="cb32-803"><a href="#cb32-803" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span>
<span id="cb32-804"><a href="#cb32-804" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> fig <span class="op">=</span> plotter.plot_step_response(</span>
<span id="cb32-805"><a href="#cb32-805" aria-hidden="true" tabindex="-1"></a>...     result[<span class="st">'t'</span>],</span>
<span id="cb32-806"><a href="#cb32-806" aria-hidden="true" tabindex="-1"></a>...     y,</span>
<span id="cb32-807"><a href="#cb32-807" aria-hidden="true" tabindex="-1"></a>...     reference<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb32-808"><a href="#cb32-808" aria-hidden="true" tabindex="-1"></a>...     show_metrics<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-809"><a href="#cb32-809" aria-hidden="true" tabindex="-1"></a>...     theme<span class="op">=</span><span class="st">'publication'</span></span>
<span id="cb32-810"><a href="#cb32-810" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb32-811"><a href="#cb32-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-812"><a href="#cb32-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-813"><a href="#cb32-813" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb32-814"><a href="#cb32-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-815"><a href="#cb32-815" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rise time: 10% to 90% of final value</span>
<span id="cb32-816"><a href="#cb32-816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Settling time: Within 2% of final value</span>
<span id="cb32-817"><a href="#cb32-817" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Overshoot: Peak value above reference</span>
<span id="cb32-818"><a href="#cb32-818" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Steady-state error: Final value vs reference</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/visualization.ControlPlotter.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>