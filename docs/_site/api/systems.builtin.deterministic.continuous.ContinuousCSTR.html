<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>systems.builtin.deterministic.continuous.continuouscstr – ControlDESymulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-64209fde6f94c7ab255c4d888f9dae80.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ControlDESymulation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/installation.qmd"> 
<span class="menu-text">Installation Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-architecture" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Architecture</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-architecture">    
        <li>
    <a class="dropdown-item" href="../architecture/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../architecture/cdesym_Design_Philosophy.html">
 <span class="dropdown-text">ControlDESymulation: Design Philosophy and Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/UI_Framework_Architecture.html">
 <span class="dropdown-text">UI Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Type_System_Architecture.html">
 <span class="dropdown-text">Type System Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Integration_Framework_Architecture.html">
 <span class="dropdown-text">Integration Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Control_Framework_Architecture.html">
 <span class="dropdown-text">Control Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Visualization_Framework_Architecture.html">
 <span class="dropdown-text">Visualization Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Delegation_Layer_Architecture.html">
 <span class="dropdown-text">Delegation Layer Architecture</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li class="dropdown-header">tutorials/basic_usage.qmd</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li class="dropdown-header">examples/pendulum_control.qmd</li>
        <li class="dropdown-header">examples/cartpole_swingup.qmd</li>
        <li class="dropdown-header">examples/quadrotor_lqr.qmd</li>
        <li class="dropdown-header">examples/cstr_multiplicity.qmd</li>
        <li class="dropdown-header">examples/lorenz_chaos.qmd</li>
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../api/index.html"> 
<span class="menu-text">API Reference</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gilbenezer/ControlDESymulation"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR" class="nav-link active" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR">systems.builtin.deterministic.continuous.ContinuousCSTR</a>
  <ul>
  <li><a href="#physical-system" id="toc-physical-system" class="nav-link" data-scroll-target="#physical-system">Physical System:</a></li>
  <li><a href="#state-space" id="toc-state-space" class="nav-link" data-scroll-target="#state-space">State Space:</a></li>
  <li><a href="#dynamics" id="toc-dynamics" class="nav-link" data-scroll-target="#dynamics">Dynamics:</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters:</a></li>
  <li><a href="#equilibria-and-multiple-steady-states" id="toc-equilibria-and-multiple-steady-states" class="nav-link" data-scroll-target="#equilibria-and-multiple-steady-states">Equilibria and Multiple Steady States:</a></li>
  <li><a href="#control-objectives" id="toc-control-objectives" class="nav-link" data-scroll-target="#control-objectives">Control Objectives:</a></li>
  <li><a href="#state-constraints" id="toc-state-constraints" class="nav-link" data-scroll-target="#state-constraints">State Constraints:</a></li>
  <li><a href="#time-scales-and-dynamics" id="toc-time-scales-and-dynamics" class="nav-link" data-scroll-target="#time-scales-and-dynamics">Time Scales and Dynamics:</a></li>
  <li><a href="#integration-recommendations" id="toc-integration-recommendations" class="nav-link" data-scroll-target="#integration-recommendations">Integration Recommendations:</a></li>
  <li><a href="#example-usage" id="toc-example-usage" class="nav-link" data-scroll-target="#example-usage">Example Usage:</a></li>
  <li><a href="#physical-insights" id="toc-physical-insights" class="nav-link" data-scroll-target="#physical-insights">Physical Insights:</a></li>
  <li><a href="#comparison-with-other-reactors" id="toc-comparison-with-other-reactors" class="nav-link" data-scroll-target="#comparison-with-other-reactors">Comparison with Other Reactors:</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See Also:</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes:</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion" class="nav-link" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion">compute_conversion</a>
  <ul class="collapse">
  <li><a href="#parameters-1" id="toc-parameters-1" class="nav-link" data-scroll-target="#parameters-1">Parameters</a></li>
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#notes-1" id="toc-notes-1" class="nav-link" data-scroll-target="#notes-1">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number" class="nav-link" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number">compute_damkohler_number</a>
  <ul class="collapse">
  <li><a href="#parameters-2" id="toc-parameters-2" class="nav-link" data-scroll-target="#parameters-2">Parameters</a></li>
  <li><a href="#returns-1" id="toc-returns-1" class="nav-link" data-scroll-target="#returns-1">Returns</a></li>
  <li><a href="#notes-2" id="toc-notes-2" class="nav-link" data-scroll-target="#notes-2">Notes</a></li>
  <li><a href="#examples-1" id="toc-examples-1" class="nav-link" data-scroll-target="#examples-1">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time" class="nav-link" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time">compute_residence_time</a>
  <ul class="collapse">
  <li><a href="#returns-2" id="toc-returns-2" class="nav-link" data-scroll-target="#returns-2">Returns</a></li>
  <li><a href="#examples-2" id="toc-examples-2" class="nav-link" data-scroll-target="#examples-2">Examples</a></li>
  <li><a href="#notes-3" id="toc-notes-3" class="nav-link" data-scroll-target="#notes-3">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system" class="nav-link" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system">define_system</a>
  <ul class="collapse">
  <li><a href="#parameters-3" id="toc-parameters-3" class="nav-link" data-scroll-target="#parameters-3">Parameters</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states" class="nav-link" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states">find_steady_states</a>
  <ul class="collapse">
  <li><a href="#parameters-4" id="toc-parameters-4" class="nav-link" data-scroll-target="#parameters-4">Parameters</a></li>
  <li><a href="#returns-3" id="toc-returns-3" class="nav-link" data-scroll-target="#returns-3">Returns</a></li>
  <li><a href="#examples-3" id="toc-examples-3" class="nav-link" data-scroll-target="#examples-3">Examples</a></li>
  <li><a href="#notes-4" id="toc-notes-4" class="nav-link" data-scroll-target="#notes-4">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria" id="toc-cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria" class="nav-link" data-scroll-target="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria">setup_equilibria</a>
  <ul class="collapse">
  <li><a href="#notes-5" id="toc-notes-5" class="nav-link" data-scroll-target="#notes-5">Notes</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/systems.builtin.deterministic.continuous.ContinuousCSTR.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7"></h1></header><div class="quarto-title-block"><div class="quarto-title-tools-only"><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>




<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR" class="level1">
<h1>systems.builtin.deterministic.continuous.ContinuousCSTR</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Continuous-time Continuous Stirred-Tank Reactor (CSTR) with cooling jacket.</p>
<section id="physical-system" class="level2 doc-section doc-section-physical-system">
<h2 class="doc-section doc-section-physical-system anchored" data-anchor-id="physical-system">Physical System:</h2>
<p>A continuous flow reactor where reactant A converts to product B in an exothermic reaction. The CSTR is one of the most studied nonlinear systems in chemical engineering, exhibiting rich dynamics including: - Multiple steady states (multiplicity) - Sustained oscillations (limit cycles) - Bifurcations and hysteresis - Thermal runaway behavior</p>
<p>Unlike batch reactors, CSTRs operate continuously with: - Continuous feed stream entering at Cₐ,feed, T_feed - Continuous product stream leaving at reactor conditions - Perfect mixing assumption (uniform concentration and temperature) - External cooling/heating via jacket</p>
<p>The CSTR represents a fundamental model in: - Process control (benchmark nonlinear system) - Nonlinear dynamics (canonical example of multiplicity) - Chemical reaction engineering (industrial reactor design) - Bifurcation theory (illustrates saddle-node, Hopf bifurcations)</p>
</section>
<section id="state-space" class="level2 doc-section doc-section-state-space">
<h2 class="doc-section doc-section-state-space anchored" data-anchor-id="state-space">State Space:</h2>
<p>State: x = [Cₐ, T] Concentration state: - Cₐ: Concentration of reactant A in reactor [mol/L] * Governed by material balance: in - out - reaction * 0 ≤ Cₐ ≤ Cₐ,feed (bounded by feed concentration) * Low Cₐ → high conversion (desired but challenging to control) * High Cₐ → low conversion (safe but inefficient)</p>
<pre><code>Temperature state:
- T: Reactor temperature [K]
  * Governed by energy balance: in - out + generation - removal
  * Typically T &gt; T_feed for exothermic reactions
  * Exhibits strong nonlinear coupling with concentration
  * Critical for safety (runaway prevention)
  * Small changes can cause large rate changes (Arrhenius)</code></pre>
<p>Control: u = [T_jacket] - T_jacket: Cooling jacket temperature [K] * Primary manipulated variable for temperature control * Affects heat removal rate via UA·(T - T_jacket) * Typically T_jacket &lt; T (cooling mode) * Can be T_jacket &gt; T (heating mode for startup/cold days) * Physical constraints: chiller/heater capacity limits * Rate constraints: jacket dynamics (not modeled here)</p>
<p>Output: y = [Cₐ, T] - Full state measurement (common in modern plants) - In practice: * Cₐ: Online analyzer (GC, HPLC, NIR spectroscopy) * T: Thermocouple or RTD (fast, reliable) * Both have measurement noise and potential delays</p>
</section>
<section id="dynamics" class="level2 doc-section doc-section-dynamics">
<h2 class="doc-section doc-section-dynamics anchored" data-anchor-id="dynamics">Dynamics:</h2>
<p>The continuous-time CSTR dynamics are:</p>
<pre><code>dCₐ/dt = (F/V)·(Cₐ,feed - Cₐ) - r
dT/dt = (F/V)·(T_feed - T) + (-ΔH/ρCₚ)·r + UA/(VρCₚ)·(T_jacket - T)</code></pre>
<p><strong>Reaction Rate (Arrhenius kinetics)</strong>: r = k₀·Cₐ·exp(-E/T) [mol/(L·s)]</p>
<p>where: - k₀: Pre-exponential factor [1/s] * Collision frequency in Arrhenius equation * Typical range: 10⁶-10¹² for liquid-phase reactions * Material and reaction-specific constant - E: Activation energy [K] (dimensionless Eₐ/R) * Energy barrier for reaction to occur * Typical range: 5,000-15,000 K for Eₐ/R * Higher E → more temperature-sensitive reaction * Physical activation energy Eₐ typically 40-120 kJ/mol - exp(-E/T): Arrhenius temperature dependence * Exponential sensitivity creates strong nonlinearity * 10°C change can double/triple reaction rate * Source of multiple steady states and instability</p>
<p><strong>Physical Interpretation of Each Term</strong>:</p>
<p>Material Balance (dCₐ/dt): 1. <strong>(F/V)·(Cₐ,feed - Cₐ)</strong>: Convective in/out - F/V = 1/τ: Inverse residence time [1/s] - τ = V/F: Average time molecule spends in reactor [s] - Positive when Cₐ &lt; Cₐ,feed (dilution effect) - Acts as “restoring force” toward feed concentration - Time scale: τ (seconds to minutes)</p>
<ol start="2" type="1">
<li><strong>-r</strong>: Consumption by reaction
<ul>
<li>Always negative (reactant consumed)</li>
<li>Exponentially increases with temperature</li>
<li>Depends on current concentration (first-order)</li>
<li>Time scale: 1/k (fast at high T, slow at low T)</li>
</ul></li>
</ol>
<p>At steady state: inflow rate = outflow rate + reaction rate</p>
<p>Energy Balance (dT/dt): 1. <strong>(F/V)·(T_feed - T)</strong>: Convective heat in/out - Negative when T &gt; T_feed (typical for exothermic) - Same time scale as material balance (1/τ) - Acts as “restoring force” toward feed temperature</p>
<ol start="2" type="1">
<li><strong>(-ΔH/ρCₚ)·r</strong>: Heat generation from reaction
<ul>
<li>Positive for exothermic reaction (ΔH &lt; 0)</li>
<li>Couples concentration to temperature</li>
<li>Creates positive feedback: higher T → faster r → more heat</li>
<li>This term causes thermal runaway if unchecked</li>
<li>Magnitude: |ΔH|/(ρCₚ) is adiabatic temperature rise per mol/L</li>
</ul></li>
<li><strong>UA/(VρCₚ)·(T_jacket - T)</strong>: Heat removal via jacket
<ul>
<li>Negative when T &gt; T_jacket (cooling)</li>
<li>Only term controlled by manipulated variable</li>
<li>UA: Overall heat transfer coefficient × area [J/(s·K)]</li>
<li>Larger UA → better temperature control</li>
<li>Time scale: VρCₚ/UA (thermal time constant)</li>
</ul></li>
</ol>
<p>At steady state: heat in + heat generated = heat out + heat removed</p>
<p><strong>Nonlinear Coupling and Feedback</strong>:</p>
<p>The CSTR exhibits strong positive feedback that can lead to instability:</p>
<ol type="1">
<li><p><strong>Thermal Feedback Loop</strong> (Runaway Mechanism): T ↑ → r ↑ (Arrhenius) → heat generation ↑ → T ↑ (positive feedback)</p>
<p>This loop is stabilized by:</p>
<ul>
<li>Convective cooling: higher T → more heat removal to feed</li>
<li>Jacket cooling: higher T → more heat removal via jacket</li>
<li>Reactant depletion: higher r → lower Cₐ → lower r (negative feedback)</li>
</ul></li>
<li><p><strong>Material-Thermal Coupling</strong>:</p>
<ul>
<li>High T → fast reaction → low Cₐ (depletion)</li>
<li>Low Cₐ → slow reaction → less heat generation → lower T</li>
<li>This coupling creates multiple possible steady states</li>
</ul></li>
<li><p><strong>Competition Between Time Scales</strong>:</p>
<ul>
<li>Residence time τ = V/F (convective transport)</li>
<li>Reaction time 1/k (chemical kinetics)</li>
<li>Thermal time VρCₚ/UA (heat transfer)</li>
<li>Relative magnitudes determine stability and multiplicity</li>
</ul></li>
</ol>
</section>
<section id="parameters" class="level2 doc-section doc-section-parameters">
<h2 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters">Parameters:</h2>
<p>F : float, default=100.0 Volumetric flow rate [L/s] - Controls residence time τ = V/F - Higher F → shorter τ → lower conversion but more stable - Lower F → longer τ → higher conversion but less stable - Typical range: 10-1000 L/s depending on reactor size - Often kept constant (set by upstream/downstream constraints)</p>
<p>V : float, default=100.0 Reactor volume [L] - Combined with F to give residence time τ - Larger V → more material holdup → slower dynamics - Typical range: 100-10,000 L for industrial reactors - Design parameter (fixed once reactor is built)</p>
<p>C_A_feed : float, default=1.0 Feed concentration [mol/L] - Upper bound for reactor concentration - Higher feed → more product but more heat generation - Typical range: 0.1-10 mol/L - Often a disturbance variable (feed composition changes)</p>
<p>T_feed : float, default=350.0 Feed temperature [K] - Inlet stream temperature - Typical range: 280-360 K (ambient to pre-heated) - Can be manipulated for control but usually fixed - Feed pre-heating can improve conversion but reduces stability margin</p>
<p>k0 : float, default=7.2e10 Pre-exponential factor [1/s] - Arrhenius equation parameter - Determines reaction speed at given temperature - Typical range: 10⁶-10¹² for liquid phase - Reaction and catalyst specific - Obtained from kinetic experiments or literature</p>
<p>E : float, default=8750.0 Activation energy [K] (actually Eₐ/R, dimensionless) - Energy barrier for reaction to occur - Higher E → more temperature-sensitive - Typical range: 5,000-15,000 K for Eₐ/R - Physical Eₐ typically 40-120 kJ/mol - Key parameter determining multiplicity region - Strong influence on stability</p>
<p>delta_H : float, default=-5e4 Heat of reaction [J/mol] - Energy released (negative) or absorbed (positive) per mole reacted - Negative = exothermic (releases heat) - most common case - Positive = endothermic (absorbs heat) - rare, simpler control - Typical for exothermic: -20,000 to -200,000 J/mol - Magnitude determines thermal coupling strength - Larger |ΔH| → stronger feedback → more multiplicity/instability</p>
<p>rho : float, default=1000.0 Density [kg/L] - Fluid density (assumed constant) - Typical for aqueous solutions: 900-1,100 kg/L - Affects thermal mass (heat capacity of reactor contents)</p>
<p>Cp : float, default=0.239 Specific heat capacity [J/(kg·K)] - Heat required to raise 1 kg by 1 K - Typical for aqueous: 0.2-0.5 J/(kg·K) - Note: Using J/(kg·K) not kJ/(kg·K), hence small value - Combined with ρ gives volumetric heat capacity ρCₚ - Higher Cₚ → larger thermal inertia → slower temperature changes</p>
<p>UA : float, default=5e4 Overall heat transfer coefficient × area [J/(s·K)] - Lumped parameter combining: * Jacket-side film coefficient * Wall thermal conductivity * Reactor-side film coefficient * Heat transfer area - Typical range: 10³-10⁵ J/(s·K) - Higher UA → better temperature control, faster cooling - Limited by physical design (jacket size, flow rate, area) - Critical parameter for preventing runaway</p>
</section>
<section id="equilibria-and-multiple-steady-states" class="level2 doc-section doc-section-equilibria-and-multiple-steady-states">
<h2 class="doc-section doc-section-equilibria-and-multiple-steady-states anchored" data-anchor-id="equilibria-and-multiple-steady-states">Equilibria and Multiple Steady States:</h2>
<p><strong>The Hallmark of CSTR Dynamics</strong></p>
<p>The CSTR is famous for exhibiting <strong>multiple steady states</strong> - a phenomenon called <strong>multiplicity</strong>. For a given set of operating conditions (feed conditions and jacket temperature), the reactor can have:</p>
<ol type="1">
<li><strong>One steady state</strong> (unique solution)</li>
<li><strong>Three steady states</strong> (two stable, one unstable)</li>
<li><strong>Five steady states</strong> (rare, special parameter combinations)</li>
</ol>
<p><strong>Three Steady State Scenario</strong> (most common interesting case):</p>
<ol type="1">
<li><strong>Low-Conversion State (Stable)</strong>:
<ul>
<li>Low temperature (T ≈ T_feed + 10-30 K)</li>
<li>High reactant concentration (Cₐ ≈ 0.7-0.9·Cₐ,feed)</li>
<li>Slow reaction rate (low k·exp(-E/T))</li>
<li>Heat generation &lt; Heat removal capacity</li>
<li><strong>Basin of attraction</strong>: States with low initial temperature</li>
<li><strong>Characteristics</strong>:
<ul>
<li>Easy to start up (cold startup naturally goes here)</li>
<li>Safe and stable</li>
<li>Economically poor (low conversion, wasted reactant)</li>
<li>Easy to control (large stability margins)</li>
</ul></li>
</ul></li>
<li><strong>Intermediate State (Unstable)</strong>:
<ul>
<li>Moderate temperature</li>
<li>Moderate concentration</li>
<li><strong>Saddle point</strong> in phase space</li>
<li>Not physically realizable (unstable equilibrium)</li>
<li>Acts as separatrix between basins of attraction</li>
<li><strong>Physical meaning</strong>: Transition point where thermal generation rate exactly balances heat removal rate, but balance is unstable</li>
</ul></li>
<li><strong>High-Conversion State (Stable)</strong>:
<ul>
<li>High temperature (T ≈ T_feed + 50-100 K)</li>
<li>Low reactant concentration (Cₐ ≈ 0.05-0.3·Cₐ,feed)</li>
<li>Fast reaction rate (high k·exp(-E/T))</li>
<li>Large heat generation balanced by cooling</li>
<li><strong>Basin of attraction</strong>: States with high initial temperature</li>
<li><strong>Characteristics</strong>:
<ul>
<li>Desired operating point (high conversion = high profit)</li>
<li>Requires good startup procedure (must cross unstable intermediate)</li>
<li>Risk of runaway if cooling fails</li>
<li>Smaller stability margins (closer to instability boundary)</li>
<li>More challenging to control (strong nonlinearity)</li>
</ul></li>
</ul></li>
</ol>
<p><strong>Physical Intuition for Multiple Steady States</strong>:</p>
<p>Imagine heat generation curve vs heat removal curve: - Heat generation: S-shaped (Arrhenius kinetics) * Low T: generation small (slow reaction) * Medium T: generation increases rapidly (exponential activation) * High T: generation levels off (reactant depletion)</p>
<ul>
<li>Heat removal: Linear in T (jacket cooling)
<ul>
<li>Straight line: q_removal = UA·(T - T_jacket)/VρCₚ</li>
<li>Plus convective: (F/V)·(T - T_feed)</li>
</ul></li>
</ul>
<p>Intersections of these curves = steady states: - If removal line is steep (large UA): unique high-conversion state - If removal line is shallow (small UA): can have 3 intersections - As T_jacket varies: intersections appear/disappear (bifurcations)</p>
<p><strong>Stability of Steady States</strong>:</p>
<p>Linear stability analysis (eigenvalues of Jacobian): - <strong>Stable</strong>: Both eigenvalues have negative real parts (LHP) * Perturbations decay back to steady state * Can operate here sustainably - <strong>Unstable</strong>: At least one eigenvalue has positive real part (RHP) * Perturbations grow exponentially * Cannot operate here (physically unrealizable)</p>
<p>For CSTR: - Low-conversion state: Typically stable - Intermediate state: Always unstable (saddle point) - High-conversion state: Stable if cooling is adequate</p>
<p><strong>Bifurcations</strong> (Qualitative changes in behavior):</p>
<ol type="1">
<li><strong>Saddle-Node Bifurcation</strong> (Fold): As T_jacket decreases (more cooling):
<ul>
<li>Initially: Only low-conversion state exists</li>
<li>At bifurcation point: Two new states appear (intermediate + high)</li>
<li>Further cooling: Three states coexist</li>
<li><strong>Hysteresis</strong>: Different paths for heating vs cooling</li>
</ul></li>
<li><strong>Hopf Bifurcation</strong> (Oscillations): At certain parameters, high-conversion state can lose stability via Hopf bifurcation → sustained oscillations (limit cycle)
<ul>
<li>Temperature and concentration oscillate periodically</li>
<li>Can occur with insufficient cooling or long residence time</li>
<li>Indicates poor controllability</li>
</ul></li>
</ol>
<p><strong>Finding Steady States</strong>:</p>
<p>Steady states satisfy: dCₐ/dt = 0, dT/dt = 0</p>
<p>This gives two coupled nonlinear algebraic equations: 1. (F/V)·(Cₐ,feed - Cₐ) = k₀·Cₐ·exp(-E/T) 2. (F/V)·(T_feed - T) + (-ΔH/ρCₚ)·k₀·Cₐ·exp(-E/T) = -UA/(VρCₚ)·(T_jacket - T)</p>
<p>Solution methods: - Numerical: Newton-Raphson, fsolve with multiple initial guesses - Graphical: Plot dCₐ/dt and dT/dt surfaces, find intersections - Continuation: Track solutions as parameters vary (AUTO, MATCONT)</p>
<p>See <code>find_steady_states()</code> method for implementation.</p>
</section>
<section id="control-objectives" class="level2 doc-section doc-section-control-objectives">
<h2 class="doc-section doc-section-control-objectives anchored" data-anchor-id="control-objectives">Control Objectives:</h2>
<ol type="1">
<li><strong>Setpoint Regulation</strong> (Most Common):
<ul>
<li>Maintain reactor at high-conversion steady state</li>
<li>Reject disturbances (feed composition, flow rate, ambient temperature)</li>
<li>Controllers: PID, LQR, MPC</li>
<li>Challenge: Strong nonlinearity, operate near instability</li>
</ul></li>
<li><strong>Startup Control</strong>:
<ul>
<li>Transition from low-conversion to high-conversion state</li>
<li>Must cross unstable intermediate state (separatrix crossing)</li>
<li>Requires aggressive transient cooling</li>
<li>Strategies:
<ul>
<li>Bang-bang cooling (maximum jacket cooling)</li>
<li>Optimal control (minimize time/energy)</li>
<li>Gain scheduling (change controller as state changes)</li>
</ul></li>
<li>Risk: Overshoot → runaway</li>
</ul></li>
<li><strong>Runaway Prevention</strong> (Safety Critical):
<ul>
<li>Detect incipient runaway conditions</li>
<li>Implement emergency cooling/shutdown</li>
<li>Monitor dT/dt (temperature rate of change)</li>
<li>Constraint: T &lt; T_max (safety limit)</li>
<li>Last resort: Emergency cooling, feed shutoff, depressurization</li>
</ul></li>
<li><strong>Economic Optimization</strong>:
<ul>
<li>Maximize profit = revenue - costs</li>
<li>Revenue: Product value = price × F × conversion</li>
<li>Costs: Cooling energy, reactant waste, equipment wear</li>
<li>Often operates close to instability boundary for maximum conversion</li>
<li>Tradeoff: Higher conversion (profit) vs safety margin (risk)</li>
</ul></li>
<li><strong>Disturbance Rejection</strong>: Common disturbances:
<ul>
<li>Feed concentration variations: Cₐ,feed(t)</li>
<li>Feed temperature changes: T_feed(t)</li>
<li>Flow rate fluctuations: F(t)</li>
<li>Ambient temperature (affects jacket): T_ambient(t)</li>
<li>Catalyst deactivation: k₀(t) decreases slowly</li>
</ul></li>
</ol>
</section>
<section id="state-constraints" class="level2 doc-section doc-section-state-constraints">
<h2 class="doc-section doc-section-state-constraints anchored" data-anchor-id="state-constraints">State Constraints:</h2>
<ol type="1">
<li><strong>Non-negativity</strong>: Cₐ ≥ 0
<ul>
<li>Concentration cannot be negative (physical)</li>
<li>Rarely active (implies complete conversion)</li>
</ul></li>
<li><strong>Concentration Bounds</strong>: 0 ≤ Cₐ ≤ Cₐ,feed
<ul>
<li>Cannot exceed feed (dilution + reaction only decrease)</li>
<li>Upper bound active only if no reaction occurs</li>
</ul></li>
<li><strong>Temperature Limits</strong>: T_min ≤ T ≤ T_max
<ul>
<li><strong>Lower limit</strong>: Prevent solidification/freezing (≈ 280 K)</li>
<li><strong>Upper limit</strong>: Safety, prevent runaway (≈ 450-500 K)</li>
<li>Material limits: polymer degradation, wall integrity</li>
<li><strong>Most critical constraint for safety</strong></li>
</ul></li>
<li><strong>Jacket Temperature Limits</strong>: T_jacket,min ≤ T_jacket ≤ T_jacket,max
<ul>
<li>Chiller capacity: T_jacket,min ≈ 280 K</li>
<li>Heater capacity: T_jacket,max ≈ 400 K</li>
<li>Rate limit: |dT_jacket/dt| ≤ rate_max (jacket dynamics)</li>
</ul></li>
</ol>
</section>
<section id="time-scales-and-dynamics" class="level2 doc-section doc-section-time-scales-and-dynamics">
<h2 class="doc-section doc-section-time-scales-and-dynamics anchored" data-anchor-id="time-scales-and-dynamics">Time Scales and Dynamics:</h2>
<p><strong>Multiple Time Scales</strong> make CSTR dynamics rich and challenging:</p>
<ol type="1">
<li><strong>Fast Scale - Reaction</strong>: t_reaction = 1/k
<ul>
<li>At low T (350 K): t_reaction ≈ 10-100 s</li>
<li>At high T (400 K): t_reaction ≈ 0.1-1 s</li>
<li>Exponentially dependent on temperature</li>
<li>Can be very fast at high conversion state</li>
</ul></li>
<li><strong>Medium Scale - Residence Time</strong>: t_residence = τ = V/F
<ul>
<li>Typical: 10-1000 s (seconds to minutes)</li>
<li>Time for complete turnover of reactor contents</li>
<li>Natural time scale for concentration changes</li>
<li>Design parameter</li>
</ul></li>
<li><strong>Slow Scale - Thermal</strong>: t_thermal = VρCₚ/UA
<ul>
<li>Typical: 100-10,000 s (minutes to hours)</li>
<li>Time constant for temperature response</li>
<li>Limited by heat transfer through jacket</li>
<li>Design parameter (limited by area, jacket design)</li>
</ul></li>
</ol>
<p><strong>Stiffness</strong>: When time scales differ by orders of magnitude: - Fast reactions with slow heat transfer → stiff system - Requires implicit ODE solvers (Radau, BDF) - Small numerical errors in fast variables → large errors in slow variables</p>
</section>
<section id="integration-recommendations" class="level2 doc-section doc-section-integration-recommendations">
<h2 class="doc-section doc-section-integration-recommendations anchored" data-anchor-id="integration-recommendations">Integration Recommendations:</h2>
<p><strong>Solver Selection</strong>:</p>
<p>For most CSTR problems: - <strong>Moderate stiffness</strong>: RK45 (adaptive Runge-Kutta) works well - <strong>High stiffness</strong>: Use stiff solvers * scipy: Radau, BDF, LSODA (auto-switching) * Julia (DiffEqPy): Rosenbrock23, Rodas5</p>
<p><strong>Tolerance Selection</strong>: - Standard simulation: rtol=1e-6, atol=1e-8 - High accuracy (optimization): rtol=1e-9, atol=1e-11 - Looser tolerances may miss important dynamics</p>
<p><strong>Event Detection</strong>: For safety-critical applications, use event detection: - Detect T &gt; T_max (runaway) - Detect dT/dt &gt; threshold (incipient runaway) - Detect steady state (convergence)</p>
</section>
<section id="example-usage" class="level2 doc-section doc-section-example-usage">
<h2 class="doc-section doc-section-example-usage anchored" data-anchor-id="example-usage">Example Usage:</h2>
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<h1 id="create-cstr-with-default-parameters">Create CSTR with default parameters</h1>
<p>cstr = ContinuousCSTR(F=100.0, V=100.0)</p>
<h1 id="find-all-steady-states-for-given-jacket-temperature">Find all steady states for given jacket temperature</h1>
<p>T_jacket_op = 350.0 steady_states = cstr.find_steady_states(T_jacket_op) print(f”Found {len(steady_states)} steady states:“) for i, (C_A, T) in enumerate(steady_states): … print(f” State {i+1}: Cₐ={C_A:.3f} mol/L, T={T:.1f} K”) … print(f” Conversion: {cstr.compute_conversion(C_A, 1.0)*100:.1f}%“)</p>
<h1 id="choose-high-conversion-operating-point">Choose high-conversion operating point</h1>
<p>if len(steady_states) &gt;= 2: … # High-conversion state (highest T, lowest Cₐ) … steady_states_sorted = sorted(steady_states, key=lambda x: x[1], reverse=True) … C_A_op, T_op = steady_states_sorted[0] … x_op = np.array([C_A_op, T_op]) … u_op = np.array([T_jacket_op]) … else: … # Use provided or default operating point … x_op = np.array([0.1, 390.0]) … u_op = np.array([350.0])</p>
<h1 id="verify-equilibrium">Verify equilibrium</h1>
<p>dx = cstr(x_op, u_op) print(f”check: ||dx/dt|| = {np.linalg.norm(dx):.2e}“)</p>
<h1 id="linearize-at-operating-point">Linearize at operating point</h1>
<p>A, B = cstr.linearize(x_op, u_op) eigenvalues = np.linalg.eigvals(A) print(f”eigenvalues: {eigenvalues}“) print(f”Stable: {np.all(np.real(eigenvalues) &lt; 0)}“)</p>
<h1 id="design-lqr-controller-emphasize-temperature-control">Design LQR controller (emphasize temperature control)</h1>
<p>Q = np.diag([1.0, 100.0]) # Penalize temperature error heavily R = np.array([[1.0]]) lqr_result = cstr.control.design_lqr(A, B, Q, R, system_type=‘continuous’) K = lqr_result[‘gain’]</p>
<h1 id="simulate-with-lqr-control-and-disturbance">Simulate with LQR control and disturbance</h1>
<p>def lqr_controller(x, t): … # Add feed temperature disturbance at t=50s … if t &gt; 50: … # Disturbance increases effective T_feed by changing heat balance … # Compensate by reducing jacket temperature … disturbance_compensation = -2.0 … else: … disturbance_compensation = 0.0 … … u_fb = -K @ (x - x_op) + u_op … return u_fb + disturbance_compensation</p>
<h1 id="perturb-from-equilibrium">Perturb from equilibrium</h1>
<p>x0 = x_op + np.array([0.05, -5.0]) # Small perturbation</p>
<p>result = cstr.simulate( … x0=x0, … controller=lqr_controller, … t_span=(0, 200), … dt=0.1, … method=‘Radau’ # Stiff solver … )</p>
<h1 id="plot-results">Plot results</h1>
<p>import matplotlib.pyplot as plt fig, axes = plt.subplots(3, 1, figsize=(10, 8))</p>
<h1 id="concentration">Concentration</h1>
<p>axes[0].plot(result[‘time’], result[‘states’][:, 0]) axes[0].axhline(x_op[0], color=‘r’, linestyle=‘–’, label=‘Setpoint’) axes[0].set_ylabel(‘Cₐ [mol/L]’) axes[0].legend() axes[0].grid(True)</p>
<h1 id="temperature">Temperature</h1>
<p>axes[1].plot(result[‘time’], result[‘states’][:, 1]) axes[1].axhline(x_op[1], color=‘r’, linestyle=‘–’, label=‘Setpoint’) axes[1].set_ylabel(‘T [K]’) axes[1].legend() axes[1].grid(True)</p>
<h1 id="control-action">Control action</h1>
<p>axes[2].plot(result[‘time’], result[‘controls’][:, 0]) axes[2].axhline(u_op[0], color=‘r’, linestyle=‘–’, label=‘Nominal’) axes[2].set_ylabel(‘T_jacket [K]’) axes[2].set_xlabel(‘Time [s]’) axes[2].legend() axes[2].grid(True)</p>
<p>plt.tight_layout() plt.show()</p>
<h1 id="startup-simulation-low-high-conversion">Startup simulation: low → high conversion</h1>
<h1 id="start-at-low-conversion-steady-state">Start at low-conversion steady state</h1>
<p>if len(steady_states) &gt;= 3: … C_A_low, T_low = steady_states_sorted[-1] # Lowest temperature state … x_low = np.array([C_A_low, T_low]) … else: … x_low = np.array([0.9, 360.0])</p>
<p>def startup_controller(x, t): … ’‘’Aggressive cooling for startup, then switch to regulator’’’ … if t &lt; 100: … # Phase 1: Aggressive cooling to jump to high-conversion state … return np.array([330.0]) # Cold jacket … else: … # Phase 2: LQR regulation around high-conversion setpoint … return lqr_controller(x, t)</p>
<p>result_startup = cstr.simulate( … x0=x_low, … controller=startup_controller, … t_span=(0, 300), … dt=0.1, … method=‘Radau’ … )</p>
<h1 id="check-if-startup-succeeded">Check if startup succeeded</h1>
<p>final_state = result_startup[‘states’][-1, :] distance = np.linalg.norm(final_state - x_op) print(f”result:“) print(f” Final state: Cₐ={final_state[0]:.3f}, T={final_state[1]:.1f}“) print(f” Distance to target: {distance:.3f}“) print(f” Success: {distance &lt; 5.0}“)</p>
<h1 id="phase-portrait-requires-multiple-simulations">Phase portrait (requires multiple simulations)</h1>
<h1 id="shows-basins-of-attraction-for-multiple-steady-states">Shows basins of attraction for multiple steady states</h1>
<h1 id="bifurcation-diagram-vary-t_jacket">Bifurcation diagram (vary T_jacket)</h1>
<p>T_jacket_range = np.linspace(320, 360, 20) bifurcation_data = {‘T_jacket’: [], ‘C_A’: [], ‘T’: [], ‘stable’: []}</p>
<p>for Tj in T_jacket_range: … states = cstr.find_steady_states(Tj) … for C_A, T in states: … # Check stability … A_local, _ = cstr.linearize(np.array([C_A, T]), np.array([Tj])) … eigs = np.linalg.eigvals(A_local) … is_stable = np.all(np.real(eigs) &lt; 0) … … bifurcation_data[‘T_jacket’].append(Tj) … bifurcation_data[‘C_A’].append(C_A) … bifurcation_data[‘T’].append(T) … bifurcation_data[‘stable’].append(is_stable)</p>
<h1 id="plot-bifurcation-diagram">Plot bifurcation diagram</h1>
<p>plt.figure(figsize=(10, 6)) stable = np.array(bifurcation_data[‘stable’]) plt.plot( … np.array(bifurcation_data[‘T_jacket’])[stable], … np.array(bifurcation_data[‘T’])[stable], … ‘b-’, linewidth=2, label=‘Stable’ … ) plt.plot( … np.array(bifurcation_data[‘T_jacket’])[~stable], … np.array(bifurcation_data[‘T’])[~stable], … ‘r–’, linewidth=2, label=‘Unstable’ … ) plt.xlabel(‘Jacket Temperature [K]’) plt.ylabel(‘Reactor Temperature [K]’) plt.title(‘CSTR Bifurcation Diagram’) plt.legend() plt.grid(True) plt.show()</p>
</blockquote>
</blockquote>
</blockquote>
</section>
<section id="physical-insights" class="level2 doc-section doc-section-physical-insights">
<h2 class="doc-section doc-section-physical-insights anchored" data-anchor-id="physical-insights">Physical Insights:</h2>
<p><strong>Why Multiple Steady States Occur</strong>:</p>
<p>The interplay between heat generation (nonlinear, S-shaped) and heat removal (linear) creates the possibility of multiple intersections:</p>
<ol type="1">
<li><strong>Low T region</strong>:
<ul>
<li>Reaction slow (small exp(-E/T))</li>
<li>Generation curve starts flat</li>
<li>Removal line dominates → low-conversion stable</li>
</ul></li>
<li><strong>Medium T region</strong>:
<ul>
<li>Reaction accelerates rapidly (exponential growth)</li>
<li>Generation curve steepens dramatically</li>
<li>Can intersect removal line 3 times</li>
</ul></li>
<li><strong>High T region</strong>:
<ul>
<li>Reaction very fast but Cₐ depleted</li>
<li>Generation curve plateaus (limited by Cₐ)</li>
<li>Removal continues linearly → high-conversion stable</li>
</ul></li>
</ol>
<p><strong>Thermal Runaway Mechanism</strong>:</p>
<p>Positive feedback loop if cooling insufficient: 1. Small T increase (disturbance or control action) 2. Reaction rate jumps (exponential Arrhenius) 3. More heat generated (exothermic) 4. Temperature rises further 5. Loop continues → runaway!</p>
<p>Stabilizing mechanisms: - Reactant depletion (limits generation at high T) - Jacket cooling (removes heat) - Feed cooling (convective heat removal)</p>
<p><strong>Industrial Significance</strong>:</p>
<p>CSTRs are ubiquitous in chemical industry: - Polymerization reactors - Pharmaceutical synthesis - Wastewater treatment (biological reactors) - Fermentation processes</p>
<p>Multiple steady states have practical implications: - <strong>Startup</strong>: Complex procedure to reach desired state - <strong>Control</strong>: Must prevent unintended switching - <strong>Safety</strong>: Runaway risk at high-conversion state - <strong>Economics</strong>: Higher conversion → more profit but harder control</p>
<p><strong>Control Challenges</strong>:</p>
<ol type="1">
<li><strong>Nonlinearity</strong>:
<ul>
<li>Linear controllers (PID) may perform poorly</li>
<li>Gain scheduling or nonlinear control needed</li>
<li>Operating point dependent behavior</li>
</ul></li>
<li><strong>Instability risk</strong>:
<ul>
<li>High-conversion state often close to instability</li>
<li>Small disturbances can cause large excursions</li>
<li>Need fast, aggressive control action</li>
</ul></li>
<li><strong>Constraints</strong>:
<ul>
<li>Temperature limits (safety)</li>
<li>Jacket temperature limits (physical)</li>
<li>Actuator saturation degrades performance</li>
</ul></li>
<li><strong>Multiple states</strong>:
<ul>
<li>System can “jump” between states</li>
<li>Hysteresis complicates control</li>
<li>Need to prevent unintended transitions</li>
</ul></li>
</ol>
<p><strong>Design Considerations</strong>:</p>
<p>For industrial CSTR design: - <strong>Safety first</strong>: Adequate cooling capacity (large UA) - <strong>Residence time</strong>: Balance conversion vs stability (choose V/F) - <strong>Operating point</strong>: High conversion but safe margin from instability - <strong>Instrumentation</strong>: Fast, reliable temperature measurement - <strong>Emergency systems</strong>: Backup cooling, feed shutoff, pressure relief</p>
</section>
<section id="comparison-with-other-reactors" class="level2 doc-section doc-section-comparison-with-other-reactors">
<h2 class="doc-section doc-section-comparison-with-other-reactors anchored" data-anchor-id="comparison-with-other-reactors">Comparison with Other Reactors:</h2>
<p><strong>CSTR vs Batch Reactor</strong>: - CSTR: Continuous operation, steady state, higher throughput - Batch: Transient operation, finite time, better for small volumes</p>
<p><strong>CSTR vs Plug Flow Reactor (PFR)</strong>: - CSTR: Back-mixed, uniform concentration/temperature - PFR: No back-mixing, concentration/temperature gradients - PFR: Generally more efficient but harder to control</p>
<p><strong>CSTR vs Semi-Batch</strong>: - CSTR: Continuous in/out - Semi-batch: Batch with continuous feed, better heat management</p>
</section>
<section id="see-also" class="level2 doc-section doc-section-see-also">
<h2 class="doc-section doc-section-see-also anchored" data-anchor-id="see-also">See Also:</h2>
<p>DiscreteCSTR : Discrete-time version for digital control ContinuousBatchReactor : Batch operation instead of continuous DiscreteBatchReactor : Discrete batch reactor</p>
</section>
<section id="notes" class="level2 doc-section doc-section-notes">
<h2 class="doc-section doc-section-notes anchored" data-anchor-id="notes">Notes:</h2>
<p><strong>Extensions</strong>: More complex CSTR models can include: - Multiple reactions (A → B → C, parallel reactions) - Non-ideal mixing (RTD, compartment models) - Jacket dynamics (first-order lag in cooling) - Catalyst deactivation (slow time scale) - pH effects (additional state) - Gas-liquid reactions (mass transfer limitations)</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion">compute_conversion</a></td>
<td>Compute fractional conversion of reactant A.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number">compute_damkohler_number</a></td>
<td>Compute Damköhler number Da = k·τ (reaction rate × residence time).</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time">compute_residence_time</a></td>
<td>Compute residence time τ = V/F.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system">define_system</a></td>
<td>Define continuous-time CSTR dynamics.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states">find_steady_states</a></td>
<td>Find all steady states for a given jacket temperature.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria">setup_equilibria</a></td>
<td>Set up steady-state equilibrium if provided.</td>
</tr>
</tbody>
</table>
<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion">compute_conversion</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    C_A,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    C_A_feed,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compute fractional conversion of reactant A.</p>
<section id="parameters-1" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 56%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>C_A</td>
<td>float</td>
<td>Current reactor concentration [mol/L]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>C_A_feed</td>
<td>float</td>
<td>Feed concentration [mol/L]</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>float</td>
<td>Conversion fraction X_A = (C_A_feed - C_A) / C_A_feed</td>
</tr>
</tbody>
</table>
</section>
<section id="examples" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> X <span class="op">=</span> cstr.compute_conversion(C_A<span class="op">=</span><span class="fl">0.1</span>, C_A_feed<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Conversion: </span><span class="sc">{</span>X<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Conversion: <span class="fl">90.0</span><span class="op">%</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-1" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-1">Notes</h4>
<p>High conversion (X &gt; 0.9) typically corresponds to high-temperature steady state with fast kinetics and strong exothermic heat generation.</p>
</section>
</section>
<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number">compute_damkohler_number</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    T,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compute Damköhler number Da = k·τ (reaction rate × residence time).</p>
<section id="parameters-2" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T</td>
<td>float</td>
<td>Temperature [K]</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-1" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>float</td>
<td>Damköhler number [dimensionless]</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-2" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-2">Notes</h4>
<p>Damköhler number measures reaction rate relative to flow rate: - Da &lt;&lt; 1: Reaction slow, flow dominates, low conversion - Da &gt;&gt; 1: Reaction fast, kinetics dominate, high conversion - Da ≈ 1: Balanced, optimal efficiency</p>
</section>
<section id="examples-1" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-1">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Da_low <span class="op">=</span> cstr.compute_damkohler_number(T<span class="op">=</span><span class="fl">350.0</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Da_high <span class="op">=</span> cstr.compute_damkohler_number(T<span class="op">=</span><span class="fl">400.0</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Da(350K) = </span><span class="sc">{</span>Da_low<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Da(400K) = </span><span class="sc">{</span>Da_high<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time">compute_residence_time</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compute residence time τ = V/F.</p>
<section id="returns-2" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-2">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>float</td>
<td>Residence time [s]</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-2" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-2">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR(F<span class="op">=</span><span class="fl">100.0</span>, V<span class="op">=</span><span class="fl">100.0</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tau <span class="op">=</span> cstr.compute_residence_time()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Residence time: </span><span class="sc">{</span>tau<span class="sc">}</span><span class="ss"> s"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Residence time: <span class="fl">1.0</span> s</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-3" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-3">Notes</h4>
<p>Residence time is the average time a molecule spends in the reactor. - Longer τ (smaller F): More conversion, less stable - Shorter τ (larger F): Less conversion, more stable</p>
</section>
</section>
<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system">define_system</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.define_system(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    F_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    V_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    C_A_feed_val<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    T_feed_val<span class="op">=</span><span class="fl">350.0</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    k0_val<span class="op">=</span><span class="fl">72000000000.0</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    E_val<span class="op">=</span><span class="fl">8750.0</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    delta_H_val<span class="op">=-</span><span class="fl">50000.0</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    rho_val<span class="op">=</span><span class="fl">1000.0</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    Cp_val<span class="op">=</span><span class="fl">0.239</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    UA_val<span class="op">=</span><span class="fl">50000.0</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    x_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    u_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Define continuous-time CSTR dynamics.</p>
<section id="parameters-3" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 22%">
<col style="width: 48%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>F_val</td>
<td>float</td>
<td>Volumetric flow rate [L/s]</td>
<td><code>100.0</code></td>
</tr>
<tr class="even">
<td>V_val</td>
<td>float</td>
<td>Reactor volume [L]</td>
<td><code>100.0</code></td>
</tr>
<tr class="odd">
<td>C_A_feed_val</td>
<td>float</td>
<td>Feed concentration [mol/L]</td>
<td><code>1.0</code></td>
</tr>
<tr class="even">
<td>T_feed_val</td>
<td>float</td>
<td>Feed temperature [K]</td>
<td><code>350.0</code></td>
</tr>
<tr class="odd">
<td>k0_val</td>
<td>float</td>
<td>Pre-exponential factor [1/s]</td>
<td><code>72000000000.0</code></td>
</tr>
<tr class="even">
<td>E_val</td>
<td>float</td>
<td>Activation energy [K] (dimensionless Eₐ/R)</td>
<td><code>8750.0</code></td>
</tr>
<tr class="odd">
<td>delta_H_val</td>
<td>float</td>
<td>Heat of reaction [J/mol] (negative = exothermic)</td>
<td><code>-50000.0</code></td>
</tr>
<tr class="even">
<td>rho_val</td>
<td>float</td>
<td>Density [kg/L]</td>
<td><code>1000.0</code></td>
</tr>
<tr class="odd">
<td>Cp_val</td>
<td>float</td>
<td>Specific heat capacity [J/(kg·K)]</td>
<td><code>0.239</code></td>
</tr>
<tr class="even">
<td>UA_val</td>
<td>float</td>
<td>Overall heat transfer coefficient × area [J/(s·K)]</td>
<td><code>50000.0</code></td>
</tr>
<tr class="odd">
<td>x_ss</td>
<td>Optional[np.ndarray]</td>
<td>Steady-state [Cₐ, T] for equilibrium setup</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>u_ss</td>
<td>Optional[np.ndarray]</td>
<td>Steady-state [T_jacket] for equilibrium setup</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states">find_steady_states</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    T_jacket,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    T_range<span class="op">=</span>(<span class="fl">300.0</span>, <span class="fl">500.0</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    n_points<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Find all steady states for a given jacket temperature.</p>
<p>Uses multiple initial guesses across temperature range to find all solutions to the steady-state equations.</p>
<section id="parameters-4" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-4">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 57%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T_jacket</td>
<td>float</td>
<td>Jacket temperature [K]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>T_range</td>
<td>tuple</td>
<td>Temperature range to search (T_min, T_max) [K]</td>
<td><code>(300.0, 500.0)</code></td>
</tr>
<tr class="odd">
<td>n_points</td>
<td>int</td>
<td>Number of initial guesses for root finding</td>
<td><code>100</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-3" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-3">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>list</td>
<td>List of (C_A, T) steady state tuples</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-3" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-3">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> steady_states <span class="op">=</span> cstr.find_steady_states(T_jacket<span class="op">=</span><span class="fl">350.0</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(steady_states)<span class="sc">}</span><span class="ss"> steady states"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> i, (C_A, T) <span class="kw">in</span> <span class="bu">enumerate</span>(steady_states):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>...     X <span class="op">=</span> cstr.compute_conversion(C_A, <span class="fl">1.0</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>...     <span class="bu">print</span>(<span class="ss">f"  State </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: Cₐ=</span><span class="sc">{</span>C_A<span class="sc">:.3f}</span><span class="ss">, T=</span><span class="sc">{</span>T<span class="sc">:.1f}</span><span class="ss">, X=</span><span class="sc">{</span>X<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="notes-4" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-4">Notes</h4>
<p>This method finds steady states by solving: dCₐ/dt = 0 (material balance) dT/dt = 0 (energy balance)</p>
<p>For CSTR, there can be 1, 2, or 3 steady states depending on parameters. This method attempts to find all of them by using many different initial guesses across the temperature range.</p>
<p>For production code, consider: - scipy.optimize.fsolve with multiple guesses - Continuation methods (AUTO, MATCONT) - Homotopy methods for guaranteed finding of all solutions</p>
</section>
</section>
<section id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria">setup_equilibria</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Set up steady-state equilibrium if provided.</p>
<section id="notes-5" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-5">Notes</h4>
<p>CSTR can have multiple steady states! Only add user-provided equilibrium. Finding all equilibria requires solving nonlinear algebraic equations (see find_steady_states() method).</p>


<!-- -->

</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/gilbenezer\.github\.io\/ControlDESymulation");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># systems.builtin.deterministic.continuous.ContinuousCSTR { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR }</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>Continuous-time Continuous Stirred-Tank Reactor (CSTR) with cooling jacket.</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## Physical System: {.doc-section .doc-section-physical-system}</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>A continuous flow reactor where reactant A converts to product B in</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>an exothermic reaction. The CSTR is one of the most studied nonlinear</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>systems in chemical engineering, exhibiting rich dynamics including:</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple steady states (multiplicity)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sustained oscillations (limit cycles)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bifurcations and hysteresis</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Thermal runaway behavior</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>Unlike batch reactors, CSTRs operate continuously with:</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuous feed stream entering at Cₐ,feed, T_feed</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuous product stream leaving at reactor conditions</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perfect mixing assumption (uniform concentration and temperature)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>External cooling/heating via jacket</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>The CSTR represents a fundamental model in:</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Process control (benchmark nonlinear system)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Nonlinear dynamics (canonical example of multiplicity)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Chemical reaction engineering (industrial reactor design)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bifurcation theory (illustrates saddle-node, Hopf bifurcations)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## State Space: {.doc-section .doc-section-state-space}</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>State: x = <span class="co">[</span><span class="ot">Cₐ, T</span><span class="co">]</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    Concentration state:</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Cₐ: Concentration of reactant A in reactor <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Governed by material balance: in - out - reaction</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>0 ≤ Cₐ ≤ Cₐ,feed (bounded by feed concentration)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Low Cₐ → high conversion (desired but challenging to control)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>High Cₐ → low conversion (safe but inefficient)</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    Temperature state:</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>T: Reactor temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Governed by energy balance: in - out + generation - removal</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Typically T &gt; T_feed for exothermic reactions</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Exhibits strong nonlinear coupling with concentration</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Critical for safety (runaway prevention)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Small changes can cause large rate changes (Arrhenius)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>Control: u = <span class="co">[</span><span class="ot">T_jacket</span><span class="co">]</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>T_jacket: Cooling jacket temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Primary manipulated variable for temperature control</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Affects heat removal rate via UA·(T - T_jacket)</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Typically T_jacket &lt; T (cooling mode)</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Can be T_jacket &gt; T (heating mode for startup/cold days)</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Physical constraints: chiller/heater capacity limits</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Rate constraints: jacket dynamics (not modeled here)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>Output: y = <span class="co">[</span><span class="ot">Cₐ, T</span><span class="co">]</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Full state measurement (common in modern plants)</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>In practice:</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Cₐ: Online analyzer (GC, HPLC, NIR spectroscopy)</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>T: Thermocouple or RTD (fast, reliable)</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Both have measurement noise and potential delays</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dynamics: {.doc-section .doc-section-dynamics}</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>The continuous-time CSTR dynamics are:</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a><span class="in">    dCₐ/dt = (F/V)·(Cₐ,feed - Cₐ) - r</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a><span class="in">    dT/dt = (F/V)·(T_feed - T) + (-ΔH/ρCₚ)·r + UA/(VρCₚ)·(T_jacket - T)</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>**Reaction Rate (Arrhenius kinetics)**:</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    r = k₀·Cₐ·exp(-E/T)  <span class="co">[</span><span class="ot">mol/(L·s)</span><span class="co">]</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>k₀: Pre-exponential factor <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Collision frequency in Arrhenius equation</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Typical range: 10⁶-10¹² for liquid-phase reactions</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Material and reaction-specific constant</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>E: Activation energy <span class="co">[</span><span class="ot">K</span><span class="co">]</span> (dimensionless Eₐ/R)</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Energy barrier for reaction to occur</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Typical range: 5,000-15,000 K for Eₐ/R</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Higher E → more temperature-sensitive reaction</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Physical activation energy Eₐ typically 40-120 kJ/mol</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>exp(-E/T): Arrhenius temperature dependence</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Exponential sensitivity creates strong nonlinearity</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>10°C change can double/triple reaction rate</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Source of multiple steady states and instability</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>**Physical Interpretation of Each Term**:</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>Material Balance (dCₐ/dt):</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**(F/V)·(Cₐ,feed - Cₐ)**: Convective in/out</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>F/V = 1/τ: Inverse residence time <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>τ = V/F: Average time molecule spends in reactor <span class="co">[</span><span class="ot">s</span><span class="co">]</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Positive when Cₐ &lt; Cₐ,feed (dilution effect)</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Acts as "restoring force" toward feed concentration</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time scale: τ (seconds to minutes)</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**-r**: Consumption by reaction</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Always negative (reactant consumed)</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Exponentially increases with temperature</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Depends on current concentration (first-order)</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time scale: 1/k (fast at high T, slow at low T)</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>At steady state: inflow rate = outflow rate + reaction rate</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>Energy Balance (dT/dt):</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**(F/V)·(T_feed - T)**: Convective heat in/out</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Negative when T &gt; T_feed (typical for exothermic)</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Same time scale as material balance (1/τ)</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Acts as "restoring force" toward feed temperature</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**(-ΔH/ρCₚ)·r**: Heat generation from reaction</span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Positive for exothermic reaction (ΔH &lt; 0)</span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Couples concentration to temperature</span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates positive feedback: higher T → faster r → more heat</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This term causes thermal runaway if unchecked</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Magnitude: |ΔH|/(ρCₚ) is adiabatic temperature rise per mol/L</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**UA/(VρCₚ)·(T_jacket - T)**: Heat removal via jacket</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Negative when T &gt; T_jacket (cooling)</span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Only term controlled by manipulated variable</span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>UA: Overall heat transfer coefficient × area <span class="co">[</span><span class="ot">J/(s·K)</span><span class="co">]</span></span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Larger UA → better temperature control</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time scale: VρCₚ/UA (thermal time constant)</span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>At steady state: heat in + heat generated = heat out + heat removed</span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>**Nonlinear Coupling and Feedback**:</span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>The CSTR exhibits strong positive feedback that can lead to instability:</span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Thermal Feedback Loop** (Runaway Mechanism):</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>   T ↑ → r ↑ (Arrhenius) → heat generation ↑ → T ↑ (positive feedback)</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>   This loop is stabilized by:</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Convective cooling: higher T → more heat removal to feed</span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Jacket cooling: higher T → more heat removal via jacket</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reactant depletion: higher r → lower Cₐ → lower r (negative feedback)</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Material-Thermal Coupling**:</span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>High T → fast reaction → low Cₐ (depletion)</span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Low Cₐ → slow reaction → less heat generation → lower T</span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This coupling creates multiple possible steady states</span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Competition Between Time Scales**:</span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Residence time τ = V/F (convective transport)</span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reaction time 1/k (chemical kinetics)</span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Thermal time VρCₚ/UA (heat transfer)</span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Relative magnitudes determine stability and multiplicity</span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameters: {.doc-section .doc-section-parameters}</span></span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>F : float, default=100.0</span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a>    Volumetric flow rate <span class="co">[</span><span class="ot">L/s</span><span class="co">]</span></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Controls residence time τ = V/F</span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Higher F → shorter τ → lower conversion but more stable</span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Lower F → longer τ → higher conversion but less stable</span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 10-1000 L/s depending on reactor size</span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Often kept constant (set by upstream/downstream constraints)</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>V : float, default=100.0</span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>    Reactor volume <span class="co">[</span><span class="ot">L</span><span class="co">]</span></span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Combined with F to give residence time τ</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Larger V → more material holdup → slower dynamics</span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 100-10,000 L for industrial reactors</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Design parameter (fixed once reactor is built)</span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a>C_A_feed : float, default=1.0</span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>    Feed concentration <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span></span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Upper bound for reactor concentration</span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Higher feed → more product but more heat generation</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 0.1-10 mol/L</span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Often a disturbance variable (feed composition changes)</span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a>T_feed : float, default=350.0</span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a>    Feed temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span></span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Inlet stream temperature</span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 280-360 K (ambient to pre-heated)</span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Can be manipulated for control but usually fixed</span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Feed pre-heating can improve conversion but reduces stability margin</span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>k0 : float, default=7.2e10</span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a>    Pre-exponential factor <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span></span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Arrhenius equation parameter</span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Determines reaction speed at given temperature</span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 10⁶-10¹² for liquid phase</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Reaction and catalyst specific</span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Obtained from kinetic experiments or literature</span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>E : float, default=8750.0</span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a>    Activation energy <span class="co">[</span><span class="ot">K</span><span class="co">]</span> (actually Eₐ/R, dimensionless)</span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Energy barrier for reaction to occur</span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Higher E → more temperature-sensitive</span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 5,000-15,000 K for Eₐ/R</span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Physical Eₐ typically 40-120 kJ/mol</span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Key parameter determining multiplicity region</span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Strong influence on stability</span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>delta_H : float, default=-5e4</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a>    Heat of reaction <span class="co">[</span><span class="ot">J/mol</span><span class="co">]</span></span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Energy released (negative) or absorbed (positive) per mole reacted</span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Negative = exothermic (releases heat) - most common case</span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Positive = endothermic (absorbs heat) - rare, simpler control</span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical for exothermic: -20,000 to -200,000 J/mol</span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Magnitude determines thermal coupling strength</span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Larger |ΔH| → stronger feedback → more multiplicity/instability</span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a>rho : float, default=1000.0</span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a>    Density <span class="co">[</span><span class="ot">kg/L</span><span class="co">]</span></span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Fluid density (assumed constant)</span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical for aqueous solutions: 900-1,100 kg/L</span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Affects thermal mass (heat capacity of reactor contents)</span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a>Cp : float, default=0.239</span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a>    Specific heat capacity <span class="co">[</span><span class="ot">J/(kg·K)</span><span class="co">]</span></span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Heat required to raise 1 kg by 1 K</span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical for aqueous: 0.2-0.5 J/(kg·K)</span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Note: Using J/(kg·K) not kJ/(kg·K), hence small value</span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Combined with ρ gives volumetric heat capacity ρCₚ</span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Higher Cₚ → larger thermal inertia → slower temperature changes</span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a>UA : float, default=5e4</span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a>    Overall heat transfer coefficient × area <span class="co">[</span><span class="ot">J/(s·K)</span><span class="co">]</span></span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Lumped parameter combining:</span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Jacket-side film coefficient</span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Wall thermal conductivity</span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Reactor-side film coefficient</span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a><span class="ss">      * </span>Heat transfer area</span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Typical range: 10³-10⁵ J/(s·K)</span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Higher UA → better temperature control, faster cooling</span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Limited by physical design (jacket size, flow rate, area)</span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Critical parameter for preventing runaway</span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Equilibria and Multiple Steady States: {.doc-section .doc-section-equilibria-and-multiple-steady-states}</span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>**The Hallmark of CSTR Dynamics**</span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>The CSTR is famous for exhibiting **multiple steady states** - a phenomenon</span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a>called **multiplicity**. For a given set of operating conditions (feed</span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a>conditions and jacket temperature), the reactor can have:</span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**One steady state** (unique solution)</span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Three steady states** (two stable, one unstable)</span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Five steady states** (rare, special parameter combinations)</span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a>**Three Steady State Scenario** (most common interesting case):</span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Low-Conversion State (Stable)**:</span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Low temperature (T ≈ T_feed + 10-30 K)</span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>High reactant concentration (Cₐ ≈ 0.7-0.9·Cₐ,feed)</span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Slow reaction rate (low k·exp(-E/T))</span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Heat generation &lt; Heat removal capacity</span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Basin of attraction**: States with low initial temperature</span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Characteristics**:</span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Easy to start up (cold startup naturally goes here)</span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Safe and stable</span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Economically poor (low conversion, wasted reactant)</span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Easy to control (large stability margins)</span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Intermediate State (Unstable)**:</span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Moderate temperature</span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Moderate concentration</span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Saddle point** in phase space</span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Not physically realizable (unstable equilibrium)</span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Acts as separatrix between basins of attraction</span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Physical meaning**: Transition point where thermal generation</span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a>     rate exactly balances heat removal rate, but balance is unstable</span>
<span id="cb14-270"><a href="#cb14-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-271"><a href="#cb14-271" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**High-Conversion State (Stable)**:</span>
<span id="cb14-272"><a href="#cb14-272" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>High temperature (T ≈ T_feed + 50-100 K)</span>
<span id="cb14-273"><a href="#cb14-273" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Low reactant concentration (Cₐ ≈ 0.05-0.3·Cₐ,feed)</span>
<span id="cb14-274"><a href="#cb14-274" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Fast reaction rate (high k·exp(-E/T))</span>
<span id="cb14-275"><a href="#cb14-275" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Large heat generation balanced by cooling</span>
<span id="cb14-276"><a href="#cb14-276" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Basin of attraction**: States with high initial temperature</span>
<span id="cb14-277"><a href="#cb14-277" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Characteristics**:</span>
<span id="cb14-278"><a href="#cb14-278" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Desired operating point (high conversion = high profit)</span>
<span id="cb14-279"><a href="#cb14-279" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Requires good startup procedure (must cross unstable intermediate)</span>
<span id="cb14-280"><a href="#cb14-280" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Risk of runaway if cooling fails</span>
<span id="cb14-281"><a href="#cb14-281" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Smaller stability margins (closer to instability boundary)</span>
<span id="cb14-282"><a href="#cb14-282" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>More challenging to control (strong nonlinearity)</span>
<span id="cb14-283"><a href="#cb14-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-284"><a href="#cb14-284" aria-hidden="true" tabindex="-1"></a>**Physical Intuition for Multiple Steady States**:</span>
<span id="cb14-285"><a href="#cb14-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-286"><a href="#cb14-286" aria-hidden="true" tabindex="-1"></a>Imagine heat generation curve vs heat removal curve:</span>
<span id="cb14-287"><a href="#cb14-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Heat generation: S-shaped (Arrhenius kinetics)</span>
<span id="cb14-288"><a href="#cb14-288" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Low T: generation small (slow reaction)</span>
<span id="cb14-289"><a href="#cb14-289" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Medium T: generation increases rapidly (exponential activation)</span>
<span id="cb14-290"><a href="#cb14-290" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>High T: generation levels off (reactant depletion)</span>
<span id="cb14-291"><a href="#cb14-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-292"><a href="#cb14-292" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Heat removal: Linear in T (jacket cooling)</span>
<span id="cb14-293"><a href="#cb14-293" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Straight line: q_removal = UA·(T - T_jacket)/VρCₚ</span>
<span id="cb14-294"><a href="#cb14-294" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Plus convective: (F/V)·(T - T_feed)</span>
<span id="cb14-295"><a href="#cb14-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-296"><a href="#cb14-296" aria-hidden="true" tabindex="-1"></a>Intersections of these curves = steady states:</span>
<span id="cb14-297"><a href="#cb14-297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If removal line is steep (large UA): unique high-conversion state</span>
<span id="cb14-298"><a href="#cb14-298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If removal line is shallow (small UA): can have 3 intersections</span>
<span id="cb14-299"><a href="#cb14-299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As T_jacket varies: intersections appear/disappear (bifurcations)</span>
<span id="cb14-300"><a href="#cb14-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-301"><a href="#cb14-301" aria-hidden="true" tabindex="-1"></a>**Stability of Steady States**:</span>
<span id="cb14-302"><a href="#cb14-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-303"><a href="#cb14-303" aria-hidden="true" tabindex="-1"></a>Linear stability analysis (eigenvalues of Jacobian):</span>
<span id="cb14-304"><a href="#cb14-304" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Stable**: Both eigenvalues have negative real parts (LHP)</span>
<span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Perturbations decay back to steady state</span>
<span id="cb14-306"><a href="#cb14-306" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Can operate here sustainably</span>
<span id="cb14-307"><a href="#cb14-307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Unstable**: At least one eigenvalue has positive real part (RHP)</span>
<span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Perturbations grow exponentially</span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Cannot operate here (physically unrealizable)</span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a>For CSTR:</span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Low-conversion state: Typically stable</span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Intermediate state: Always unstable (saddle point)</span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High-conversion state: Stable if cooling is adequate</span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a>**Bifurcations** (Qualitative changes in behavior):</span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Saddle-Node Bifurcation** (Fold):</span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>   As T_jacket decreases (more cooling):</span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Initially: Only low-conversion state exists</span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>At bifurcation point: Two new states appear (intermediate + high)</span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Further cooling: Three states coexist</span>
<span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Hysteresis**: Different paths for heating vs cooling</span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Hopf Bifurcation** (Oscillations):</span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a>   At certain parameters, high-conversion state can lose stability via</span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>   Hopf bifurcation → sustained oscillations (limit cycle)</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Temperature and concentration oscillate periodically</span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Can occur with insufficient cooling or long residence time</span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Indicates poor controllability</span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a>**Finding Steady States**:</span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>Steady states satisfy: dCₐ/dt = 0, dT/dt = 0</span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>This gives two coupled nonlinear algebraic equations:</span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>(F/V)·(Cₐ,feed - Cₐ) = k₀·Cₐ·exp(-E/T)</span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>(F/V)·(T_feed - T) + (-ΔH/ρCₚ)·k₀·Cₐ·exp(-E/T) = -UA/(VρCₚ)·(T_jacket - T)</span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a>Solution methods:</span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Numerical: Newton-Raphson, fsolve with multiple initial guesses</span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Graphical: Plot dCₐ/dt and dT/dt surfaces, find intersections</span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuation: Track solutions as parameters vary (AUTO, MATCONT)</span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a>See <span class="in">`find_steady_states()`</span> method for implementation.</span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## Control Objectives: {.doc-section .doc-section-control-objectives}</span></span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Setpoint Regulation** (Most Common):</span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Maintain reactor at high-conversion steady state</span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reject disturbances (feed composition, flow rate, ambient temperature)</span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Controllers: PID, LQR, MPC</span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Challenge: Strong nonlinearity, operate near instability</span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Startup Control**:</span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Transition from low-conversion to high-conversion state</span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Must cross unstable intermediate state (separatrix crossing)</span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Requires aggressive transient cooling</span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Strategies:</span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Bang-bang cooling (maximum jacket cooling)</span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Optimal control (minimize time/energy)</span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a><span class="ss">     * </span>Gain scheduling (change controller as state changes)</span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Risk: Overshoot → runaway</span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Runaway Prevention** (Safety Critical):</span>
<span id="cb14-367"><a href="#cb14-367" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Detect incipient runaway conditions</span>
<span id="cb14-368"><a href="#cb14-368" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Implement emergency cooling/shutdown</span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Monitor dT/dt (temperature rate of change)</span>
<span id="cb14-370"><a href="#cb14-370" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Constraint: T &lt; T_max (safety limit)</span>
<span id="cb14-371"><a href="#cb14-371" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Last resort: Emergency cooling, feed shutoff, depressurization</span>
<span id="cb14-372"><a href="#cb14-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-373"><a href="#cb14-373" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Economic Optimization**:</span>
<span id="cb14-374"><a href="#cb14-374" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Maximize profit = revenue - costs</span>
<span id="cb14-375"><a href="#cb14-375" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Revenue: Product value = price × F × conversion</span>
<span id="cb14-376"><a href="#cb14-376" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Costs: Cooling energy, reactant waste, equipment wear</span>
<span id="cb14-377"><a href="#cb14-377" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Often operates close to instability boundary for maximum conversion</span>
<span id="cb14-378"><a href="#cb14-378" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tradeoff: Higher conversion (profit) vs safety margin (risk)</span>
<span id="cb14-379"><a href="#cb14-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-380"><a href="#cb14-380" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Disturbance Rejection**:</span>
<span id="cb14-381"><a href="#cb14-381" aria-hidden="true" tabindex="-1"></a>   Common disturbances:</span>
<span id="cb14-382"><a href="#cb14-382" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Feed concentration variations: Cₐ,feed(t)</span>
<span id="cb14-383"><a href="#cb14-383" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Feed temperature changes: T_feed(t)</span>
<span id="cb14-384"><a href="#cb14-384" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Flow rate fluctuations: F(t)</span>
<span id="cb14-385"><a href="#cb14-385" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ambient temperature (affects jacket): T_ambient(t)</span>
<span id="cb14-386"><a href="#cb14-386" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Catalyst deactivation: k₀(t) decreases slowly</span>
<span id="cb14-387"><a href="#cb14-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-388"><a href="#cb14-388" aria-hidden="true" tabindex="-1"></a><span class="fu">## State Constraints: {.doc-section .doc-section-state-constraints}</span></span>
<span id="cb14-389"><a href="#cb14-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-390"><a href="#cb14-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-391"><a href="#cb14-391" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Non-negativity**: Cₐ ≥ 0</span>
<span id="cb14-392"><a href="#cb14-392" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Concentration cannot be negative (physical)</span>
<span id="cb14-393"><a href="#cb14-393" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Rarely active (implies complete conversion)</span>
<span id="cb14-394"><a href="#cb14-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-395"><a href="#cb14-395" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Concentration Bounds**: 0 ≤ Cₐ ≤ Cₐ,feed</span>
<span id="cb14-396"><a href="#cb14-396" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Cannot exceed feed (dilution + reaction only decrease)</span>
<span id="cb14-397"><a href="#cb14-397" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Upper bound active only if no reaction occurs</span>
<span id="cb14-398"><a href="#cb14-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-399"><a href="#cb14-399" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Temperature Limits**: T_min ≤ T ≤ T_max</span>
<span id="cb14-400"><a href="#cb14-400" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Lower limit**: Prevent solidification/freezing (≈ 280 K)</span>
<span id="cb14-401"><a href="#cb14-401" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Upper limit**: Safety, prevent runaway (≈ 450-500 K)</span>
<span id="cb14-402"><a href="#cb14-402" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Material limits: polymer degradation, wall integrity</span>
<span id="cb14-403"><a href="#cb14-403" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Most critical constraint for safety**</span>
<span id="cb14-404"><a href="#cb14-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-405"><a href="#cb14-405" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Jacket Temperature Limits**: T_jacket,min ≤ T_jacket ≤ T_jacket,max</span>
<span id="cb14-406"><a href="#cb14-406" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Chiller capacity: T_jacket,min ≈ 280 K</span>
<span id="cb14-407"><a href="#cb14-407" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Heater capacity: T_jacket,max ≈ 400 K</span>
<span id="cb14-408"><a href="#cb14-408" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Rate limit: |dT_jacket/dt| ≤ rate_max (jacket dynamics)</span>
<span id="cb14-409"><a href="#cb14-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-410"><a href="#cb14-410" aria-hidden="true" tabindex="-1"></a><span class="fu">## Time Scales and Dynamics: {.doc-section .doc-section-time-scales-and-dynamics}</span></span>
<span id="cb14-411"><a href="#cb14-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-412"><a href="#cb14-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-413"><a href="#cb14-413" aria-hidden="true" tabindex="-1"></a>**Multiple Time Scales** make CSTR dynamics rich and challenging:</span>
<span id="cb14-414"><a href="#cb14-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-415"><a href="#cb14-415" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Fast Scale - Reaction**: t_reaction = 1/k</span>
<span id="cb14-416"><a href="#cb14-416" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>At low T (350 K): t_reaction ≈ 10-100 s</span>
<span id="cb14-417"><a href="#cb14-417" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>At high T (400 K): t_reaction ≈ 0.1-1 s</span>
<span id="cb14-418"><a href="#cb14-418" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Exponentially dependent on temperature</span>
<span id="cb14-419"><a href="#cb14-419" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Can be very fast at high conversion state</span>
<span id="cb14-420"><a href="#cb14-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-421"><a href="#cb14-421" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Medium Scale - Residence Time**: t_residence = τ = V/F</span>
<span id="cb14-422"><a href="#cb14-422" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Typical: 10-1000 s (seconds to minutes)</span>
<span id="cb14-423"><a href="#cb14-423" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time for complete turnover of reactor contents</span>
<span id="cb14-424"><a href="#cb14-424" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Natural time scale for concentration changes</span>
<span id="cb14-425"><a href="#cb14-425" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Design parameter</span>
<span id="cb14-426"><a href="#cb14-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-427"><a href="#cb14-427" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Slow Scale - Thermal**: t_thermal = VρCₚ/UA</span>
<span id="cb14-428"><a href="#cb14-428" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Typical: 100-10,000 s (minutes to hours)</span>
<span id="cb14-429"><a href="#cb14-429" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Time constant for temperature response</span>
<span id="cb14-430"><a href="#cb14-430" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Limited by heat transfer through jacket</span>
<span id="cb14-431"><a href="#cb14-431" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Design parameter (limited by area, jacket design)</span>
<span id="cb14-432"><a href="#cb14-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-433"><a href="#cb14-433" aria-hidden="true" tabindex="-1"></a>**Stiffness**: When time scales differ by orders of magnitude:</span>
<span id="cb14-434"><a href="#cb14-434" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fast reactions with slow heat transfer → stiff system</span>
<span id="cb14-435"><a href="#cb14-435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Requires implicit ODE solvers (Radau, BDF)</span>
<span id="cb14-436"><a href="#cb14-436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small numerical errors in fast variables → large errors in slow variables</span>
<span id="cb14-437"><a href="#cb14-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-438"><a href="#cb14-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integration Recommendations: {.doc-section .doc-section-integration-recommendations}</span></span>
<span id="cb14-439"><a href="#cb14-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-440"><a href="#cb14-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-441"><a href="#cb14-441" aria-hidden="true" tabindex="-1"></a>**Solver Selection**:</span>
<span id="cb14-442"><a href="#cb14-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-443"><a href="#cb14-443" aria-hidden="true" tabindex="-1"></a>For most CSTR problems:</span>
<span id="cb14-444"><a href="#cb14-444" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Moderate stiffness**: RK45 (adaptive Runge-Kutta) works well</span>
<span id="cb14-445"><a href="#cb14-445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High stiffness**: Use stiff solvers</span>
<span id="cb14-446"><a href="#cb14-446" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>scipy: Radau, BDF, LSODA (auto-switching)</span>
<span id="cb14-447"><a href="#cb14-447" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Julia (DiffEqPy): Rosenbrock23, Rodas5</span>
<span id="cb14-448"><a href="#cb14-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-449"><a href="#cb14-449" aria-hidden="true" tabindex="-1"></a>**Tolerance Selection**:</span>
<span id="cb14-450"><a href="#cb14-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Standard simulation: rtol=1e-6, atol=1e-8</span>
<span id="cb14-451"><a href="#cb14-451" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High accuracy (optimization): rtol=1e-9, atol=1e-11</span>
<span id="cb14-452"><a href="#cb14-452" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Looser tolerances may miss important dynamics</span>
<span id="cb14-453"><a href="#cb14-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-454"><a href="#cb14-454" aria-hidden="true" tabindex="-1"></a>**Event Detection**:</span>
<span id="cb14-455"><a href="#cb14-455" aria-hidden="true" tabindex="-1"></a>For safety-critical applications, use event detection:</span>
<span id="cb14-456"><a href="#cb14-456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Detect T &gt; T_max (runaway)</span>
<span id="cb14-457"><a href="#cb14-457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Detect dT/dt &gt; threshold (incipient runaway)</span>
<span id="cb14-458"><a href="#cb14-458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Detect steady state (convergence)</span>
<span id="cb14-459"><a href="#cb14-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-460"><a href="#cb14-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example Usage: {.doc-section .doc-section-example-usage}</span></span>
<span id="cb14-461"><a href="#cb14-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-462"><a href="#cb14-462" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Create CSTR with default parameters</span></span>
<span id="cb14-463"><a href="#cb14-463" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; cstr = ContinuousCSTR(F=100.0, V=100.0)</span></span>
<span id="cb14-464"><a href="#cb14-464" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-465"><a href="#cb14-465" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Find all steady states for given jacket temperature</span></span>
<span id="cb14-466"><a href="#cb14-466" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; T_jacket_op = 350.0</span></span>
<span id="cb14-467"><a href="#cb14-467" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; steady_states = cstr.find_steady_states(T_jacket_op)</span></span>
<span id="cb14-468"><a href="#cb14-468" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"Found {len(steady_states)} steady states:")</span></span>
<span id="cb14-469"><a href="#cb14-469" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; for i, (C_A, T) in enumerate(steady_states):</span></span>
<span id="cb14-470"><a href="#cb14-470" aria-hidden="true" tabindex="-1"></a><span class="at">...     print(f"  State {i+1}: Cₐ={C_A:.3f} mol/L, T={T:.1f} K")</span></span>
<span id="cb14-471"><a href="#cb14-471" aria-hidden="true" tabindex="-1"></a><span class="at">...     print(f"    Conversion: {cstr.compute_conversion(C_A, 1.0)*100:.1f}%")</span></span>
<span id="cb14-472"><a href="#cb14-472" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-473"><a href="#cb14-473" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Choose high-conversion operating point</span></span>
<span id="cb14-474"><a href="#cb14-474" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; if len(steady_states) &gt;= 2:</span></span>
<span id="cb14-475"><a href="#cb14-475" aria-hidden="true" tabindex="-1"></a><span class="at">...     # High-conversion state (highest T, lowest Cₐ)</span></span>
<span id="cb14-476"><a href="#cb14-476" aria-hidden="true" tabindex="-1"></a><span class="at">...     steady_states_sorted = sorted(steady_states, key=lambda x: x</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">, reverse=True)</span></span>
<span id="cb14-477"><a href="#cb14-477" aria-hidden="true" tabindex="-1"></a><span class="at">...     C_A_op, T_op = steady_states_sorted</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span></span>
<span id="cb14-478"><a href="#cb14-478" aria-hidden="true" tabindex="-1"></a><span class="at">...     x_op = np.array(</span><span class="co">[</span><span class="ot">C_A_op, T_op</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-479"><a href="#cb14-479" aria-hidden="true" tabindex="-1"></a><span class="at">...     u_op = np.array(</span><span class="co">[</span><span class="ot">T_jacket_op</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-480"><a href="#cb14-480" aria-hidden="true" tabindex="-1"></a><span class="at">... else:</span></span>
<span id="cb14-481"><a href="#cb14-481" aria-hidden="true" tabindex="-1"></a><span class="at">...     # Use provided or default operating point</span></span>
<span id="cb14-482"><a href="#cb14-482" aria-hidden="true" tabindex="-1"></a><span class="at">...     x_op = np.array(</span><span class="co">[</span><span class="ot">0.1, 390.0</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-483"><a href="#cb14-483" aria-hidden="true" tabindex="-1"></a><span class="at">...     u_op = np.array(</span><span class="co">[</span><span class="ot">350.0</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-484"><a href="#cb14-484" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-485"><a href="#cb14-485" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Verify equilibrium</span></span>
<span id="cb14-486"><a href="#cb14-486" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; dx = cstr(x_op, u_op)</span></span>
<span id="cb14-487"><a href="#cb14-487" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"\nEquilibrium check: </span><span class="pp">||</span><span class="at">dx/dt</span><span class="pp">||</span><span class="at"> = {np.linalg.norm(dx):.2e}")</span></span>
<span id="cb14-488"><a href="#cb14-488" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-489"><a href="#cb14-489" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Linearize at operating point</span></span>
<span id="cb14-490"><a href="#cb14-490" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; A, B = cstr.linearize(x_op, u_op)</span></span>
<span id="cb14-491"><a href="#cb14-491" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; eigenvalues = np.linalg.eigvals(A)</span></span>
<span id="cb14-492"><a href="#cb14-492" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"\nLinearized eigenvalues: {eigenvalues}")</span></span>
<span id="cb14-493"><a href="#cb14-493" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"Stable: {np.all(np.real(eigenvalues) &lt; 0)}")</span></span>
<span id="cb14-494"><a href="#cb14-494" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-495"><a href="#cb14-495" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Design LQR controller (emphasize temperature control)</span></span>
<span id="cb14-496"><a href="#cb14-496" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; Q = np.diag(</span><span class="co">[</span><span class="ot">1.0, 100.0</span><span class="co">]</span><span class="at">)  # Penalize temperature error heavily</span></span>
<span id="cb14-497"><a href="#cb14-497" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; R = np.array([</span><span class="co">[</span><span class="ot">1.0</span><span class="co">]</span><span class="at">])</span></span>
<span id="cb14-498"><a href="#cb14-498" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; lqr_result = cstr.control.design_lqr(A, B, Q, R, system_type='continuous')</span></span>
<span id="cb14-499"><a href="#cb14-499" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; K = lqr_result</span><span class="co">[</span><span class="ot">'gain'</span><span class="co">]</span></span>
<span id="cb14-500"><a href="#cb14-500" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-501"><a href="#cb14-501" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Simulate with LQR control and disturbance</span></span>
<span id="cb14-502"><a href="#cb14-502" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; def lqr_controller(x, t):</span></span>
<span id="cb14-503"><a href="#cb14-503" aria-hidden="true" tabindex="-1"></a><span class="at">...     # Add feed temperature disturbance at t=50s</span></span>
<span id="cb14-504"><a href="#cb14-504" aria-hidden="true" tabindex="-1"></a><span class="at">...     if t &gt; 50:</span></span>
<span id="cb14-505"><a href="#cb14-505" aria-hidden="true" tabindex="-1"></a><span class="at">...         # Disturbance increases effective T_feed by changing heat balance</span></span>
<span id="cb14-506"><a href="#cb14-506" aria-hidden="true" tabindex="-1"></a><span class="at">...         # Compensate by reducing jacket temperature</span></span>
<span id="cb14-507"><a href="#cb14-507" aria-hidden="true" tabindex="-1"></a><span class="at">...         disturbance_compensation = -2.0</span></span>
<span id="cb14-508"><a href="#cb14-508" aria-hidden="true" tabindex="-1"></a><span class="at">...     else:</span></span>
<span id="cb14-509"><a href="#cb14-509" aria-hidden="true" tabindex="-1"></a><span class="at">...         disturbance_compensation = 0.0</span></span>
<span id="cb14-510"><a href="#cb14-510" aria-hidden="true" tabindex="-1"></a><span class="at">...</span></span>
<span id="cb14-511"><a href="#cb14-511" aria-hidden="true" tabindex="-1"></a><span class="at">...     u_fb = -K @ (x - x_op) + u_op</span></span>
<span id="cb14-512"><a href="#cb14-512" aria-hidden="true" tabindex="-1"></a><span class="at">...     return u_fb + disturbance_compensation</span></span>
<span id="cb14-513"><a href="#cb14-513" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-514"><a href="#cb14-514" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Perturb from equilibrium</span></span>
<span id="cb14-515"><a href="#cb14-515" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; x0 = x_op + np.array(</span><span class="co">[</span><span class="ot">0.05, -5.0</span><span class="co">]</span><span class="at">)  # Small perturbation</span></span>
<span id="cb14-516"><a href="#cb14-516" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-517"><a href="#cb14-517" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; result = cstr.simulate(</span></span>
<span id="cb14-518"><a href="#cb14-518" aria-hidden="true" tabindex="-1"></a><span class="at">...     x0=x0,</span></span>
<span id="cb14-519"><a href="#cb14-519" aria-hidden="true" tabindex="-1"></a><span class="at">...     controller=lqr_controller,</span></span>
<span id="cb14-520"><a href="#cb14-520" aria-hidden="true" tabindex="-1"></a><span class="at">...     t_span=(0, 200),</span></span>
<span id="cb14-521"><a href="#cb14-521" aria-hidden="true" tabindex="-1"></a><span class="at">...     dt=0.1,</span></span>
<span id="cb14-522"><a href="#cb14-522" aria-hidden="true" tabindex="-1"></a><span class="at">...     method='Radau'  # Stiff solver</span></span>
<span id="cb14-523"><a href="#cb14-523" aria-hidden="true" tabindex="-1"></a><span class="at">... )</span></span>
<span id="cb14-524"><a href="#cb14-524" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-525"><a href="#cb14-525" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Plot results</span></span>
<span id="cb14-526"><a href="#cb14-526" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; import matplotlib.pyplot as plt</span></span>
<span id="cb14-527"><a href="#cb14-527" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; fig, axes = plt.subplots(3, 1, figsize=(10, 8))</span></span>
<span id="cb14-528"><a href="#cb14-528" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-529"><a href="#cb14-529" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Concentration</span></span>
<span id="cb14-530"><a href="#cb14-530" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">.plot(result</span><span class="co">[</span><span class="ot">'time'</span><span class="co">]</span><span class="at">, result</span><span class="co">[</span><span class="ot">'states'</span><span class="co">][:, 0]</span><span class="at">)</span></span>
<span id="cb14-531"><a href="#cb14-531" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">.axhline(x_op</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">, color='r', linestyle='--', label='Setpoint')</span></span>
<span id="cb14-532"><a href="#cb14-532" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">.set_ylabel('Cₐ </span><span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span><span class="at">')</span></span>
<span id="cb14-533"><a href="#cb14-533" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">.legend()</span></span>
<span id="cb14-534"><a href="#cb14-534" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">.grid(True)</span></span>
<span id="cb14-535"><a href="#cb14-535" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-536"><a href="#cb14-536" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Temperature</span></span>
<span id="cb14-537"><a href="#cb14-537" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">.plot(result</span><span class="co">[</span><span class="ot">'time'</span><span class="co">]</span><span class="at">, result</span><span class="co">[</span><span class="ot">'states'</span><span class="co">][:, 1]</span><span class="at">)</span></span>
<span id="cb14-538"><a href="#cb14-538" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">.axhline(x_op</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">, color='r', linestyle='--', label='Setpoint')</span></span>
<span id="cb14-539"><a href="#cb14-539" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">.set_ylabel('T </span><span class="co">[</span><span class="ot">K</span><span class="co">]</span><span class="at">')</span></span>
<span id="cb14-540"><a href="#cb14-540" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">.legend()</span></span>
<span id="cb14-541"><a href="#cb14-541" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">.grid(True)</span></span>
<span id="cb14-542"><a href="#cb14-542" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-543"><a href="#cb14-543" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Control action</span></span>
<span id="cb14-544"><a href="#cb14-544" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">2</span><span class="co">]</span><span class="at">.plot(result</span><span class="co">[</span><span class="ot">'time'</span><span class="co">]</span><span class="at">, result</span><span class="co">[</span><span class="ot">'controls'</span><span class="co">][:, 0]</span><span class="at">)</span></span>
<span id="cb14-545"><a href="#cb14-545" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">2</span><span class="co">]</span><span class="at">.axhline(u_op</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">, color='r', linestyle='--', label='Nominal')</span></span>
<span id="cb14-546"><a href="#cb14-546" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">2</span><span class="co">]</span><span class="at">.set_ylabel('T_jacket </span><span class="co">[</span><span class="ot">K</span><span class="co">]</span><span class="at">')</span></span>
<span id="cb14-547"><a href="#cb14-547" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">2</span><span class="co">]</span><span class="at">.set_xlabel('Time </span><span class="co">[</span><span class="ot">s</span><span class="co">]</span><span class="at">')</span></span>
<span id="cb14-548"><a href="#cb14-548" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">2</span><span class="co">]</span><span class="at">.legend()</span></span>
<span id="cb14-549"><a href="#cb14-549" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; axes</span><span class="co">[</span><span class="ot">2</span><span class="co">]</span><span class="at">.grid(True)</span></span>
<span id="cb14-550"><a href="#cb14-550" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-551"><a href="#cb14-551" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.tight_layout()</span></span>
<span id="cb14-552"><a href="#cb14-552" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.show()</span></span>
<span id="cb14-553"><a href="#cb14-553" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-554"><a href="#cb14-554" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Startup simulation: low → high conversion</span></span>
<span id="cb14-555"><a href="#cb14-555" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Start at low-conversion steady state</span></span>
<span id="cb14-556"><a href="#cb14-556" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; if len(steady_states) &gt;= 3:</span></span>
<span id="cb14-557"><a href="#cb14-557" aria-hidden="true" tabindex="-1"></a><span class="at">...     C_A_low, T_low = steady_states_sorted</span><span class="co">[</span><span class="ot">-1</span><span class="co">]</span><span class="at">  # Lowest temperature state</span></span>
<span id="cb14-558"><a href="#cb14-558" aria-hidden="true" tabindex="-1"></a><span class="at">...     x_low = np.array(</span><span class="co">[</span><span class="ot">C_A_low, T_low</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-559"><a href="#cb14-559" aria-hidden="true" tabindex="-1"></a><span class="at">... else:</span></span>
<span id="cb14-560"><a href="#cb14-560" aria-hidden="true" tabindex="-1"></a><span class="at">...     x_low = np.array(</span><span class="co">[</span><span class="ot">0.9, 360.0</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-561"><a href="#cb14-561" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-562"><a href="#cb14-562" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; def startup_controller(x, t):</span></span>
<span id="cb14-563"><a href="#cb14-563" aria-hidden="true" tabindex="-1"></a><span class="at">...     '''Aggressive cooling for startup, then switch to regulator'''</span></span>
<span id="cb14-564"><a href="#cb14-564" aria-hidden="true" tabindex="-1"></a><span class="at">...     if t &lt; 100:</span></span>
<span id="cb14-565"><a href="#cb14-565" aria-hidden="true" tabindex="-1"></a><span class="at">...         # Phase 1: Aggressive cooling to jump to high-conversion state</span></span>
<span id="cb14-566"><a href="#cb14-566" aria-hidden="true" tabindex="-1"></a><span class="at">...         return np.array(</span><span class="co">[</span><span class="ot">330.0</span><span class="co">]</span><span class="at">)  # Cold jacket</span></span>
<span id="cb14-567"><a href="#cb14-567" aria-hidden="true" tabindex="-1"></a><span class="at">...     else:</span></span>
<span id="cb14-568"><a href="#cb14-568" aria-hidden="true" tabindex="-1"></a><span class="at">...         # Phase 2: LQR regulation around high-conversion setpoint</span></span>
<span id="cb14-569"><a href="#cb14-569" aria-hidden="true" tabindex="-1"></a><span class="at">...         return lqr_controller(x, t)</span></span>
<span id="cb14-570"><a href="#cb14-570" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-571"><a href="#cb14-571" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; result_startup = cstr.simulate(</span></span>
<span id="cb14-572"><a href="#cb14-572" aria-hidden="true" tabindex="-1"></a><span class="at">...     x0=x_low,</span></span>
<span id="cb14-573"><a href="#cb14-573" aria-hidden="true" tabindex="-1"></a><span class="at">...     controller=startup_controller,</span></span>
<span id="cb14-574"><a href="#cb14-574" aria-hidden="true" tabindex="-1"></a><span class="at">...     t_span=(0, 300),</span></span>
<span id="cb14-575"><a href="#cb14-575" aria-hidden="true" tabindex="-1"></a><span class="at">...     dt=0.1,</span></span>
<span id="cb14-576"><a href="#cb14-576" aria-hidden="true" tabindex="-1"></a><span class="at">...     method='Radau'</span></span>
<span id="cb14-577"><a href="#cb14-577" aria-hidden="true" tabindex="-1"></a><span class="at">... )</span></span>
<span id="cb14-578"><a href="#cb14-578" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-579"><a href="#cb14-579" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Check if startup succeeded</span></span>
<span id="cb14-580"><a href="#cb14-580" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; final_state = result_startup</span><span class="co">[</span><span class="ot">'states'</span><span class="co">][-1, :]</span></span>
<span id="cb14-581"><a href="#cb14-581" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; distance = np.linalg.norm(final_state - x_op)</span></span>
<span id="cb14-582"><a href="#cb14-582" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"\nStartup result:")</span></span>
<span id="cb14-583"><a href="#cb14-583" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"  Final state: Cₐ={final_state</span><span class="co">[</span><span class="ot">0</span><span class="co">]</span><span class="at">:.3f}, T={final_state</span><span class="co">[</span><span class="ot">1</span><span class="co">]</span><span class="at">:.1f}")</span></span>
<span id="cb14-584"><a href="#cb14-584" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"  Distance to target: {distance:.3f}")</span></span>
<span id="cb14-585"><a href="#cb14-585" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; print(f"  Success: {distance &lt; 5.0}")</span></span>
<span id="cb14-586"><a href="#cb14-586" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-587"><a href="#cb14-587" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Phase portrait (requires multiple simulations)</span></span>
<span id="cb14-588"><a href="#cb14-588" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Shows basins of attraction for multiple steady states</span></span>
<span id="cb14-589"><a href="#cb14-589" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-590"><a href="#cb14-590" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Bifurcation diagram (vary T_jacket)</span></span>
<span id="cb14-591"><a href="#cb14-591" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; T_jacket_range = np.linspace(320, 360, 20)</span></span>
<span id="cb14-592"><a href="#cb14-592" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; bifurcation_data = {'T_jacket': [], 'C_A': [], 'T': [], 'stable': []}</span></span>
<span id="cb14-593"><a href="#cb14-593" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-594"><a href="#cb14-594" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; for Tj in T_jacket_range:</span></span>
<span id="cb14-595"><a href="#cb14-595" aria-hidden="true" tabindex="-1"></a><span class="at">...     states = cstr.find_steady_states(Tj)</span></span>
<span id="cb14-596"><a href="#cb14-596" aria-hidden="true" tabindex="-1"></a><span class="at">...     for C_A, T in states:</span></span>
<span id="cb14-597"><a href="#cb14-597" aria-hidden="true" tabindex="-1"></a><span class="at">...         # Check stability</span></span>
<span id="cb14-598"><a href="#cb14-598" aria-hidden="true" tabindex="-1"></a><span class="at">...         A_local, _ = cstr.linearize(np.array(</span><span class="co">[</span><span class="ot">C_A, T</span><span class="co">]</span><span class="at">), np.array(</span><span class="co">[</span><span class="ot">Tj</span><span class="co">]</span><span class="at">))</span></span>
<span id="cb14-599"><a href="#cb14-599" aria-hidden="true" tabindex="-1"></a><span class="at">...         eigs = np.linalg.eigvals(A_local)</span></span>
<span id="cb14-600"><a href="#cb14-600" aria-hidden="true" tabindex="-1"></a><span class="at">...         is_stable = np.all(np.real(eigs) &lt; 0)</span></span>
<span id="cb14-601"><a href="#cb14-601" aria-hidden="true" tabindex="-1"></a><span class="at">...</span></span>
<span id="cb14-602"><a href="#cb14-602" aria-hidden="true" tabindex="-1"></a><span class="at">...         bifurcation_data</span><span class="co">[</span><span class="ot">'T_jacket'</span><span class="co">]</span><span class="at">.append(Tj)</span></span>
<span id="cb14-603"><a href="#cb14-603" aria-hidden="true" tabindex="-1"></a><span class="at">...         bifurcation_data</span><span class="co">[</span><span class="ot">'C_A'</span><span class="co">]</span><span class="at">.append(C_A)</span></span>
<span id="cb14-604"><a href="#cb14-604" aria-hidden="true" tabindex="-1"></a><span class="at">...         bifurcation_data</span><span class="co">[</span><span class="ot">'T'</span><span class="co">]</span><span class="at">.append(T)</span></span>
<span id="cb14-605"><a href="#cb14-605" aria-hidden="true" tabindex="-1"></a><span class="at">...         bifurcation_data</span><span class="co">[</span><span class="ot">'stable'</span><span class="co">]</span><span class="at">.append(is_stable)</span></span>
<span id="cb14-606"><a href="#cb14-606" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt;</span></span>
<span id="cb14-607"><a href="#cb14-607" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; # Plot bifurcation diagram</span></span>
<span id="cb14-608"><a href="#cb14-608" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.figure(figsize=(10, 6))</span></span>
<span id="cb14-609"><a href="#cb14-609" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; stable = np.array(bifurcation_data</span><span class="co">[</span><span class="ot">'stable'</span><span class="co">]</span><span class="at">)</span></span>
<span id="cb14-610"><a href="#cb14-610" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.plot(</span></span>
<span id="cb14-611"><a href="#cb14-611" aria-hidden="true" tabindex="-1"></a><span class="at">...     np.array(bifurcation_data</span><span class="co">[</span><span class="ot">'T_jacket'</span><span class="co">]</span><span class="at">)</span><span class="co">[</span><span class="ot">stable</span><span class="co">]</span><span class="at">,</span></span>
<span id="cb14-612"><a href="#cb14-612" aria-hidden="true" tabindex="-1"></a><span class="at">...     np.array(bifurcation_data</span><span class="co">[</span><span class="ot">'T'</span><span class="co">]</span><span class="at">)</span><span class="co">[</span><span class="ot">stable</span><span class="co">]</span><span class="at">,</span></span>
<span id="cb14-613"><a href="#cb14-613" aria-hidden="true" tabindex="-1"></a><span class="at">...     'b-', linewidth=2, label='Stable'</span></span>
<span id="cb14-614"><a href="#cb14-614" aria-hidden="true" tabindex="-1"></a><span class="at">... )</span></span>
<span id="cb14-615"><a href="#cb14-615" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.plot(</span></span>
<span id="cb14-616"><a href="#cb14-616" aria-hidden="true" tabindex="-1"></a><span class="at">...     np.array(bifurcation_data</span><span class="co">[</span><span class="ot">'T_jacket'</span><span class="co">]</span><span class="at">)</span><span class="co">[</span><span class="ot">~stable</span><span class="co">]</span><span class="at">,</span></span>
<span id="cb14-617"><a href="#cb14-617" aria-hidden="true" tabindex="-1"></a><span class="at">...     np.array(bifurcation_data</span><span class="co">[</span><span class="ot">'T'</span><span class="co">]</span><span class="at">)</span><span class="co">[</span><span class="ot">~stable</span><span class="co">]</span><span class="at">,</span></span>
<span id="cb14-618"><a href="#cb14-618" aria-hidden="true" tabindex="-1"></a><span class="at">...     'r--', linewidth=2, label='Unstable'</span></span>
<span id="cb14-619"><a href="#cb14-619" aria-hidden="true" tabindex="-1"></a><span class="at">... )</span></span>
<span id="cb14-620"><a href="#cb14-620" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.xlabel('Jacket Temperature </span><span class="co">[</span><span class="ot">K</span><span class="co">]</span><span class="at">')</span></span>
<span id="cb14-621"><a href="#cb14-621" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.ylabel('Reactor Temperature </span><span class="co">[</span><span class="ot">K</span><span class="co">]</span><span class="at">')</span></span>
<span id="cb14-622"><a href="#cb14-622" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.title('CSTR Bifurcation Diagram')</span></span>
<span id="cb14-623"><a href="#cb14-623" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.legend()</span></span>
<span id="cb14-624"><a href="#cb14-624" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.grid(True)</span></span>
<span id="cb14-625"><a href="#cb14-625" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;&gt;&gt; plt.show()</span></span>
<span id="cb14-626"><a href="#cb14-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-627"><a href="#cb14-627" aria-hidden="true" tabindex="-1"></a><span class="fu">## Physical Insights: {.doc-section .doc-section-physical-insights}</span></span>
<span id="cb14-628"><a href="#cb14-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-629"><a href="#cb14-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-630"><a href="#cb14-630" aria-hidden="true" tabindex="-1"></a>**Why Multiple Steady States Occur**:</span>
<span id="cb14-631"><a href="#cb14-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-632"><a href="#cb14-632" aria-hidden="true" tabindex="-1"></a>The interplay between heat generation (nonlinear, S-shaped) and heat</span>
<span id="cb14-633"><a href="#cb14-633" aria-hidden="true" tabindex="-1"></a>removal (linear) creates the possibility of multiple intersections:</span>
<span id="cb14-634"><a href="#cb14-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-635"><a href="#cb14-635" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Low T region**:</span>
<span id="cb14-636"><a href="#cb14-636" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reaction slow (small exp(-E/T))</span>
<span id="cb14-637"><a href="#cb14-637" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Generation curve starts flat</span>
<span id="cb14-638"><a href="#cb14-638" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Removal line dominates → low-conversion stable</span>
<span id="cb14-639"><a href="#cb14-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-640"><a href="#cb14-640" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Medium T region**:</span>
<span id="cb14-641"><a href="#cb14-641" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reaction accelerates rapidly (exponential growth)</span>
<span id="cb14-642"><a href="#cb14-642" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Generation curve steepens dramatically</span>
<span id="cb14-643"><a href="#cb14-643" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Can intersect removal line 3 times</span>
<span id="cb14-644"><a href="#cb14-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-645"><a href="#cb14-645" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**High T region**:</span>
<span id="cb14-646"><a href="#cb14-646" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reaction very fast but Cₐ depleted</span>
<span id="cb14-647"><a href="#cb14-647" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Generation curve plateaus (limited by Cₐ)</span>
<span id="cb14-648"><a href="#cb14-648" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Removal continues linearly → high-conversion stable</span>
<span id="cb14-649"><a href="#cb14-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-650"><a href="#cb14-650" aria-hidden="true" tabindex="-1"></a>**Thermal Runaway Mechanism**:</span>
<span id="cb14-651"><a href="#cb14-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-652"><a href="#cb14-652" aria-hidden="true" tabindex="-1"></a>Positive feedback loop if cooling insufficient:</span>
<span id="cb14-653"><a href="#cb14-653" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Small T increase (disturbance or control action)</span>
<span id="cb14-654"><a href="#cb14-654" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Reaction rate jumps (exponential Arrhenius)</span>
<span id="cb14-655"><a href="#cb14-655" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>More heat generated (exothermic)</span>
<span id="cb14-656"><a href="#cb14-656" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Temperature rises further</span>
<span id="cb14-657"><a href="#cb14-657" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Loop continues → runaway!</span>
<span id="cb14-658"><a href="#cb14-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-659"><a href="#cb14-659" aria-hidden="true" tabindex="-1"></a>Stabilizing mechanisms:</span>
<span id="cb14-660"><a href="#cb14-660" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reactant depletion (limits generation at high T)</span>
<span id="cb14-661"><a href="#cb14-661" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Jacket cooling (removes heat)</span>
<span id="cb14-662"><a href="#cb14-662" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Feed cooling (convective heat removal)</span>
<span id="cb14-663"><a href="#cb14-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-664"><a href="#cb14-664" aria-hidden="true" tabindex="-1"></a>**Industrial Significance**:</span>
<span id="cb14-665"><a href="#cb14-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-666"><a href="#cb14-666" aria-hidden="true" tabindex="-1"></a>CSTRs are ubiquitous in chemical industry:</span>
<span id="cb14-667"><a href="#cb14-667" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Polymerization reactors</span>
<span id="cb14-668"><a href="#cb14-668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pharmaceutical synthesis</span>
<span id="cb14-669"><a href="#cb14-669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wastewater treatment (biological reactors)</span>
<span id="cb14-670"><a href="#cb14-670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fermentation processes</span>
<span id="cb14-671"><a href="#cb14-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-672"><a href="#cb14-672" aria-hidden="true" tabindex="-1"></a>Multiple steady states have practical implications:</span>
<span id="cb14-673"><a href="#cb14-673" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Startup**: Complex procedure to reach desired state</span>
<span id="cb14-674"><a href="#cb14-674" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Control**: Must prevent unintended switching</span>
<span id="cb14-675"><a href="#cb14-675" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Safety**: Runaway risk at high-conversion state</span>
<span id="cb14-676"><a href="#cb14-676" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Economics**: Higher conversion → more profit but harder control</span>
<span id="cb14-677"><a href="#cb14-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-678"><a href="#cb14-678" aria-hidden="true" tabindex="-1"></a>**Control Challenges**:</span>
<span id="cb14-679"><a href="#cb14-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-680"><a href="#cb14-680" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Nonlinearity**:</span>
<span id="cb14-681"><a href="#cb14-681" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Linear controllers (PID) may perform poorly</span>
<span id="cb14-682"><a href="#cb14-682" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Gain scheduling or nonlinear control needed</span>
<span id="cb14-683"><a href="#cb14-683" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Operating point dependent behavior</span>
<span id="cb14-684"><a href="#cb14-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-685"><a href="#cb14-685" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Instability risk**:</span>
<span id="cb14-686"><a href="#cb14-686" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>High-conversion state often close to instability</span>
<span id="cb14-687"><a href="#cb14-687" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Small disturbances can cause large excursions</span>
<span id="cb14-688"><a href="#cb14-688" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Need fast, aggressive control action</span>
<span id="cb14-689"><a href="#cb14-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-690"><a href="#cb14-690" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Constraints**:</span>
<span id="cb14-691"><a href="#cb14-691" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Temperature limits (safety)</span>
<span id="cb14-692"><a href="#cb14-692" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Jacket temperature limits (physical)</span>
<span id="cb14-693"><a href="#cb14-693" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Actuator saturation degrades performance</span>
<span id="cb14-694"><a href="#cb14-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-695"><a href="#cb14-695" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Multiple states**:</span>
<span id="cb14-696"><a href="#cb14-696" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>System can "jump" between states</span>
<span id="cb14-697"><a href="#cb14-697" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Hysteresis complicates control</span>
<span id="cb14-698"><a href="#cb14-698" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Need to prevent unintended transitions</span>
<span id="cb14-699"><a href="#cb14-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-700"><a href="#cb14-700" aria-hidden="true" tabindex="-1"></a>**Design Considerations**:</span>
<span id="cb14-701"><a href="#cb14-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-702"><a href="#cb14-702" aria-hidden="true" tabindex="-1"></a>For industrial CSTR design:</span>
<span id="cb14-703"><a href="#cb14-703" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Safety first**: Adequate cooling capacity (large UA)</span>
<span id="cb14-704"><a href="#cb14-704" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Residence time**: Balance conversion vs stability (choose V/F)</span>
<span id="cb14-705"><a href="#cb14-705" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Operating point**: High conversion but safe margin from instability</span>
<span id="cb14-706"><a href="#cb14-706" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Instrumentation**: Fast, reliable temperature measurement</span>
<span id="cb14-707"><a href="#cb14-707" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Emergency systems**: Backup cooling, feed shutoff, pressure relief</span>
<span id="cb14-708"><a href="#cb14-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-709"><a href="#cb14-709" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison with Other Reactors: {.doc-section .doc-section-comparison-with-other-reactors}</span></span>
<span id="cb14-710"><a href="#cb14-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-711"><a href="#cb14-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-712"><a href="#cb14-712" aria-hidden="true" tabindex="-1"></a>**CSTR vs Batch Reactor**:</span>
<span id="cb14-713"><a href="#cb14-713" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CSTR: Continuous operation, steady state, higher throughput</span>
<span id="cb14-714"><a href="#cb14-714" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Batch: Transient operation, finite time, better for small volumes</span>
<span id="cb14-715"><a href="#cb14-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-716"><a href="#cb14-716" aria-hidden="true" tabindex="-1"></a>**CSTR vs Plug Flow Reactor (PFR)**:</span>
<span id="cb14-717"><a href="#cb14-717" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CSTR: Back-mixed, uniform concentration/temperature</span>
<span id="cb14-718"><a href="#cb14-718" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>PFR: No back-mixing, concentration/temperature gradients</span>
<span id="cb14-719"><a href="#cb14-719" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>PFR: Generally more efficient but harder to control</span>
<span id="cb14-720"><a href="#cb14-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-721"><a href="#cb14-721" aria-hidden="true" tabindex="-1"></a>**CSTR vs Semi-Batch**:</span>
<span id="cb14-722"><a href="#cb14-722" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CSTR: Continuous in/out</span>
<span id="cb14-723"><a href="#cb14-723" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Semi-batch: Batch with continuous feed, better heat management</span>
<span id="cb14-724"><a href="#cb14-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-725"><a href="#cb14-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## See Also: {.doc-section .doc-section-see-also}</span></span>
<span id="cb14-726"><a href="#cb14-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-727"><a href="#cb14-727" aria-hidden="true" tabindex="-1"></a>DiscreteCSTR : Discrete-time version for digital control</span>
<span id="cb14-728"><a href="#cb14-728" aria-hidden="true" tabindex="-1"></a>ContinuousBatchReactor : Batch operation instead of continuous</span>
<span id="cb14-729"><a href="#cb14-729" aria-hidden="true" tabindex="-1"></a>DiscreteBatchReactor : Discrete batch reactor</span>
<span id="cb14-730"><a href="#cb14-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-731"><a href="#cb14-731" aria-hidden="true" tabindex="-1"></a><span class="fu">## Notes: {.doc-section .doc-section-notes}</span></span>
<span id="cb14-732"><a href="#cb14-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-733"><a href="#cb14-733" aria-hidden="true" tabindex="-1"></a>**Extensions**:</span>
<span id="cb14-734"><a href="#cb14-734" aria-hidden="true" tabindex="-1"></a>More complex CSTR models can include:</span>
<span id="cb14-735"><a href="#cb14-735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple reactions (A → B → C, parallel reactions)</span>
<span id="cb14-736"><a href="#cb14-736" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Non-ideal mixing (RTD, compartment models)</span>
<span id="cb14-737"><a href="#cb14-737" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Jacket dynamics (first-order lag in cooling)</span>
<span id="cb14-738"><a href="#cb14-738" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Catalyst deactivation (slow time scale)</span>
<span id="cb14-739"><a href="#cb14-739" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>pH effects (additional state)</span>
<span id="cb14-740"><a href="#cb14-740" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gas-liquid reactions (mass transfer limitations)</span>
<span id="cb14-741"><a href="#cb14-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-742"><a href="#cb14-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb14-743"><a href="#cb14-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-744"><a href="#cb14-744" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name <span class="pp">|</span> Description <span class="pp">|</span></span>
<span id="cb14-745"><a href="#cb14-745" aria-hidden="true" tabindex="-1"></a><span class="pp">| ---</span> <span class="pp">| ---</span> <span class="pp">|</span></span>
<span id="cb14-746"><a href="#cb14-746" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">compute_conversion</span><span class="co">](#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion)</span> <span class="pp">|</span> Compute fractional conversion of reactant A. <span class="pp">|</span></span>
<span id="cb14-747"><a href="#cb14-747" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">compute_damkohler_number</span><span class="co">](#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number)</span> <span class="pp">|</span> Compute Damköhler number Da = k·τ (reaction rate × residence time). <span class="pp">|</span></span>
<span id="cb14-748"><a href="#cb14-748" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">compute_residence_time</span><span class="co">](#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time)</span> <span class="pp">|</span> Compute residence time τ = V/F. <span class="pp">|</span></span>
<span id="cb14-749"><a href="#cb14-749" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">define_system</span><span class="co">](#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system)</span> <span class="pp">|</span> Define continuous-time CSTR dynamics. <span class="pp">|</span></span>
<span id="cb14-750"><a href="#cb14-750" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">find_steady_states</span><span class="co">](#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states)</span> <span class="pp">|</span> Find all steady states for a given jacket temperature. <span class="pp">|</span></span>
<span id="cb14-751"><a href="#cb14-751" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">setup_equilibria</span><span class="co">](#cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria)</span> <span class="pp">|</span> Set up steady-state equilibrium if provided. <span class="pp">|</span></span>
<span id="cb14-752"><a href="#cb14-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-753"><a href="#cb14-753" aria-hidden="true" tabindex="-1"></a><span class="fu">### compute_conversion { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion }</span></span>
<span id="cb14-754"><a href="#cb14-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-755"><a href="#cb14-755" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-756"><a href="#cb14-756" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.compute_conversion(</span>
<span id="cb14-757"><a href="#cb14-757" aria-hidden="true" tabindex="-1"></a>    C_A,</span>
<span id="cb14-758"><a href="#cb14-758" aria-hidden="true" tabindex="-1"></a>    C_A_feed,</span>
<span id="cb14-759"><a href="#cb14-759" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-760"><a href="#cb14-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-761"><a href="#cb14-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-762"><a href="#cb14-762" aria-hidden="true" tabindex="-1"></a>Compute fractional conversion of reactant A.</span>
<span id="cb14-763"><a href="#cb14-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-764"><a href="#cb14-764" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb14-765"><a href="#cb14-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-766"><a href="#cb14-766" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name     <span class="pp">|</span> Type   <span class="pp">|</span> Description                           <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb14-767"><a href="#cb14-767" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|--------|---------------------------------------|------------|</span></span>
<span id="cb14-768"><a href="#cb14-768" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A      <span class="pp">|</span> float  <span class="pp">|</span> Current reactor concentration <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span> <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb14-769"><a href="#cb14-769" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A_feed <span class="pp">|</span> float  <span class="pp">|</span> Feed concentration <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span>            <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb14-770"><a href="#cb14-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-771"><a href="#cb14-771" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb14-772"><a href="#cb14-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-773"><a href="#cb14-773" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description                                           <span class="pp">|</span></span>
<span id="cb14-774"><a href="#cb14-774" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|-------------------------------------------------------|</span></span>
<span id="cb14-775"><a href="#cb14-775" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> float  <span class="pp">|</span> Conversion fraction X_A = (C_A_feed - C_A) / C_A_feed <span class="pp">|</span></span>
<span id="cb14-776"><a href="#cb14-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-777"><a href="#cb14-777" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb14-778"><a href="#cb14-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-779"><a href="#cb14-779" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-780"><a href="#cb14-780" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR()</span>
<span id="cb14-781"><a href="#cb14-781" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> X <span class="op">=</span> cstr.compute_conversion(C_A<span class="op">=</span><span class="fl">0.1</span>, C_A_feed<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb14-782"><a href="#cb14-782" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Conversion: </span><span class="sc">{</span>X<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb14-783"><a href="#cb14-783" aria-hidden="true" tabindex="-1"></a>Conversion: <span class="fl">90.0</span><span class="op">%</span></span>
<span id="cb14-784"><a href="#cb14-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-785"><a href="#cb14-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-786"><a href="#cb14-786" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb14-787"><a href="#cb14-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-788"><a href="#cb14-788" aria-hidden="true" tabindex="-1"></a>High conversion (X &gt; 0.9) typically corresponds to high-temperature</span>
<span id="cb14-789"><a href="#cb14-789" aria-hidden="true" tabindex="-1"></a>steady state with fast kinetics and strong exothermic heat generation.</span>
<span id="cb14-790"><a href="#cb14-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-791"><a href="#cb14-791" aria-hidden="true" tabindex="-1"></a><span class="fu">### compute_damkohler_number { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number }</span></span>
<span id="cb14-792"><a href="#cb14-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-793"><a href="#cb14-793" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-794"><a href="#cb14-794" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.compute_damkohler_number(</span>
<span id="cb14-795"><a href="#cb14-795" aria-hidden="true" tabindex="-1"></a>    T,</span>
<span id="cb14-796"><a href="#cb14-796" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-797"><a href="#cb14-797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-798"><a href="#cb14-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-799"><a href="#cb14-799" aria-hidden="true" tabindex="-1"></a>Compute Damköhler number Da = k·τ (reaction rate × residence time).</span>
<span id="cb14-800"><a href="#cb14-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-801"><a href="#cb14-801" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb14-802"><a href="#cb14-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-803"><a href="#cb14-803" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description     <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb14-804"><a href="#cb14-804" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|-----------------|------------|</span></span>
<span id="cb14-805"><a href="#cb14-805" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T      <span class="pp">|</span> float  <span class="pp">|</span> Temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span> <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb14-806"><a href="#cb14-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-807"><a href="#cb14-807" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb14-808"><a href="#cb14-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-809"><a href="#cb14-809" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description                      <span class="pp">|</span></span>
<span id="cb14-810"><a href="#cb14-810" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|----------------------------------|</span></span>
<span id="cb14-811"><a href="#cb14-811" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> float  <span class="pp">|</span> Damköhler number <span class="co">[</span><span class="ot">dimensionless</span><span class="co">]</span> <span class="pp">|</span></span>
<span id="cb14-812"><a href="#cb14-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-813"><a href="#cb14-813" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb14-814"><a href="#cb14-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-815"><a href="#cb14-815" aria-hidden="true" tabindex="-1"></a>Damköhler number measures reaction rate relative to flow rate:</span>
<span id="cb14-816"><a href="#cb14-816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Da &lt;&lt; 1: Reaction slow, flow dominates, low conversion</span>
<span id="cb14-817"><a href="#cb14-817" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Da &gt;&gt; 1: Reaction fast, kinetics dominate, high conversion</span>
<span id="cb14-818"><a href="#cb14-818" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Da ≈ 1: Balanced, optimal efficiency</span>
<span id="cb14-819"><a href="#cb14-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-820"><a href="#cb14-820" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb14-821"><a href="#cb14-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-822"><a href="#cb14-822" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-823"><a href="#cb14-823" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR()</span>
<span id="cb14-824"><a href="#cb14-824" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Da_low <span class="op">=</span> cstr.compute_damkohler_number(T<span class="op">=</span><span class="fl">350.0</span>)</span>
<span id="cb14-825"><a href="#cb14-825" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> Da_high <span class="op">=</span> cstr.compute_damkohler_number(T<span class="op">=</span><span class="fl">400.0</span>)</span>
<span id="cb14-826"><a href="#cb14-826" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Da(350K) = </span><span class="sc">{</span>Da_low<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb14-827"><a href="#cb14-827" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Da(400K) = </span><span class="sc">{</span>Da_high<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb14-828"><a href="#cb14-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-829"><a href="#cb14-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-830"><a href="#cb14-830" aria-hidden="true" tabindex="-1"></a><span class="fu">### compute_residence_time { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time }</span></span>
<span id="cb14-831"><a href="#cb14-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-832"><a href="#cb14-832" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-833"><a href="#cb14-833" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.compute_residence_time()</span>
<span id="cb14-834"><a href="#cb14-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-835"><a href="#cb14-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-836"><a href="#cb14-836" aria-hidden="true" tabindex="-1"></a>Compute residence time τ = V/F.</span>
<span id="cb14-837"><a href="#cb14-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-838"><a href="#cb14-838" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb14-839"><a href="#cb14-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-840"><a href="#cb14-840" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description        <span class="pp">|</span></span>
<span id="cb14-841"><a href="#cb14-841" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|--------------------|</span></span>
<span id="cb14-842"><a href="#cb14-842" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> float  <span class="pp">|</span> Residence time <span class="co">[</span><span class="ot">s</span><span class="co">]</span> <span class="pp">|</span></span>
<span id="cb14-843"><a href="#cb14-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-844"><a href="#cb14-844" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb14-845"><a href="#cb14-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-846"><a href="#cb14-846" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-847"><a href="#cb14-847" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR(F<span class="op">=</span><span class="fl">100.0</span>, V<span class="op">=</span><span class="fl">100.0</span>)</span>
<span id="cb14-848"><a href="#cb14-848" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> tau <span class="op">=</span> cstr.compute_residence_time()</span>
<span id="cb14-849"><a href="#cb14-849" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Residence time: </span><span class="sc">{</span>tau<span class="sc">}</span><span class="ss"> s"</span>)</span>
<span id="cb14-850"><a href="#cb14-850" aria-hidden="true" tabindex="-1"></a>Residence time: <span class="fl">1.0</span> s</span>
<span id="cb14-851"><a href="#cb14-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-852"><a href="#cb14-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-853"><a href="#cb14-853" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb14-854"><a href="#cb14-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-855"><a href="#cb14-855" aria-hidden="true" tabindex="-1"></a>Residence time is the average time a molecule spends in the reactor.</span>
<span id="cb14-856"><a href="#cb14-856" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Longer τ (smaller F): More conversion, less stable</span>
<span id="cb14-857"><a href="#cb14-857" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Shorter τ (larger F): Less conversion, more stable</span>
<span id="cb14-858"><a href="#cb14-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-859"><a href="#cb14-859" aria-hidden="true" tabindex="-1"></a><span class="fu">### define_system { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.define_system }</span></span>
<span id="cb14-860"><a href="#cb14-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-861"><a href="#cb14-861" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-862"><a href="#cb14-862" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.define_system(</span>
<span id="cb14-863"><a href="#cb14-863" aria-hidden="true" tabindex="-1"></a>    F_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb14-864"><a href="#cb14-864" aria-hidden="true" tabindex="-1"></a>    V_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb14-865"><a href="#cb14-865" aria-hidden="true" tabindex="-1"></a>    C_A_feed_val<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb14-866"><a href="#cb14-866" aria-hidden="true" tabindex="-1"></a>    T_feed_val<span class="op">=</span><span class="fl">350.0</span>,</span>
<span id="cb14-867"><a href="#cb14-867" aria-hidden="true" tabindex="-1"></a>    k0_val<span class="op">=</span><span class="fl">72000000000.0</span>,</span>
<span id="cb14-868"><a href="#cb14-868" aria-hidden="true" tabindex="-1"></a>    E_val<span class="op">=</span><span class="fl">8750.0</span>,</span>
<span id="cb14-869"><a href="#cb14-869" aria-hidden="true" tabindex="-1"></a>    delta_H_val<span class="op">=-</span><span class="fl">50000.0</span>,</span>
<span id="cb14-870"><a href="#cb14-870" aria-hidden="true" tabindex="-1"></a>    rho_val<span class="op">=</span><span class="fl">1000.0</span>,</span>
<span id="cb14-871"><a href="#cb14-871" aria-hidden="true" tabindex="-1"></a>    Cp_val<span class="op">=</span><span class="fl">0.239</span>,</span>
<span id="cb14-872"><a href="#cb14-872" aria-hidden="true" tabindex="-1"></a>    UA_val<span class="op">=</span><span class="fl">50000.0</span>,</span>
<span id="cb14-873"><a href="#cb14-873" aria-hidden="true" tabindex="-1"></a>    x_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb14-874"><a href="#cb14-874" aria-hidden="true" tabindex="-1"></a>    u_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb14-875"><a href="#cb14-875" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-876"><a href="#cb14-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-877"><a href="#cb14-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-878"><a href="#cb14-878" aria-hidden="true" tabindex="-1"></a>Define continuous-time CSTR dynamics.</span>
<span id="cb14-879"><a href="#cb14-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-880"><a href="#cb14-880" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb14-881"><a href="#cb14-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-882"><a href="#cb14-882" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name         <span class="pp">|</span> Type                   <span class="pp">|</span> Description                                        <span class="pp">|</span> Default         <span class="pp">|</span></span>
<span id="cb14-883"><a href="#cb14-883" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|------------------------|----------------------------------------------------|-----------------|</span></span>
<span id="cb14-884"><a href="#cb14-884" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> F_val        <span class="pp">|</span> float                  <span class="pp">|</span> Volumetric flow rate <span class="co">[</span><span class="ot">L/s</span><span class="co">]</span>                         <span class="pp">|</span> <span class="in">`100.0`</span>         <span class="pp">|</span></span>
<span id="cb14-885"><a href="#cb14-885" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> V_val        <span class="pp">|</span> float                  <span class="pp">|</span> Reactor volume <span class="co">[</span><span class="ot">L</span><span class="co">]</span>                                 <span class="pp">|</span> <span class="in">`100.0`</span>         <span class="pp">|</span></span>
<span id="cb14-886"><a href="#cb14-886" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A_feed_val <span class="pp">|</span> float                  <span class="pp">|</span> Feed concentration <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span>                         <span class="pp">|</span> <span class="in">`1.0`</span>           <span class="pp">|</span></span>
<span id="cb14-887"><a href="#cb14-887" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_feed_val   <span class="pp">|</span> float                  <span class="pp">|</span> Feed temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                               <span class="pp">|</span> <span class="in">`350.0`</span>         <span class="pp">|</span></span>
<span id="cb14-888"><a href="#cb14-888" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k0_val       <span class="pp">|</span> float                  <span class="pp">|</span> Pre-exponential factor <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                       <span class="pp">|</span> <span class="in">`72000000000.0`</span> <span class="pp">|</span></span>
<span id="cb14-889"><a href="#cb14-889" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E_val        <span class="pp">|</span> float                  <span class="pp">|</span> Activation energy <span class="co">[</span><span class="ot">K</span><span class="co">]</span> (dimensionless Eₐ/R)         <span class="pp">|</span> <span class="in">`8750.0`</span>        <span class="pp">|</span></span>
<span id="cb14-890"><a href="#cb14-890" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> delta_H_val  <span class="pp">|</span> float                  <span class="pp">|</span> Heat of reaction <span class="co">[</span><span class="ot">J/mol</span><span class="co">]</span> (negative = exothermic)   <span class="pp">|</span> <span class="in">`-50000.0`</span>      <span class="pp">|</span></span>
<span id="cb14-891"><a href="#cb14-891" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> rho_val      <span class="pp">|</span> float                  <span class="pp">|</span> Density <span class="co">[</span><span class="ot">kg/L</span><span class="co">]</span>                                     <span class="pp">|</span> <span class="in">`1000.0`</span>        <span class="pp">|</span></span>
<span id="cb14-892"><a href="#cb14-892" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Cp_val       <span class="pp">|</span> float                  <span class="pp">|</span> Specific heat capacity <span class="co">[</span><span class="ot">J/(kg·K)</span><span class="co">]</span>                  <span class="pp">|</span> <span class="in">`0.239`</span>         <span class="pp">|</span></span>
<span id="cb14-893"><a href="#cb14-893" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> UA_val       <span class="pp">|</span> float                  <span class="pp">|</span> Overall heat transfer coefficient × area <span class="co">[</span><span class="ot">J/(s·K)</span><span class="co">]</span> <span class="pp">|</span> <span class="in">`50000.0`</span>       <span class="pp">|</span></span>
<span id="cb14-894"><a href="#cb14-894" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> x_ss         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Steady-state <span class="co">[</span><span class="ot">Cₐ, T</span><span class="co">]</span> for equilibrium setup         <span class="pp">|</span> <span class="in">`None`</span>          <span class="pp">|</span></span>
<span id="cb14-895"><a href="#cb14-895" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> u_ss         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Steady-state <span class="co">[</span><span class="ot">T_jacket</span><span class="co">]</span> for equilibrium setup      <span class="pp">|</span> <span class="in">`None`</span>          <span class="pp">|</span></span>
<span id="cb14-896"><a href="#cb14-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-897"><a href="#cb14-897" aria-hidden="true" tabindex="-1"></a><span class="fu">### find_steady_states { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states }</span></span>
<span id="cb14-898"><a href="#cb14-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-899"><a href="#cb14-899" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-900"><a href="#cb14-900" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.find_steady_states(</span>
<span id="cb14-901"><a href="#cb14-901" aria-hidden="true" tabindex="-1"></a>    T_jacket,</span>
<span id="cb14-902"><a href="#cb14-902" aria-hidden="true" tabindex="-1"></a>    T_range<span class="op">=</span>(<span class="fl">300.0</span>, <span class="fl">500.0</span>),</span>
<span id="cb14-903"><a href="#cb14-903" aria-hidden="true" tabindex="-1"></a>    n_points<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb14-904"><a href="#cb14-904" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-905"><a href="#cb14-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-906"><a href="#cb14-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-907"><a href="#cb14-907" aria-hidden="true" tabindex="-1"></a>Find all steady states for a given jacket temperature.</span>
<span id="cb14-908"><a href="#cb14-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-909"><a href="#cb14-909" aria-hidden="true" tabindex="-1"></a>Uses multiple initial guesses across temperature range to find</span>
<span id="cb14-910"><a href="#cb14-910" aria-hidden="true" tabindex="-1"></a>all solutions to the steady-state equations.</span>
<span id="cb14-911"><a href="#cb14-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-912"><a href="#cb14-912" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb14-913"><a href="#cb14-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-914"><a href="#cb14-914" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name     <span class="pp">|</span> Type   <span class="pp">|</span> Description                                    <span class="pp">|</span> Default          <span class="pp">|</span></span>
<span id="cb14-915"><a href="#cb14-915" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|--------|------------------------------------------------|------------------|</span></span>
<span id="cb14-916"><a href="#cb14-916" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_jacket <span class="pp">|</span> float  <span class="pp">|</span> Jacket temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                         <span class="pp">|</span> _required_       <span class="pp">|</span></span>
<span id="cb14-917"><a href="#cb14-917" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_range  <span class="pp">|</span> tuple  <span class="pp">|</span> Temperature range to search (T_min, T_max) <span class="co">[</span><span class="ot">K</span><span class="co">]</span> <span class="pp">|</span> <span class="in">`(300.0, 500.0)`</span> <span class="pp">|</span></span>
<span id="cb14-918"><a href="#cb14-918" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> n_points <span class="pp">|</span> int    <span class="pp">|</span> Number of initial guesses for root finding     <span class="pp">|</span> <span class="in">`100`</span>            <span class="pp">|</span></span>
<span id="cb14-919"><a href="#cb14-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-920"><a href="#cb14-920" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb14-921"><a href="#cb14-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-922"><a href="#cb14-922" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description                          <span class="pp">|</span></span>
<span id="cb14-923"><a href="#cb14-923" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|--------------------------------------|</span></span>
<span id="cb14-924"><a href="#cb14-924" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> list   <span class="pp">|</span> List of (C_A, T) steady state tuples <span class="pp">|</span></span>
<span id="cb14-925"><a href="#cb14-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-926"><a href="#cb14-926" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb14-927"><a href="#cb14-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-928"><a href="#cb14-928" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-929"><a href="#cb14-929" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousCSTR()</span>
<span id="cb14-930"><a href="#cb14-930" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> steady_states <span class="op">=</span> cstr.find_steady_states(T_jacket<span class="op">=</span><span class="fl">350.0</span>)</span>
<span id="cb14-931"><a href="#cb14-931" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(steady_states)<span class="sc">}</span><span class="ss"> steady states"</span>)</span>
<span id="cb14-932"><a href="#cb14-932" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> i, (C_A, T) <span class="kw">in</span> <span class="bu">enumerate</span>(steady_states):</span>
<span id="cb14-933"><a href="#cb14-933" aria-hidden="true" tabindex="-1"></a>...     X <span class="op">=</span> cstr.compute_conversion(C_A, <span class="fl">1.0</span>)</span>
<span id="cb14-934"><a href="#cb14-934" aria-hidden="true" tabindex="-1"></a>...     <span class="bu">print</span>(<span class="ss">f"  State </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: Cₐ=</span><span class="sc">{</span>C_A<span class="sc">:.3f}</span><span class="ss">, T=</span><span class="sc">{</span>T<span class="sc">:.1f}</span><span class="ss">, X=</span><span class="sc">{</span>X<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb14-935"><a href="#cb14-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-936"><a href="#cb14-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-937"><a href="#cb14-937" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb14-938"><a href="#cb14-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-939"><a href="#cb14-939" aria-hidden="true" tabindex="-1"></a>This method finds steady states by solving:</span>
<span id="cb14-940"><a href="#cb14-940" aria-hidden="true" tabindex="-1"></a>    dCₐ/dt = 0  (material balance)</span>
<span id="cb14-941"><a href="#cb14-941" aria-hidden="true" tabindex="-1"></a>    dT/dt = 0   (energy balance)</span>
<span id="cb14-942"><a href="#cb14-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-943"><a href="#cb14-943" aria-hidden="true" tabindex="-1"></a>For CSTR, there can be 1, 2, or 3 steady states depending on</span>
<span id="cb14-944"><a href="#cb14-944" aria-hidden="true" tabindex="-1"></a>parameters. This method attempts to find all of them by using</span>
<span id="cb14-945"><a href="#cb14-945" aria-hidden="true" tabindex="-1"></a>many different initial guesses across the temperature range.</span>
<span id="cb14-946"><a href="#cb14-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-947"><a href="#cb14-947" aria-hidden="true" tabindex="-1"></a>For production code, consider:</span>
<span id="cb14-948"><a href="#cb14-948" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>scipy.optimize.fsolve with multiple guesses</span>
<span id="cb14-949"><a href="#cb14-949" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuation methods (AUTO, MATCONT)</span>
<span id="cb14-950"><a href="#cb14-950" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Homotopy methods for guaranteed finding of all solutions</span>
<span id="cb14-951"><a href="#cb14-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-952"><a href="#cb14-952" aria-hidden="true" tabindex="-1"></a><span class="fu">### setup_equilibria { #cdesym.systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria }</span></span>
<span id="cb14-953"><a href="#cb14-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-954"><a href="#cb14-954" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb14-955"><a href="#cb14-955" aria-hidden="true" tabindex="-1"></a>systems.builtin.deterministic.continuous.ContinuousCSTR.setup_equilibria()</span>
<span id="cb14-956"><a href="#cb14-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-957"><a href="#cb14-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-958"><a href="#cb14-958" aria-hidden="true" tabindex="-1"></a>Set up steady-state equilibrium if provided.</span>
<span id="cb14-959"><a href="#cb14-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-960"><a href="#cb14-960" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb14-961"><a href="#cb14-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-962"><a href="#cb14-962" aria-hidden="true" tabindex="-1"></a>CSTR can have multiple steady states! Only add user-provided</span>
<span id="cb14-963"><a href="#cb14-963" aria-hidden="true" tabindex="-1"></a>equilibrium. Finding all equilibria requires solving nonlinear</span>
<span id="cb14-964"><a href="#cb14-964" aria-hidden="true" tabindex="-1"></a>algebraic equations (see find_steady_states() method).</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/systems.builtin.deterministic.continuous.ContinuousCSTR.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>