<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>systems.builtin.stochastic.continuous.continuousstochasticcstr – ControlDESymulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-64209fde6f94c7ab255c4d888f9dae80.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ControlDESymulation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/installation.qmd"> 
<span class="menu-text">Installation Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-architecture" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Architecture</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-architecture">    
        <li>
    <a class="dropdown-item" href="../architecture/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../architecture/cdesym_Design_Philosophy.html">
 <span class="dropdown-text">ControlDESymulation: Design Philosophy and Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/UI_Framework_Architecture.html">
 <span class="dropdown-text">UI Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Type_System_Architecture.html">
 <span class="dropdown-text">Type System Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Integration_Framework_Architecture.html">
 <span class="dropdown-text">Integration Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Control_Framework_Architecture.html">
 <span class="dropdown-text">Control Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Visualization_Framework_Architecture.html">
 <span class="dropdown-text">Visualization Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Delegation_Layer_Architecture.html">
 <span class="dropdown-text">Delegation Layer Architecture</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li class="dropdown-header">tutorials/basic_usage.qmd</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li class="dropdown-header">examples/pendulum_control.qmd</li>
        <li class="dropdown-header">examples/cartpole_swingup.qmd</li>
        <li class="dropdown-header">examples/quadrotor_lqr.qmd</li>
        <li class="dropdown-header">examples/cstr_multiplicity.qmd</li>
        <li class="dropdown-header">examples/lorenz_chaos.qmd</li>
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../api/index.html"> 
<span class="menu-text">API Reference</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gilbenezer/ControlDESymulation"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR" class="nav-link active" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR">systems.builtin.stochastic.continuous.ContinuousStochasticCSTR</a>
  <ul>
  <li><a href="#stochastic-differential-equations" id="toc-stochastic-differential-equations" class="nav-link" data-scroll-target="#stochastic-differential-equations">Stochastic Differential Equations</a></li>
  <li><a href="#physical-interpretation" id="toc-physical-interpretation" class="nav-link" data-scroll-target="#physical-interpretation">Physical Interpretation</a></li>
  <li><a href="#multiple-steady-states-with-noise" id="toc-multiple-steady-states-with-noise" class="nav-link" data-scroll-target="#multiple-steady-states-with-noise">Multiple Steady States with Noise</a></li>
  <li><a href="#fokker-planck-analysis" id="toc-fokker-planck-analysis" class="nav-link" data-scroll-target="#fokker-planck-analysis">Fokker-Planck Analysis</a></li>
  <li><a href="#stochastic-stability" id="toc-stochastic-stability" class="nav-link" data-scroll-target="#stochastic-stability">Stochastic Stability</a></li>
  <li><a href="#optimal-control-under-uncertainty" id="toc-optimal-control-under-uncertainty" class="nav-link" data-scroll-target="#optimal-control-under-uncertainty">Optimal Control Under Uncertainty</a></li>
  <li><a href="#state-space" id="toc-state-space" class="nav-link" data-scroll-target="#state-space">State Space</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#stochastic-properties" id="toc-stochastic-properties" class="nav-link" data-scroll-target="#stochastic-properties">Stochastic Properties</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications">Applications</a></li>
  <li><a href="#numerical-integration" id="toc-numerical-integration" class="nav-link" data-scroll-target="#numerical-integration">Numerical Integration</a></li>
  <li><a href="#monte-carlo-guidelines" id="toc-monte-carlo-guidelines" class="nav-link" data-scroll-target="#monte-carlo-guidelines">Monte Carlo Guidelines</a></li>
  <li><a href="#comparison-with-other-models" id="toc-comparison-with-other-models" class="nav-link" data-scroll-target="#comparison-with-other-models">Comparison with Other Models</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See Also</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time">compute_residence_time</a>
  <ul class="collapse">
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system">define_system</a>
  <ul class="collapse">
  <li><a href="#parameters-1" id="toc-parameters-1" class="nav-link" data-scroll-target="#parameters-1">Parameters</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate">estimate_escape_rate</a>
  <ul class="collapse">
  <li><a href="#parameters-2" id="toc-parameters-2" class="nav-link" data-scroll-target="#parameters-2">Parameters</a></li>
  <li><a href="#returns-1" id="toc-returns-1" class="nav-link" data-scroll-target="#returns-1">Returns</a></li>
  <li><a href="#notes-1" id="toc-notes-1" class="nav-link" data-scroll-target="#notes-1">Notes</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states">find_steady_states</a>
  <ul class="collapse">
  <li><a href="#parameters-3" id="toc-parameters-3" class="nav-link" data-scroll-target="#parameters-3">Parameters</a></li>
  <li><a href="#returns-2" id="toc-returns-2" class="nav-link" data-scroll-target="#returns-2">Returns</a></li>
  <li><a href="#notes-2" id="toc-notes-2" class="nav-link" data-scroll-target="#notes-2">Notes</a></li>
  <li><a href="#examples-1" id="toc-examples-1" class="nav-link" data-scroll-target="#examples-1">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities">get_noise_intensities</a>
  <ul class="collapse">
  <li><a href="#returns-3" id="toc-returns-3" class="nav-link" data-scroll-target="#returns-3">Returns</a></li>
  <li><a href="#notes-3" id="toc-notes-3" class="nav-link" data-scroll-target="#notes-3">Notes</a></li>
  <li><a href="#examples-2" id="toc-examples-2" class="nav-link" data-scroll-target="#examples-2">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria">setup_equilibria</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7"></h1></header><div class="quarto-title-block"><div class="quarto-title-tools-only"><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>




<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR" class="level1">
<h1>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Continuous-time stochastic CSTR with multiple equilibria and Brownian noise.</p>
<p>Provides the continuous-time SDE formulation of the CSTR, combining nonlinear dynamics (multiple steady states, bifurcations) with continuous Brownian noise. This is the theoretical foundation for stochastic analysis, optimal control, and rare event estimation.</p>
<section id="stochastic-differential-equations" class="level2 doc-section doc-section-stochastic-differential-equations">
<h2 class="doc-section doc-section-stochastic-differential-equations anchored" data-anchor-id="stochastic-differential-equations">Stochastic Differential Equations</h2>
<p>Itô SDE form:</p>
<pre><code>dC_A = [(F/V)·(C_A_feed - C_A) - r]·dt + σ_C·dW_C
dT = [(F/V)·(T_feed - T) + q_gen + q_removal]·dt + σ_T·dW_T</code></pre>
<p>where: - r = k₀·C_A·exp(-E/T): Reaction rate (Arrhenius) - q_gen = (-ΔH/ρC_p)·r: Heat generation - q_removal = (UA/VρC_p)·(T_jacket - T): Heat removal - σ_C: Concentration noise intensity [mol/(L·√s)] - σ_T: Temperature noise intensity [K/√s] - W_C(t), W_T(t): Independent Wiener processes</p>
</section>
<section id="physical-interpretation" class="level2 doc-section doc-section-physical-interpretation">
<h2 class="doc-section doc-section-physical-interpretation anchored" data-anchor-id="physical-interpretation">Physical Interpretation</h2>
<p><strong>Continuous-Time Disturbances:</strong></p>
<p>Unlike discrete models where noise occurs at sampling instants, continuous noise represents: - Turbulent fluctuations (continuous) - Ambient variations (continuous) - Molecular stochasticity (continuous at microscale) - Unmodeled fast dynamics (continuous effective noise)</p>
<p><strong>Noise Intensities:</strong></p>
<ol type="1">
<li><strong>σ_C [mol/(L·√s)]:</strong>
<ul>
<li>Feed composition fluctuations</li>
<li>Mixing imperfections (macro-mixing time scale)</li>
<li>Sampling variability</li>
<li>Typical: 0.0001-0.01 mol/(L·√s)</li>
</ul></li>
<li><strong>σ_T [K/√s]:</strong>
<ul>
<li>Heat transfer coefficient variations</li>
<li>Ambient temperature changes</li>
<li>Jacket flow rate fluctuations</li>
<li>Most critical (exponential coupling)</li>
<li>Typical: 0.1-5.0 K/√s</li>
</ul></li>
</ol>
<p><strong>Why Temperature Noise Dominates:</strong></p>
<p>Arrhenius exponential sensitivity: ∂r/∂T = r·(E/T²)</p>
<p>At T = 390 K with E = 8750 K: ∂r/∂T ≈ 0.058·r per K</p>
<p>Temperature noise amplified exponentially through reaction rate, creating strong coupling to concentration dynamics.</p>
</section>
<section id="multiple-steady-states-with-noise" class="level2 doc-section doc-section-multiple-steady-states-with-noise">
<h2 class="doc-section doc-section-multiple-steady-states-with-noise anchored" data-anchor-id="multiple-steady-states-with-noise">Multiple Steady States with Noise</h2>
<p><strong>Deterministic Equilibria:</strong> CSTR can have 1, 2, or 3 steady states (saddle-node bifurcation).</p>
<p><strong>Stochastic Equilibria:</strong> With noise, “equilibria” become probability distributions: - Stationary distribution p_∞(C_A, T) from Fokker-Planck - May be bimodal (two peaks at stable equilibria) - Transitions between basins via noise</p>
<p><strong>Noise-Induced Transitions:</strong></p>
<p>Even from stable equilibrium, noise can cause escape: - Fluctuations occasionally reach saddle point - Once over barrier, fall into other basin - Rare but catastrophic for operation</p>
<p><strong>Mean First Passage Time:</strong></p>
<p>Expected time to escape from basin: E[τ_escape] ≈ (2π/ω)·exp(ΔV/(σ_T²))</p>
<p>where: - ΔV: Potential barrier (related to saddle height) - ω: Frequency at bottom of well (linearization eigenvalue)</p>
<p><strong>Critical Noise Level:</strong></p>
<p>σ_crit where transitions become frequent (τ_escape ~ operation time).</p>
<p>For typical CSTR: σ_T_crit ~ 1-5 K/√s</p>
<p>Above this, operation at high-conversion becomes unreliable.</p>
</section>
<section id="fokker-planck-analysis" class="level2 doc-section doc-section-fokker-planck-analysis">
<h2 class="doc-section doc-section-fokker-planck-analysis anchored" data-anchor-id="fokker-planck-analysis">Fokker-Planck Analysis</h2>
<p><strong>Stationary Distribution:</strong></p>
<p>For Itô SDE: dX = f·dt + g·dW</p>
<p>Stationary density satisfies: 0 = -∇·(f·p_∞) + (1/2)·∇·∇·(D·p_∞)</p>
<p>where D = g·gᵀ is diffusion matrix.</p>
<p><strong>For CSTR:</strong> D = diag(σ_C², σ_T²)</p>
<p>In 2D, this is a PDE for p_∞(C_A, T).</p>
<p><strong>Quasi-Potential:</strong></p>
<p>For small noise: p_∞ ∝ exp(-2·Φ/σ²)</p>
<p>where Φ satisfies: f·∇Φ - (1/2)·tr(D·∇∇Φ) = 0</p>
<p><strong>Interpretation:</strong> - Φ is like “energy” or “potential” - Minima at stable equilibria - Maxima at unstable equilibria (saddle points) - System prefers low-Φ regions</p>
<p><strong>Computing Stationary Distribution:</strong></p>
<p>Methods: 1. <strong>Long-time simulation:</strong> Histogram after transient 2. <strong>Fokker-Planck solver:</strong> Finite difference/element on PDE 3. <strong>Path integral:</strong> Monte Carlo on action functional</p>
</section>
<section id="stochastic-stability" class="level2 doc-section doc-section-stochastic-stability">
<h2 class="doc-section doc-section-stochastic-stability anchored" data-anchor-id="stochastic-stability">Stochastic Stability</h2>
<p><strong>Different from Deterministic Stability:</strong></p>
<p>Deterministic: Eigenvalues of Jacobian at equilibrium - All Re(λ) &lt; 0 → stable - Any Re(λ) &gt; 0 → unstable</p>
<p>Stochastic: Lyapunov exponent of SDE - λ_L = lim_{t→∞} (1/t)·E[ln||δX(t)||] - λ_L &lt; 0 → stable (perturbations decay) - λ_L &gt; 0 → unstable (perturbations grow)</p>
<p><strong>Noise Can Stabilize or Destabilize:</strong> - Usually: Noise destabilizes (makes λ_L less negative) - Rarely: Noise stabilizes (noise-induced stability)</p>
<p><strong>For CSTR:</strong> - High-conversion state: Moderately stable deterministically - With noise: Stability margin reduced - Large σ_T can make effectively unstable (frequent escapes)</p>
</section>
<section id="optimal-control-under-uncertainty" class="level2 doc-section doc-section-optimal-control-under-uncertainty">
<h2 class="doc-section doc-section-optimal-control-under-uncertainty anchored" data-anchor-id="optimal-control-under-uncertainty">Optimal Control Under Uncertainty</h2>
<p><strong>Stochastic HJB Equation:</strong></p>
<p>For infinite-horizon problem: 0 = min_u [L(x,u) + (∂V/∂x)ᵀ·f + (1/2)·tr(gᵀ·∂²V/∂x²·g)]</p>
<p>Optimal control: u*(x) from minimization.</p>
<p><strong>For CSTR:</strong> - Maintain high-conversion despite noise - Tradeoff: Performance vs robustness - May require backing away from optimal deterministic point</p>
<p><strong>Risk-Sensitive Control:</strong></p>
<pre><code>J_θ = -ln E[exp(-θ·∫₀^∞ L dt)]</code></pre>
<p>Adjusts conservativeness: - Small θ: Nearly risk-neutral - Large θ: Very risk-averse (stay away from transitions)</p>
<p><strong>Exit Time Control:</strong></p>
<p>Minimize: E[∫₀^τ L dt]</p>
<p>where τ is first exit time from safe region.</p>
<p>Maximizes time until failure/transition.</p>
</section>
<section id="state-space" class="level2 doc-section doc-section-state-space">
<h2 class="doc-section doc-section-state-space anchored" data-anchor-id="state-space">State Space</h2>
<p>State: x = [C_A, T] ∈ ℝ₊ × ℝ₊ - Stochastic processes (not deterministic functions) - Multiple modes possible (bimodal distribution)</p>
<p>Control: u = T_jacket ∈ ℝ₊ - Deterministic control (no noise in actuation)</p>
<p>Noise: w = [w_C, w_T] - Independent Wiener processes - Continuous-time (Brownian motion)</p>
</section>
<section id="parameters" class="level2 doc-section doc-section-parameters">
<h2 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters">Parameters</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 83%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>F</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>V</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>C_A_feed</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>T_feed</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>k0</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>E</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>delta_H</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>rho</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>Cp</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>UA</td>
<td>float</td>
<td>Same as deterministic CSTR (see ContinuousCSTR)</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>sigma_C</td>
<td>float</td>
<td>Concentration noise intensity [mol/(L·√s)] - Continuous-time units: per √s - Typical: 0.0001-0.01 mol/(L·√s) - Conversion to discrete: σ_d = σ_c·√Δt</td>
<td><code>0.001</code></td>
</tr>
<tr class="even">
<td>sigma_T</td>
<td>float</td>
<td>Temperature noise intensity [K/√s] - Continuous-time units: per √s - Typical: 0.1-5.0 K/√s - Most critical parameter - Determines transition rates</td>
<td><code>1.0</code></td>
</tr>
</tbody>
</table>
</section>
<section id="stochastic-properties" class="level2 doc-section doc-section-stochastic-properties">
<h2 class="doc-section doc-section-stochastic-properties anchored" data-anchor-id="stochastic-properties">Stochastic Properties</h2>
<ul>
<li>Noise Type: ADDITIVE (state-independent)</li>
<li>SDE Type: Itô (standard interpretation)</li>
<li>Noise Dimension: nw = 2</li>
<li>Correlation: DIAGONAL (independent)</li>
<li>Stationary: Yes (Fokker-Planck stationary distribution)</li>
<li>Ergodic: Yes (time averages = ensemble averages)</li>
</ul>
</section>
<section id="applications" class="level2 doc-section doc-section-applications">
<h2 class="doc-section doc-section-applications anchored" data-anchor-id="applications">Applications</h2>
<p><strong>1. Theoretical Analysis:</strong> - Fokker-Planck equation (stationary distribution) - Large deviations (rare events) - Stochastic bifurcations - Exit time problems</p>
<p><strong>2. Continuous-Time Control:</strong> - Stochastic HJB equation - Risk-sensitive control - Optimal stopping - Barrier certificates</p>
<p><strong>3. Nonlinear Filtering:</strong> - Zakai equation (unnormalized density) - Duncan-Mortensen-Zakai equation - Path integral formulation</p>
<p><strong>4. Reliability Analysis:</strong> - Mean first passage time - Transition rate estimation - Safety verification</p>
<p><strong>5. Validation:</strong> - Ground truth for discrete models - Benchmark for approximate methods</p>
</section>
<section id="numerical-integration" class="level2 doc-section doc-section-numerical-integration">
<h2 class="doc-section doc-section-numerical-integration anchored" data-anchor-id="numerical-integration">Numerical Integration</h2>
<p><strong>Recommended Methods:</strong> - Euler-Maruyama: dt = 0.01-0.1 s - Milstein: Same as Euler for additive noise - Framework stiff solvers: For stiff CSTR</p>
<p><strong>Convergence Check:</strong> - Halve dt, verify moments unchanged - Weak convergence: E[X], Var[X] - Strong convergence: Sample paths</p>
</section>
<section id="monte-carlo-guidelines" class="level2 doc-section doc-section-monte-carlo-guidelines">
<h2 class="doc-section doc-section-monte-carlo-guidelines anchored" data-anchor-id="monte-carlo-guidelines">Monte Carlo Guidelines</h2>
<p><strong>Sample Size:</strong> - Mean/variance: N = 100-1,000 - Rare events (P ~ 0.01): N = 10,000-100,000 - Use importance sampling for efficiency</p>
<p><strong>Statistics:</strong> - Mean trajectory: μ(t) = (1/N)·Σ X_i(t) - Variance: σ²(t) = (1/N)·Σ (X_i(t) - μ(t))² - Percentiles: 5th, 50th, 95th</p>
</section>
<section id="comparison-with-other-models" class="level2 doc-section doc-section-comparison-with-other-models">
<h2 class="doc-section doc-section-comparison-with-other-models anchored" data-anchor-id="comparison-with-other-models">Comparison with Other Models</h2>
<p><strong>vs.&nbsp;Deterministic CSTR:</strong> - Adds process noise - Enables reliability analysis - Captures transitions</p>
<p><strong>vs.&nbsp;Discrete Stochastic CSTR:</strong> - Continuous time (theoretical) - Noise in [state]/√[time] - Fokker-Planck equation</p>
<p><strong>vs.&nbsp;Stochastic Batch Reactor:</strong> - CSTR: Multiple equilibria, continuous operation - Batch: Transient, finite time</p>
</section>
<section id="limitations" class="level2 doc-section doc-section-limitations">
<h2 class="doc-section doc-section-limitations anchored" data-anchor-id="limitations">Limitations</h2>
<ul>
<li>Additive noise (not multiplicative)</li>
<li>Constant noise (not state-dependent)</li>
<li>No jumps (only continuous paths)</li>
<li>Computational cost (Monte Carlo expensive)</li>
</ul>
</section>
<section id="see-also" class="level2 doc-section doc-section-see-also">
<h2 class="doc-section doc-section-see-also anchored" data-anchor-id="see-also">See Also</h2>
<p>DiscreteStochasticCSTR : Discrete-time version ContinuousCSTR : Deterministic version OrnsteinUhlenbeck : Simple mean-reverting SDE</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time">compute_residence_time</a></td>
<td>Compute residence time τ = V/F [s].</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system">define_system</a></td>
<td>Define continuous-time stochastic CSTR dynamics.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate">estimate_escape_rate</a></td>
<td>Estimate escape rate from basin using large deviations theory.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states">find_steady_states</a></td>
<td>Find all steady states of deterministic part.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities">get_noise_intensities</a></td>
<td>Get continuous-time noise intensities.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria">setup_equilibria</a></td>
<td>Set up equilibrium points (deterministic part).</td>
</tr>
</tbody>
</table>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time">compute_residence_time</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compute residence time τ = V/F [s].</p>
<section id="returns" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>float</td>
<td>Residence time</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system">define_system</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    F_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    V_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    C_A_feed_val<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    T_feed_val<span class="op">=</span><span class="fl">350.0</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    k0_val<span class="op">=</span><span class="fl">72000000000.0</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    E_val<span class="op">=</span><span class="fl">8750.0</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    delta_H_val<span class="op">=-</span><span class="fl">50000.0</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    rho_val<span class="op">=</span><span class="fl">1000.0</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    Cp_val<span class="op">=</span><span class="fl">0.239</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    UA_val<span class="op">=</span><span class="fl">50000.0</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    sigma_C<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    sigma_T<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    x_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    u_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Define continuous-time stochastic CSTR dynamics.</p>
<section id="parameters-1" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 76%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>F_val</td>
<td>float</td>
<td>Volumetric flow rate [L/s]</td>
<td><code>100.0</code></td>
</tr>
<tr class="even">
<td>V_val</td>
<td>float</td>
<td>Reactor volume [L]</td>
<td><code>100.0</code></td>
</tr>
<tr class="odd">
<td>C_A_feed_val</td>
<td>float</td>
<td>Feed concentration [mol/L]</td>
<td><code>1.0</code></td>
</tr>
<tr class="even">
<td>T_feed_val</td>
<td>float</td>
<td>Feed temperature [K]</td>
<td><code>350.0</code></td>
</tr>
<tr class="odd">
<td>k0_val</td>
<td>float</td>
<td>Pre-exponential factor [1/s]</td>
<td><code>72000000000.0</code></td>
</tr>
<tr class="even">
<td>E_val</td>
<td>float</td>
<td>Activation energy [K] (dimensionless Eₐ/R)</td>
<td><code>8750.0</code></td>
</tr>
<tr class="odd">
<td>delta_H_val</td>
<td>float</td>
<td>Heat of reaction [J/mol] (negative = exothermic)</td>
<td><code>-50000.0</code></td>
</tr>
<tr class="even">
<td>rho_val</td>
<td>float</td>
<td>Density [kg/L]</td>
<td><code>1000.0</code></td>
</tr>
<tr class="odd">
<td>Cp_val</td>
<td>float</td>
<td>Specific heat capacity [J/(kg·K)]</td>
<td><code>0.239</code></td>
</tr>
<tr class="even">
<td>UA_val</td>
<td>float</td>
<td>Overall heat transfer coefficient × area [J/(s·K)]</td>
<td><code>50000.0</code></td>
</tr>
<tr class="odd">
<td>x_ss</td>
<td>Optional[np.ndarray]</td>
<td>Steady-state [Cₐ, T] for equilibrium setup</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>u_ss</td>
<td>Optional[np.ndarray]</td>
<td>Steady-state [T_jacket] for equilibrium setup</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>sigma_C</td>
<td>float</td>
<td>Concentration noise intensity [mol/(L·√s)] - Continuous-time units: per √s - Typical: 0.0001-0.01 mol/(L·√s) - Smaller than batch reactor (continuous operation)</td>
<td><code>0.001</code></td>
</tr>
<tr class="even">
<td>sigma_T</td>
<td>float</td>
<td>Temperature noise intensity [K/√s] - Continuous-time units: per √s - Typical: 0.1-5.0 K/√s - Determines transition rates (exponentially) - Critical parameter for reliability</td>
<td><code>1.0</code></td>
</tr>
<tr class="odd">
<td>x_ss</td>
<td>Optional[np.ndarray]</td>
<td>Known steady state (if available)</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>u_ss</td>
<td>Optional[np.ndarray]</td>
<td>Known steady state (if available)</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="notes" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes">Notes</h4>
<p><strong>Noise Intensity Selection:</strong></p>
<p>Physical reasoning: - σ_C ~ 0.001: Precise control, large reactor - σ_C ~ 0.01: Typical industrial - σ_T ~ 0.5: Good temperature control - σ_T ~ 2.0: Poor control, high variability</p>
<p><strong>Temperature Noise Impact:</strong></p>
<p>At high-conversion (T ≈ 390 K): - σ_T = 0.5 K/√s: Very stable, rare transitions - σ_T = 1.0 K/√s: Occasional transitions (hours) - σ_T = 2.0 K/√s: Frequent transitions (minutes) - σ_T = 5.0 K/√s: Very unstable, constant switching</p>
<p><strong>Design Criterion:</strong></p>
<p>Choose σ_T such that mean first passage time: τ_escape &gt; 100·τ_operation</p>
<p>Ensures reliable operation (99% success).</p>
<p><strong>Conversion to Discrete:</strong></p>
<p>For discrete model with sampling Δt: σ_discrete = σ_continuous·√Δt</p>
<p>Example: σ_T = 1.0 K/√s, Δt = 5 s → σ_T_discrete = 1.0·√5 ≈ 2.24 K per step</p>
<p><strong>Additive vs Multiplicative:</strong></p>
<p>This uses additive (state-independent) noise.</p>
<p>Alternative: Multiplicative noise g(X) = diag(σ_C·C_A, σ_T·T)</p>
<p>Would represent: - Relative errors (percentage fluctuations) - State-dependent uncertainty - More complex analysis</p>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate">estimate_escape_rate</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    x_basin,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    barrier_height,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Estimate escape rate from basin using large deviations theory.</p>
<p>Approximate formula: Rate ≈ (ω/2π)·exp(-ΔV/σ_T²)</p>
<section id="parameters-2" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 14%">
<col style="width: 52%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x_basin</td>
<td>np.ndarray</td>
<td>State in basin (stable equilibrium)</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>barrier_height</td>
<td>float</td>
<td>Potential barrier height (energy to saddle)</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-1" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>float</td>
<td>Escape rate [1/s]</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-1" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-1">Notes</h4>
<p>This is an approximation valid for small noise. For accurate rates, use Monte Carlo simulation.</p>
</section>
<section id="examples" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousStochasticCSTR(sigma_T<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Approximate barrier height: 50 K² equivalent</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rate <span class="op">=</span> cstr.estimate_escape_rate(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>...     x_basin<span class="op">=</span>np.array([<span class="fl">0.1</span>, <span class="fl">390.0</span>]),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>...     barrier_height<span class="op">=</span><span class="fl">50.0</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> mean_time <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> rate</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Mean escape time: </span><span class="sc">{</span>mean_time<span class="sc">:.1f}</span><span class="ss"> s"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states">find_steady_states</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    T_jacket,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    T_range<span class="op">=</span>(<span class="fl">300.0</span>, <span class="fl">500.0</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    n_points<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Find all steady states of deterministic part.</p>
<p>These are centers of Fokker-Planck stationary distribution.</p>
<section id="parameters-3" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T_jacket</td>
<td>float</td>
<td>Jacket temperature [K]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>T_range</td>
<td>tuple</td>
<td>Search range</td>
<td><code>(300.0, 500.0)</code></td>
</tr>
<tr class="odd">
<td>n_points</td>
<td>int</td>
<td>Initial guesses</td>
<td><code>100</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-2" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-2">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 44%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>List[Tuple[float, float]]</td>
<td>[(C_A, T), …] steady states</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-2" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-2">Notes</h4>
<p>With noise, stationary distribution has peaks at these points (if stable) or valleys (if unstable).</p>
</section>
<section id="examples-1" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-1">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousStochasticCSTR()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> states <span class="op">=</span> cstr.find_steady_states(T_jacket<span class="op">=</span><span class="fl">350.0</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(states)<span class="sc">}</span><span class="ss"> steady states"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities">get_noise_intensities</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Get continuous-time noise intensities.</p>
<section id="returns-3" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-3">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>dict</td>
<td>{‘sigma_C’: …, ‘sigma_T’: …}</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-3" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-3">Notes</h4>
<p>Units: [state]/√[time] To convert to discrete: σ_d = σ_c·√Δt</p>
</section>
<section id="examples-2" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-2">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousStochasticCSTR(sigma_C<span class="op">=</span><span class="fl">0.001</span>, sigma_T<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> noise <span class="op">=</span> cstr.get_noise_intensities()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Temperature noise: </span><span class="sc">{</span>noise[<span class="st">'sigma_T'</span>]<span class="sc">}</span><span class="ss"> K/√s"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria">setup_equilibria</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Set up equilibrium points (deterministic part).</p>
<p>Note: These are centers of stationary distributions. Multiple equilibria may exist. Use find_steady_states().</p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/gilbenezer\.github\.io\/ControlDESymulation");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># systems.builtin.stochastic.continuous.ContinuousStochasticCSTR { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR }</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>Continuous-time stochastic CSTR with multiple equilibria and Brownian noise.</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Provides the continuous-time SDE formulation of the CSTR, combining</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>nonlinear dynamics (multiple steady states, bifurcations) with continuous</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>Brownian noise. This is the theoretical foundation for stochastic analysis,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>optimal control, and rare event estimation.</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stochastic Differential Equations {.doc-section .doc-section-stochastic-differential-equations}</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>Itô SDE form:</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="in">    dC_A = [(F/V)·(C_A_feed - C_A) - r]·dt + σ_C·dW_C</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="in">    dT = [(F/V)·(T_feed - T) + q_gen + q_removal]·dt + σ_T·dW_T</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>r = k₀·C_A·exp(-E/T): Reaction rate (Arrhenius)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>q_gen = (-ΔH/ρC_p)·r: Heat generation</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>q_removal = (UA/VρC_p)·(T_jacket - T): Heat removal</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>σ_C: Concentration noise intensity <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>σ_T: Temperature noise intensity <span class="co">[</span><span class="ot">K/√s</span><span class="co">]</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>W_C(t), W_T(t): Independent Wiener processes</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Physical Interpretation {.doc-section .doc-section-physical-interpretation}</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>**Continuous-Time Disturbances:**</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>Unlike discrete models where noise occurs at sampling instants,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>continuous noise represents:</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Turbulent fluctuations (continuous)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ambient variations (continuous)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Molecular stochasticity (continuous at microscale)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unmodeled fast dynamics (continuous effective noise)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>**Noise Intensities:**</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**σ_C [mol/(L·√s)]:**</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Feed composition fluctuations</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mixing imperfections (macro-mixing time scale)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sampling variability</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Typical: 0.0001-0.01 mol/(L·√s)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**σ_T [K/√s]:**</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Heat transfer coefficient variations</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ambient temperature changes</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Jacket flow rate fluctuations</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Most critical (exponential coupling)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Typical: 0.1-5.0 K/√s</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>**Why Temperature Noise Dominates:**</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>Arrhenius exponential sensitivity:</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    ∂r/∂T = r·(E/T²)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>At T = 390 K with E = 8750 K:</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    ∂r/∂T ≈ 0.058·r per K</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>Temperature noise amplified exponentially through reaction rate,</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>creating strong coupling to concentration dynamics.</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Steady States with Noise {.doc-section .doc-section-multiple-steady-states-with-noise}</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>**Deterministic Equilibria:**</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>CSTR can have 1, 2, or 3 steady states (saddle-node bifurcation).</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>**Stochastic Equilibria:**</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>With noise, "equilibria" become probability distributions:</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stationary distribution p_∞(C_A, T) from Fokker-Planck</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>May be bimodal (two peaks at stable equilibria)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Transitions between basins via noise</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>**Noise-Induced Transitions:**</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>Even from stable equilibrium, noise can cause escape:</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fluctuations occasionally reach saddle point</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Once over barrier, fall into other basin</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rare but catastrophic for operation</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>**Mean First Passage Time:**</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>Expected time to escape from basin:</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    E<span class="co">[</span><span class="ot">τ_escape</span><span class="co">]</span> ≈ (2π/ω)·exp(ΔV/(σ_T²))</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ΔV: Potential barrier (related to saddle height)</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ω: Frequency at bottom of well (linearization eigenvalue)</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>**Critical Noise Level:**</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>σ_crit where transitions become frequent (τ_escape ~ operation time).</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>For typical CSTR:</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>    σ_T_crit ~ 1-5 K/√s</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>Above this, operation at high-conversion becomes unreliable.</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fokker-Planck Analysis {.doc-section .doc-section-fokker-planck-analysis}</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>**Stationary Distribution:**</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>For Itô SDE: dX = f·dt + g·dW</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>Stationary density satisfies:</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>    0 = -∇·(f·p_∞) + (1/2)·∇·∇·(D·p_∞)</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>where D = g·gᵀ is diffusion matrix.</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>**For CSTR:**</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>    D = diag(σ_C², σ_T²)</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>In 2D, this is a PDE for p_∞(C_A, T).</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>**Quasi-Potential:**</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>For small noise:</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>    p_∞ ∝ exp(-2·Φ/σ²)</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>where Φ satisfies:</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>    f·∇Φ - (1/2)·tr(D·∇∇Φ) = 0</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>**Interpretation:**</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Φ is like "energy" or "potential"</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Minima at stable equilibria</span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maxima at unstable equilibria (saddle points)</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>System prefers low-Φ regions</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>**Computing Stationary Distribution:**</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>Methods:</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Long-time simulation:** Histogram after transient</span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Fokker-Planck solver:** Finite difference/element on PDE</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Path integral:** Monte Carlo on action functional</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stochastic Stability {.doc-section .doc-section-stochastic-stability}</span></span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>**Different from Deterministic Stability:**</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>Deterministic: Eigenvalues of Jacobian at equilibrium</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All Re(λ) &lt; 0 → stable</span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Any Re(λ) &gt; 0 → unstable</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>Stochastic: Lyapunov exponent of SDE</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>λ_L = lim_{t→∞} (1/t)·E<span class="co">[</span><span class="ot">ln||δX(t)||</span><span class="co">]</span></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>λ_L &lt; 0 → stable (perturbations decay)</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>λ_L &gt; 0 → unstable (perturbations grow)</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>**Noise Can Stabilize or Destabilize:**</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Usually: Noise destabilizes (makes λ_L less negative)</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rarely: Noise stabilizes (noise-induced stability)</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>**For CSTR:**</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High-conversion state: Moderately stable deterministically</span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With noise: Stability margin reduced</span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Large σ_T can make effectively unstable (frequent escapes)</span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimal Control Under Uncertainty {.doc-section .doc-section-optimal-control-under-uncertainty}</span></span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>**Stochastic HJB Equation:**</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a>For infinite-horizon problem:</span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>    0 = min_u <span class="co">[</span><span class="ot">L(x,u) + (∂V/∂x)ᵀ·f + (1/2)·tr(gᵀ·∂²V/∂x²·g)</span><span class="co">]</span></span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>Optimal control: u*(x) from minimization.</span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>**For CSTR:**</span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maintain high-conversion despite noise</span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tradeoff: Performance vs robustness</span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>May require backing away from optimal deterministic point</span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a>**Risk-Sensitive Control:**</span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a><span class="in">    J_θ = -ln E[exp(-θ·∫₀^∞ L dt)]</span></span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a>Adjusts conservativeness:</span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small θ: Nearly risk-neutral</span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Large θ: Very risk-averse (stay away from transitions)</span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>**Exit Time Control:**</span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a>Minimize: E<span class="co">[</span><span class="ot">∫₀^τ L dt</span><span class="co">]</span></span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a>where τ is first exit time from safe region.</span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a>Maximizes time until failure/transition.</span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## State Space {.doc-section .doc-section-state-space}</span></span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a>State: x = <span class="co">[</span><span class="ot">C_A, T</span><span class="co">]</span> ∈ ℝ₊ × ℝ₊</span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Stochastic processes (not deterministic functions)</span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Multiple modes possible (bimodal distribution)</span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a>Control: u = T_jacket ∈ ℝ₊</span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Deterministic control (no noise in actuation)</span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a>Noise: w = <span class="co">[</span><span class="ot">w_C, w_T</span><span class="co">]</span></span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Independent Wiener processes</span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Continuous-time (Brownian motion)</span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name     <span class="pp">|</span> Type   <span class="pp">|</span> Description                                                                                                                                          <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------|------------|</span></span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> F        <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> V        <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A_feed <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_feed   <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k0       <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E        <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> delta_H  <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> rho      <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Cp       <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> UA       <span class="pp">|</span> float  <span class="pp">|</span> Same as deterministic CSTR (see ContinuousCSTR)                                                                                                      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_C  <span class="pp">|</span> float  <span class="pp">|</span> Concentration noise intensity <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span> - Continuous-time units: per √s - Typical: 0.0001-0.01 mol/(L·√s) - Conversion to discrete: σ_d = σ_c·√Δt <span class="pp">|</span> <span class="in">`0.001`</span>    <span class="pp">|</span></span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_T  <span class="pp">|</span> float  <span class="pp">|</span> Temperature noise intensity <span class="co">[</span><span class="ot">K/√s</span><span class="co">]</span> - Continuous-time units: per √s - Typical: 0.1-5.0 K/√s - Most critical parameter - Determines transition rates   <span class="pp">|</span> <span class="in">`1.0`</span>      <span class="pp">|</span></span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stochastic Properties {.doc-section .doc-section-stochastic-properties}</span></span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-225"><a href="#cb13-225" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Noise Type: ADDITIVE (state-independent)</span>
<span id="cb13-226"><a href="#cb13-226" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SDE Type: Itô (standard interpretation)</span>
<span id="cb13-227"><a href="#cb13-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Noise Dimension: nw = 2</span>
<span id="cb13-228"><a href="#cb13-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Correlation: DIAGONAL (independent)</span>
<span id="cb13-229"><a href="#cb13-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stationary: Yes (Fokker-Planck stationary distribution)</span>
<span id="cb13-230"><a href="#cb13-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ergodic: Yes (time averages = ensemble averages)</span>
<span id="cb13-231"><a href="#cb13-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-232"><a href="#cb13-232" aria-hidden="true" tabindex="-1"></a><span class="fu">## Applications {.doc-section .doc-section-applications}</span></span>
<span id="cb13-233"><a href="#cb13-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-234"><a href="#cb13-234" aria-hidden="true" tabindex="-1"></a>**1. Theoretical Analysis:**</span>
<span id="cb13-235"><a href="#cb13-235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fokker-Planck equation (stationary distribution)</span>
<span id="cb13-236"><a href="#cb13-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Large deviations (rare events)</span>
<span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stochastic bifurcations</span>
<span id="cb13-238"><a href="#cb13-238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exit time problems</span>
<span id="cb13-239"><a href="#cb13-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-240"><a href="#cb13-240" aria-hidden="true" tabindex="-1"></a>**2. Continuous-Time Control:**</span>
<span id="cb13-241"><a href="#cb13-241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stochastic HJB equation</span>
<span id="cb13-242"><a href="#cb13-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Risk-sensitive control</span>
<span id="cb13-243"><a href="#cb13-243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Optimal stopping</span>
<span id="cb13-244"><a href="#cb13-244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Barrier certificates</span>
<span id="cb13-245"><a href="#cb13-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-246"><a href="#cb13-246" aria-hidden="true" tabindex="-1"></a>**3. Nonlinear Filtering:**</span>
<span id="cb13-247"><a href="#cb13-247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Zakai equation (unnormalized density)</span>
<span id="cb13-248"><a href="#cb13-248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Duncan-Mortensen-Zakai equation</span>
<span id="cb13-249"><a href="#cb13-249" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Path integral formulation</span>
<span id="cb13-250"><a href="#cb13-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-251"><a href="#cb13-251" aria-hidden="true" tabindex="-1"></a>**4. Reliability Analysis:**</span>
<span id="cb13-252"><a href="#cb13-252" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean first passage time</span>
<span id="cb13-253"><a href="#cb13-253" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Transition rate estimation</span>
<span id="cb13-254"><a href="#cb13-254" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Safety verification</span>
<span id="cb13-255"><a href="#cb13-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-256"><a href="#cb13-256" aria-hidden="true" tabindex="-1"></a>**5. Validation:**</span>
<span id="cb13-257"><a href="#cb13-257" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ground truth for discrete models</span>
<span id="cb13-258"><a href="#cb13-258" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Benchmark for approximate methods</span>
<span id="cb13-259"><a href="#cb13-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-260"><a href="#cb13-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Numerical Integration {.doc-section .doc-section-numerical-integration}</span></span>
<span id="cb13-261"><a href="#cb13-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-262"><a href="#cb13-262" aria-hidden="true" tabindex="-1"></a>**Recommended Methods:**</span>
<span id="cb13-263"><a href="#cb13-263" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Euler-Maruyama: dt = 0.01-0.1 s</span>
<span id="cb13-264"><a href="#cb13-264" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Milstein: Same as Euler for additive noise</span>
<span id="cb13-265"><a href="#cb13-265" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Framework stiff solvers: For stiff CSTR</span>
<span id="cb13-266"><a href="#cb13-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-267"><a href="#cb13-267" aria-hidden="true" tabindex="-1"></a>**Convergence Check:**</span>
<span id="cb13-268"><a href="#cb13-268" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Halve dt, verify moments unchanged</span>
<span id="cb13-269"><a href="#cb13-269" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weak convergence: E<span class="co">[</span><span class="ot">X</span><span class="co">]</span>, Var<span class="co">[</span><span class="ot">X</span><span class="co">]</span></span>
<span id="cb13-270"><a href="#cb13-270" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Strong convergence: Sample paths</span>
<span id="cb13-271"><a href="#cb13-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-272"><a href="#cb13-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Monte Carlo Guidelines {.doc-section .doc-section-monte-carlo-guidelines}</span></span>
<span id="cb13-273"><a href="#cb13-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-274"><a href="#cb13-274" aria-hidden="true" tabindex="-1"></a>**Sample Size:**</span>
<span id="cb13-275"><a href="#cb13-275" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean/variance: N = 100-1,000</span>
<span id="cb13-276"><a href="#cb13-276" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rare events (P ~ 0.01): N = 10,000-100,000</span>
<span id="cb13-277"><a href="#cb13-277" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use importance sampling for efficiency</span>
<span id="cb13-278"><a href="#cb13-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-279"><a href="#cb13-279" aria-hidden="true" tabindex="-1"></a>**Statistics:**</span>
<span id="cb13-280"><a href="#cb13-280" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean trajectory: μ(t) = (1/N)·Σ X_i(t)</span>
<span id="cb13-281"><a href="#cb13-281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variance: σ²(t) = (1/N)·Σ (X_i(t) - μ(t))²</span>
<span id="cb13-282"><a href="#cb13-282" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Percentiles: 5th, 50th, 95th</span>
<span id="cb13-283"><a href="#cb13-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-284"><a href="#cb13-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison with Other Models {.doc-section .doc-section-comparison-with-other-models}</span></span>
<span id="cb13-285"><a href="#cb13-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-286"><a href="#cb13-286" aria-hidden="true" tabindex="-1"></a>**vs. Deterministic CSTR:**</span>
<span id="cb13-287"><a href="#cb13-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adds process noise</span>
<span id="cb13-288"><a href="#cb13-288" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enables reliability analysis</span>
<span id="cb13-289"><a href="#cb13-289" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Captures transitions</span>
<span id="cb13-290"><a href="#cb13-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-291"><a href="#cb13-291" aria-hidden="true" tabindex="-1"></a>**vs. Discrete Stochastic CSTR:**</span>
<span id="cb13-292"><a href="#cb13-292" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Continuous time (theoretical)</span>
<span id="cb13-293"><a href="#cb13-293" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Noise in <span class="co">[</span><span class="ot">state</span><span class="co">]</span>/√<span class="co">[</span><span class="ot">time</span><span class="co">]</span></span>
<span id="cb13-294"><a href="#cb13-294" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fokker-Planck equation</span>
<span id="cb13-295"><a href="#cb13-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-296"><a href="#cb13-296" aria-hidden="true" tabindex="-1"></a>**vs. Stochastic Batch Reactor:**</span>
<span id="cb13-297"><a href="#cb13-297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CSTR: Multiple equilibria, continuous operation</span>
<span id="cb13-298"><a href="#cb13-298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Batch: Transient, finite time</span>
<span id="cb13-299"><a href="#cb13-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a><span class="fu">## Limitations {.doc-section .doc-section-limitations}</span></span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Additive noise (not multiplicative)</span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Constant noise (not state-dependent)</span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No jumps (only continuous paths)</span>
<span id="cb13-305"><a href="#cb13-305" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Computational cost (Monte Carlo expensive)</span>
<span id="cb13-306"><a href="#cb13-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-307"><a href="#cb13-307" aria-hidden="true" tabindex="-1"></a><span class="fu">## See Also {.doc-section .doc-section-see-also}</span></span>
<span id="cb13-308"><a href="#cb13-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-309"><a href="#cb13-309" aria-hidden="true" tabindex="-1"></a>DiscreteStochasticCSTR : Discrete-time version</span>
<span id="cb13-310"><a href="#cb13-310" aria-hidden="true" tabindex="-1"></a>ContinuousCSTR : Deterministic version</span>
<span id="cb13-311"><a href="#cb13-311" aria-hidden="true" tabindex="-1"></a>OrnsteinUhlenbeck : Simple mean-reverting SDE</span>
<span id="cb13-312"><a href="#cb13-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-313"><a href="#cb13-313" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb13-314"><a href="#cb13-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-315"><a href="#cb13-315" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name <span class="pp">|</span> Description <span class="pp">|</span></span>
<span id="cb13-316"><a href="#cb13-316" aria-hidden="true" tabindex="-1"></a><span class="pp">| ---</span> <span class="pp">| ---</span> <span class="pp">|</span></span>
<span id="cb13-317"><a href="#cb13-317" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">compute_residence_time</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time)</span> <span class="pp">|</span> Compute residence time τ = V/F <span class="co">[</span><span class="ot">s</span><span class="co">]</span>. <span class="pp">|</span></span>
<span id="cb13-318"><a href="#cb13-318" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">define_system</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system)</span> <span class="pp">|</span> Define continuous-time stochastic CSTR dynamics. <span class="pp">|</span></span>
<span id="cb13-319"><a href="#cb13-319" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">estimate_escape_rate</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate)</span> <span class="pp">|</span> Estimate escape rate from basin using large deviations theory. <span class="pp">|</span></span>
<span id="cb13-320"><a href="#cb13-320" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">find_steady_states</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states)</span> <span class="pp">|</span> Find all steady states of deterministic part. <span class="pp">|</span></span>
<span id="cb13-321"><a href="#cb13-321" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">get_noise_intensities</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities)</span> <span class="pp">|</span> Get continuous-time noise intensities. <span class="pp">|</span></span>
<span id="cb13-322"><a href="#cb13-322" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">setup_equilibria</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria)</span> <span class="pp">|</span> Set up equilibrium points (deterministic part). <span class="pp">|</span></span>
<span id="cb13-323"><a href="#cb13-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-324"><a href="#cb13-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### compute_residence_time { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time }</span></span>
<span id="cb13-325"><a href="#cb13-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-326"><a href="#cb13-326" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-327"><a href="#cb13-327" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.compute_residence_time(</span>
<span id="cb13-328"><a href="#cb13-328" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-329"><a href="#cb13-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-330"><a href="#cb13-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-331"><a href="#cb13-331" aria-hidden="true" tabindex="-1"></a>Compute residence time τ = V/F <span class="co">[</span><span class="ot">s</span><span class="co">]</span>.</span>
<span id="cb13-332"><a href="#cb13-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-333"><a href="#cb13-333" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb13-334"><a href="#cb13-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-335"><a href="#cb13-335" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description    <span class="pp">|</span></span>
<span id="cb13-336"><a href="#cb13-336" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|----------------|</span></span>
<span id="cb13-337"><a href="#cb13-337" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> float  <span class="pp">|</span> Residence time <span class="pp">|</span></span>
<span id="cb13-338"><a href="#cb13-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-339"><a href="#cb13-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### define_system { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system }</span></span>
<span id="cb13-340"><a href="#cb13-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-341"><a href="#cb13-341" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-342"><a href="#cb13-342" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.define_system(</span>
<span id="cb13-343"><a href="#cb13-343" aria-hidden="true" tabindex="-1"></a>    F_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb13-344"><a href="#cb13-344" aria-hidden="true" tabindex="-1"></a>    V_val<span class="op">=</span><span class="fl">100.0</span>,</span>
<span id="cb13-345"><a href="#cb13-345" aria-hidden="true" tabindex="-1"></a>    C_A_feed_val<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb13-346"><a href="#cb13-346" aria-hidden="true" tabindex="-1"></a>    T_feed_val<span class="op">=</span><span class="fl">350.0</span>,</span>
<span id="cb13-347"><a href="#cb13-347" aria-hidden="true" tabindex="-1"></a>    k0_val<span class="op">=</span><span class="fl">72000000000.0</span>,</span>
<span id="cb13-348"><a href="#cb13-348" aria-hidden="true" tabindex="-1"></a>    E_val<span class="op">=</span><span class="fl">8750.0</span>,</span>
<span id="cb13-349"><a href="#cb13-349" aria-hidden="true" tabindex="-1"></a>    delta_H_val<span class="op">=-</span><span class="fl">50000.0</span>,</span>
<span id="cb13-350"><a href="#cb13-350" aria-hidden="true" tabindex="-1"></a>    rho_val<span class="op">=</span><span class="fl">1000.0</span>,</span>
<span id="cb13-351"><a href="#cb13-351" aria-hidden="true" tabindex="-1"></a>    Cp_val<span class="op">=</span><span class="fl">0.239</span>,</span>
<span id="cb13-352"><a href="#cb13-352" aria-hidden="true" tabindex="-1"></a>    UA_val<span class="op">=</span><span class="fl">50000.0</span>,</span>
<span id="cb13-353"><a href="#cb13-353" aria-hidden="true" tabindex="-1"></a>    sigma_C<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb13-354"><a href="#cb13-354" aria-hidden="true" tabindex="-1"></a>    sigma_T<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb13-355"><a href="#cb13-355" aria-hidden="true" tabindex="-1"></a>    x_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb13-356"><a href="#cb13-356" aria-hidden="true" tabindex="-1"></a>    u_ss<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb13-357"><a href="#cb13-357" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-358"><a href="#cb13-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-359"><a href="#cb13-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-360"><a href="#cb13-360" aria-hidden="true" tabindex="-1"></a>Define continuous-time stochastic CSTR dynamics.</span>
<span id="cb13-361"><a href="#cb13-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-362"><a href="#cb13-362" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb13-363"><a href="#cb13-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-364"><a href="#cb13-364" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name         <span class="pp">|</span> Type                   <span class="pp">|</span> Description                                                                                                                                                                   <span class="pp">|</span> Default         <span class="pp">|</span></span>
<span id="cb13-365"><a href="#cb13-365" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------|</span></span>
<span id="cb13-366"><a href="#cb13-366" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> F_val        <span class="pp">|</span> float                  <span class="pp">|</span> Volumetric flow rate <span class="co">[</span><span class="ot">L/s</span><span class="co">]</span>                                                                                                                                                    <span class="pp">|</span> <span class="in">`100.0`</span>         <span class="pp">|</span></span>
<span id="cb13-367"><a href="#cb13-367" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> V_val        <span class="pp">|</span> float                  <span class="pp">|</span> Reactor volume <span class="co">[</span><span class="ot">L</span><span class="co">]</span>                                                                                                                                                            <span class="pp">|</span> <span class="in">`100.0`</span>         <span class="pp">|</span></span>
<span id="cb13-368"><a href="#cb13-368" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A_feed_val <span class="pp">|</span> float                  <span class="pp">|</span> Feed concentration <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span>                                                                                                                                                    <span class="pp">|</span> <span class="in">`1.0`</span>           <span class="pp">|</span></span>
<span id="cb13-369"><a href="#cb13-369" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_feed_val   <span class="pp">|</span> float                  <span class="pp">|</span> Feed temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                                                          <span class="pp">|</span> <span class="in">`350.0`</span>         <span class="pp">|</span></span>
<span id="cb13-370"><a href="#cb13-370" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k0_val       <span class="pp">|</span> float                  <span class="pp">|</span> Pre-exponential factor <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                                                                  <span class="pp">|</span> <span class="in">`72000000000.0`</span> <span class="pp">|</span></span>
<span id="cb13-371"><a href="#cb13-371" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E_val        <span class="pp">|</span> float                  <span class="pp">|</span> Activation energy <span class="co">[</span><span class="ot">K</span><span class="co">]</span> (dimensionless Eₐ/R)                                                                                                                                    <span class="pp">|</span> <span class="in">`8750.0`</span>        <span class="pp">|</span></span>
<span id="cb13-372"><a href="#cb13-372" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> delta_H_val  <span class="pp">|</span> float                  <span class="pp">|</span> Heat of reaction <span class="co">[</span><span class="ot">J/mol</span><span class="co">]</span> (negative = exothermic)                                                                                                                              <span class="pp">|</span> <span class="in">`-50000.0`</span>      <span class="pp">|</span></span>
<span id="cb13-373"><a href="#cb13-373" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> rho_val      <span class="pp">|</span> float                  <span class="pp">|</span> Density <span class="co">[</span><span class="ot">kg/L</span><span class="co">]</span>                                                                                                                                                                <span class="pp">|</span> <span class="in">`1000.0`</span>        <span class="pp">|</span></span>
<span id="cb13-374"><a href="#cb13-374" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Cp_val       <span class="pp">|</span> float                  <span class="pp">|</span> Specific heat capacity <span class="co">[</span><span class="ot">J/(kg·K)</span><span class="co">]</span>                                                                                                                                             <span class="pp">|</span> <span class="in">`0.239`</span>         <span class="pp">|</span></span>
<span id="cb13-375"><a href="#cb13-375" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> UA_val       <span class="pp">|</span> float                  <span class="pp">|</span> Overall heat transfer coefficient × area <span class="co">[</span><span class="ot">J/(s·K)</span><span class="co">]</span>                                                                                                                            <span class="pp">|</span> <span class="in">`50000.0`</span>       <span class="pp">|</span></span>
<span id="cb13-376"><a href="#cb13-376" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> x_ss         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Steady-state <span class="co">[</span><span class="ot">Cₐ, T</span><span class="co">]</span> for equilibrium setup                                                                                                                                    <span class="pp">|</span> <span class="in">`None`</span>          <span class="pp">|</span></span>
<span id="cb13-377"><a href="#cb13-377" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> u_ss         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Steady-state <span class="co">[</span><span class="ot">T_jacket</span><span class="co">]</span> for equilibrium setup                                                                                                                                 <span class="pp">|</span> <span class="in">`None`</span>          <span class="pp">|</span></span>
<span id="cb13-378"><a href="#cb13-378" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_C      <span class="pp">|</span> float                  <span class="pp">|</span> Concentration noise intensity <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span> - Continuous-time units: per √s - Typical: 0.0001-0.01 mol/(L·√s) - Smaller than batch reactor (continuous operation)              <span class="pp">|</span> <span class="in">`0.001`</span>         <span class="pp">|</span></span>
<span id="cb13-379"><a href="#cb13-379" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_T      <span class="pp">|</span> float                  <span class="pp">|</span> Temperature noise intensity <span class="co">[</span><span class="ot">K/√s</span><span class="co">]</span> - Continuous-time units: per √s - Typical: 0.1-5.0 K/√s - Determines transition rates (exponentially) - Critical parameter for reliability <span class="pp">|</span> <span class="in">`1.0`</span>           <span class="pp">|</span></span>
<span id="cb13-380"><a href="#cb13-380" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> x_ss         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Known steady state (if available)                                                                                                                                             <span class="pp">|</span> <span class="in">`None`</span>          <span class="pp">|</span></span>
<span id="cb13-381"><a href="#cb13-381" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> u_ss         <span class="pp">|</span> Optional<span class="sc">\[</span>np.ndarray<span class="sc">\]</span> <span class="pp">|</span> Known steady state (if available)                                                                                                                                             <span class="pp">|</span> <span class="in">`None`</span>          <span class="pp">|</span></span>
<span id="cb13-382"><a href="#cb13-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-383"><a href="#cb13-383" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb13-384"><a href="#cb13-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-385"><a href="#cb13-385" aria-hidden="true" tabindex="-1"></a>**Noise Intensity Selection:**</span>
<span id="cb13-386"><a href="#cb13-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-387"><a href="#cb13-387" aria-hidden="true" tabindex="-1"></a>Physical reasoning:</span>
<span id="cb13-388"><a href="#cb13-388" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_C ~ 0.001: Precise control, large reactor</span>
<span id="cb13-389"><a href="#cb13-389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_C ~ 0.01: Typical industrial</span>
<span id="cb13-390"><a href="#cb13-390" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_T ~ 0.5: Good temperature control</span>
<span id="cb13-391"><a href="#cb13-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_T ~ 2.0: Poor control, high variability</span>
<span id="cb13-392"><a href="#cb13-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-393"><a href="#cb13-393" aria-hidden="true" tabindex="-1"></a>**Temperature Noise Impact:**</span>
<span id="cb13-394"><a href="#cb13-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-395"><a href="#cb13-395" aria-hidden="true" tabindex="-1"></a>At high-conversion (T ≈ 390 K):</span>
<span id="cb13-396"><a href="#cb13-396" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_T = 0.5 K/√s: Very stable, rare transitions</span>
<span id="cb13-397"><a href="#cb13-397" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_T = 1.0 K/√s: Occasional transitions (hours)</span>
<span id="cb13-398"><a href="#cb13-398" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_T = 2.0 K/√s: Frequent transitions (minutes)</span>
<span id="cb13-399"><a href="#cb13-399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>σ_T = 5.0 K/√s: Very unstable, constant switching</span>
<span id="cb13-400"><a href="#cb13-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-401"><a href="#cb13-401" aria-hidden="true" tabindex="-1"></a>**Design Criterion:**</span>
<span id="cb13-402"><a href="#cb13-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-403"><a href="#cb13-403" aria-hidden="true" tabindex="-1"></a>Choose σ_T such that mean first passage time:</span>
<span id="cb13-404"><a href="#cb13-404" aria-hidden="true" tabindex="-1"></a>    τ_escape &gt; 100·τ_operation</span>
<span id="cb13-405"><a href="#cb13-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-406"><a href="#cb13-406" aria-hidden="true" tabindex="-1"></a>Ensures reliable operation (99% success).</span>
<span id="cb13-407"><a href="#cb13-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-408"><a href="#cb13-408" aria-hidden="true" tabindex="-1"></a>**Conversion to Discrete:**</span>
<span id="cb13-409"><a href="#cb13-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-410"><a href="#cb13-410" aria-hidden="true" tabindex="-1"></a>For discrete model with sampling Δt:</span>
<span id="cb13-411"><a href="#cb13-411" aria-hidden="true" tabindex="-1"></a>    σ_discrete = σ_continuous·√Δt</span>
<span id="cb13-412"><a href="#cb13-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-413"><a href="#cb13-413" aria-hidden="true" tabindex="-1"></a>Example: σ_T = 1.0 K/√s, Δt = 5 s</span>
<span id="cb13-414"><a href="#cb13-414" aria-hidden="true" tabindex="-1"></a>    → σ_T_discrete = 1.0·√5 ≈ 2.24 K per step</span>
<span id="cb13-415"><a href="#cb13-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-416"><a href="#cb13-416" aria-hidden="true" tabindex="-1"></a>**Additive vs Multiplicative:**</span>
<span id="cb13-417"><a href="#cb13-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-418"><a href="#cb13-418" aria-hidden="true" tabindex="-1"></a>This uses additive (state-independent) noise.</span>
<span id="cb13-419"><a href="#cb13-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-420"><a href="#cb13-420" aria-hidden="true" tabindex="-1"></a>Alternative: Multiplicative noise</span>
<span id="cb13-421"><a href="#cb13-421" aria-hidden="true" tabindex="-1"></a>    g(X) = diag(σ_C·C_A, σ_T·T)</span>
<span id="cb13-422"><a href="#cb13-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-423"><a href="#cb13-423" aria-hidden="true" tabindex="-1"></a>Would represent:</span>
<span id="cb13-424"><a href="#cb13-424" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Relative errors (percentage fluctuations)</span>
<span id="cb13-425"><a href="#cb13-425" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>State-dependent uncertainty</span>
<span id="cb13-426"><a href="#cb13-426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>More complex analysis</span>
<span id="cb13-427"><a href="#cb13-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-428"><a href="#cb13-428" aria-hidden="true" tabindex="-1"></a><span class="fu">### estimate_escape_rate { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate }</span></span>
<span id="cb13-429"><a href="#cb13-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-430"><a href="#cb13-430" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-431"><a href="#cb13-431" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.estimate_escape_rate(</span>
<span id="cb13-432"><a href="#cb13-432" aria-hidden="true" tabindex="-1"></a>    x_basin,</span>
<span id="cb13-433"><a href="#cb13-433" aria-hidden="true" tabindex="-1"></a>    barrier_height,</span>
<span id="cb13-434"><a href="#cb13-434" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-435"><a href="#cb13-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-436"><a href="#cb13-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-437"><a href="#cb13-437" aria-hidden="true" tabindex="-1"></a>Estimate escape rate from basin using large deviations theory.</span>
<span id="cb13-438"><a href="#cb13-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-439"><a href="#cb13-439" aria-hidden="true" tabindex="-1"></a>Approximate formula:</span>
<span id="cb13-440"><a href="#cb13-440" aria-hidden="true" tabindex="-1"></a>    Rate ≈ (ω/2π)·exp(-ΔV/σ_T²)</span>
<span id="cb13-441"><a href="#cb13-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-442"><a href="#cb13-442" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb13-443"><a href="#cb13-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-444"><a href="#cb13-444" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name           <span class="pp">|</span> Type       <span class="pp">|</span> Description                                 <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb13-445"><a href="#cb13-445" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------------|------------|---------------------------------------------|------------|</span></span>
<span id="cb13-446"><a href="#cb13-446" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> x_basin        <span class="pp">|</span> np.ndarray <span class="pp">|</span> State in basin (stable equilibrium)         <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-447"><a href="#cb13-447" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> barrier_height <span class="pp">|</span> float      <span class="pp">|</span> Potential barrier height (energy to saddle) <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb13-448"><a href="#cb13-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-449"><a href="#cb13-449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb13-450"><a href="#cb13-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-451"><a href="#cb13-451" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description       <span class="pp">|</span></span>
<span id="cb13-452"><a href="#cb13-452" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|-------------------|</span></span>
<span id="cb13-453"><a href="#cb13-453" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> float  <span class="pp">|</span> Escape rate <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span> <span class="pp">|</span></span>
<span id="cb13-454"><a href="#cb13-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-455"><a href="#cb13-455" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb13-456"><a href="#cb13-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-457"><a href="#cb13-457" aria-hidden="true" tabindex="-1"></a>This is an approximation valid for small noise.</span>
<span id="cb13-458"><a href="#cb13-458" aria-hidden="true" tabindex="-1"></a>For accurate rates, use Monte Carlo simulation.</span>
<span id="cb13-459"><a href="#cb13-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-460"><a href="#cb13-460" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb13-461"><a href="#cb13-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-462"><a href="#cb13-462" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-463"><a href="#cb13-463" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousStochasticCSTR(sigma_T<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb13-464"><a href="#cb13-464" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># Approximate barrier height: 50 K² equivalent</span></span>
<span id="cb13-465"><a href="#cb13-465" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rate <span class="op">=</span> cstr.estimate_escape_rate(</span>
<span id="cb13-466"><a href="#cb13-466" aria-hidden="true" tabindex="-1"></a>...     x_basin<span class="op">=</span>np.array([<span class="fl">0.1</span>, <span class="fl">390.0</span>]),</span>
<span id="cb13-467"><a href="#cb13-467" aria-hidden="true" tabindex="-1"></a>...     barrier_height<span class="op">=</span><span class="fl">50.0</span></span>
<span id="cb13-468"><a href="#cb13-468" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb13-469"><a href="#cb13-469" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> mean_time <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> rate</span>
<span id="cb13-470"><a href="#cb13-470" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Mean escape time: </span><span class="sc">{</span>mean_time<span class="sc">:.1f}</span><span class="ss"> s"</span>)</span>
<span id="cb13-471"><a href="#cb13-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-472"><a href="#cb13-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-473"><a href="#cb13-473" aria-hidden="true" tabindex="-1"></a><span class="fu">### find_steady_states { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states }</span></span>
<span id="cb13-474"><a href="#cb13-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-475"><a href="#cb13-475" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-476"><a href="#cb13-476" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.find_steady_states(</span>
<span id="cb13-477"><a href="#cb13-477" aria-hidden="true" tabindex="-1"></a>    T_jacket,</span>
<span id="cb13-478"><a href="#cb13-478" aria-hidden="true" tabindex="-1"></a>    T_range<span class="op">=</span>(<span class="fl">300.0</span>, <span class="fl">500.0</span>),</span>
<span id="cb13-479"><a href="#cb13-479" aria-hidden="true" tabindex="-1"></a>    n_points<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb13-480"><a href="#cb13-480" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-481"><a href="#cb13-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-482"><a href="#cb13-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-483"><a href="#cb13-483" aria-hidden="true" tabindex="-1"></a>Find all steady states of deterministic part.</span>
<span id="cb13-484"><a href="#cb13-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-485"><a href="#cb13-485" aria-hidden="true" tabindex="-1"></a>These are centers of Fokker-Planck stationary distribution.</span>
<span id="cb13-486"><a href="#cb13-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-487"><a href="#cb13-487" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb13-488"><a href="#cb13-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-489"><a href="#cb13-489" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name     <span class="pp">|</span> Type   <span class="pp">|</span> Description            <span class="pp">|</span> Default          <span class="pp">|</span></span>
<span id="cb13-490"><a href="#cb13-490" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|--------|------------------------|------------------|</span></span>
<span id="cb13-491"><a href="#cb13-491" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_jacket <span class="pp">|</span> float  <span class="pp">|</span> Jacket temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span> <span class="pp">|</span> _required_       <span class="pp">|</span></span>
<span id="cb13-492"><a href="#cb13-492" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_range  <span class="pp">|</span> tuple  <span class="pp">|</span> Search range           <span class="pp">|</span> <span class="in">`(300.0, 500.0)`</span> <span class="pp">|</span></span>
<span id="cb13-493"><a href="#cb13-493" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> n_points <span class="pp">|</span> int    <span class="pp">|</span> Initial guesses        <span class="pp">|</span> <span class="in">`100`</span>            <span class="pp">|</span></span>
<span id="cb13-494"><a href="#cb13-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-495"><a href="#cb13-495" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb13-496"><a href="#cb13-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-497"><a href="#cb13-497" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type                          <span class="pp">|</span> Description                   <span class="pp">|</span></span>
<span id="cb13-498"><a href="#cb13-498" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-------------------------------|-------------------------------|</span></span>
<span id="cb13-499"><a href="#cb13-499" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> List<span class="sc">\[</span>Tuple<span class="sc">\[</span>float, float<span class="sc">\]\]</span> <span class="pp">|</span> <span class="co">[</span><span class="ot">(C_A, T), ...</span><span class="co">]</span> steady states <span class="pp">|</span></span>
<span id="cb13-500"><a href="#cb13-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-501"><a href="#cb13-501" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb13-502"><a href="#cb13-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-503"><a href="#cb13-503" aria-hidden="true" tabindex="-1"></a>With noise, stationary distribution has peaks at these</span>
<span id="cb13-504"><a href="#cb13-504" aria-hidden="true" tabindex="-1"></a>points (if stable) or valleys (if unstable).</span>
<span id="cb13-505"><a href="#cb13-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-506"><a href="#cb13-506" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb13-507"><a href="#cb13-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-508"><a href="#cb13-508" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-509"><a href="#cb13-509" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousStochasticCSTR()</span>
<span id="cb13-510"><a href="#cb13-510" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> states <span class="op">=</span> cstr.find_steady_states(T_jacket<span class="op">=</span><span class="fl">350.0</span>)</span>
<span id="cb13-511"><a href="#cb13-511" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(states)<span class="sc">}</span><span class="ss"> steady states"</span>)</span>
<span id="cb13-512"><a href="#cb13-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-513"><a href="#cb13-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-514"><a href="#cb13-514" aria-hidden="true" tabindex="-1"></a><span class="fu">### get_noise_intensities { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities }</span></span>
<span id="cb13-515"><a href="#cb13-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-516"><a href="#cb13-516" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-517"><a href="#cb13-517" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.get_noise_intensities(</span>
<span id="cb13-518"><a href="#cb13-518" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-519"><a href="#cb13-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-520"><a href="#cb13-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-521"><a href="#cb13-521" aria-hidden="true" tabindex="-1"></a>Get continuous-time noise intensities.</span>
<span id="cb13-522"><a href="#cb13-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-523"><a href="#cb13-523" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb13-524"><a href="#cb13-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-525"><a href="#cb13-525" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description                      <span class="pp">|</span></span>
<span id="cb13-526"><a href="#cb13-526" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|----------------------------------|</span></span>
<span id="cb13-527"><a href="#cb13-527" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> dict   <span class="pp">|</span> {'sigma_C': ..., 'sigma_T': ...} <span class="pp">|</span></span>
<span id="cb13-528"><a href="#cb13-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-529"><a href="#cb13-529" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb13-530"><a href="#cb13-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-531"><a href="#cb13-531" aria-hidden="true" tabindex="-1"></a>Units: <span class="co">[</span><span class="ot">state</span><span class="co">]</span>/√<span class="co">[</span><span class="ot">time</span><span class="co">]</span></span>
<span id="cb13-532"><a href="#cb13-532" aria-hidden="true" tabindex="-1"></a>To convert to discrete: σ_d = σ_c·√Δt</span>
<span id="cb13-533"><a href="#cb13-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-534"><a href="#cb13-534" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb13-535"><a href="#cb13-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-536"><a href="#cb13-536" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-537"><a href="#cb13-537" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cstr <span class="op">=</span> ContinuousStochasticCSTR(sigma_C<span class="op">=</span><span class="fl">0.001</span>, sigma_T<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb13-538"><a href="#cb13-538" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> noise <span class="op">=</span> cstr.get_noise_intensities()</span>
<span id="cb13-539"><a href="#cb13-539" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Temperature noise: </span><span class="sc">{</span>noise[<span class="st">'sigma_T'</span>]<span class="sc">}</span><span class="ss"> K/√s"</span>)</span>
<span id="cb13-540"><a href="#cb13-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-541"><a href="#cb13-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-542"><a href="#cb13-542" aria-hidden="true" tabindex="-1"></a><span class="fu">### setup_equilibria { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria }</span></span>
<span id="cb13-543"><a href="#cb13-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-544"><a href="#cb13-544" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb13-545"><a href="#cb13-545" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.setup_equilibria(</span>
<span id="cb13-546"><a href="#cb13-546" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-547"><a href="#cb13-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-548"><a href="#cb13-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-549"><a href="#cb13-549" aria-hidden="true" tabindex="-1"></a>Set up equilibrium points (deterministic part).</span>
<span id="cb13-550"><a href="#cb13-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-551"><a href="#cb13-551" aria-hidden="true" tabindex="-1"></a>Note: These are centers of stationary distributions.</span>
<span id="cb13-552"><a href="#cb13-552" aria-hidden="true" tabindex="-1"></a>Multiple equilibria may exist. Use find_steady_states().</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/systems.builtin.stochastic.continuous.ContinuousStochasticCSTR.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>