<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>systems.builtin.stochastic.continuous.continuousstochasticbatchreactor – ControlDESymulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-64209fde6f94c7ab255c4d888f9dae80.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ControlDESymulation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials/installation.qmd"> 
<span class="menu-text">Installation Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-architecture" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Architecture</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-architecture">    
        <li>
    <a class="dropdown-item" href="../architecture/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../architecture/cdesym_Design_Philosophy.html">
 <span class="dropdown-text">ControlDESymulation: Design Philosophy and Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/UI_Framework_Architecture.html">
 <span class="dropdown-text">UI Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Type_System_Architecture.html">
 <span class="dropdown-text">Type System Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Integration_Framework_Architecture.html">
 <span class="dropdown-text">Integration Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Control_Framework_Architecture.html">
 <span class="dropdown-text">Control Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Visualization_Framework_Architecture.html">
 <span class="dropdown-text">Visualization Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Delegation_Layer_Architecture.html">
 <span class="dropdown-text">Delegation Layer Architecture</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li class="dropdown-header">tutorials/basic_usage.qmd</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li class="dropdown-header">examples/pendulum_control.qmd</li>
        <li class="dropdown-header">examples/cartpole_swingup.qmd</li>
        <li class="dropdown-header">examples/quadrotor_lqr.qmd</li>
        <li class="dropdown-header">examples/cstr_multiplicity.qmd</li>
        <li class="dropdown-header">examples/lorenz_chaos.qmd</li>
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../api/index.html"> 
<span class="menu-text">API Reference</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gilbenezer/ControlDESymulation"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor" class="nav-link active" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor">systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor</a>
  <ul>
  <li><a href="#stochastic-differential-equations" id="toc-stochastic-differential-equations" class="nav-link" data-scroll-target="#stochastic-differential-equations">Stochastic Differential Equations</a></li>
  <li><a href="#physical-interpretation" id="toc-physical-interpretation" class="nav-link" data-scroll-target="#physical-interpretation">Physical Interpretation</a></li>
  <li><a href="#state-space" id="toc-state-space" class="nav-link" data-scroll-target="#state-space">State Space</a></li>
  <li><a href="#key-properties" id="toc-key-properties" class="nav-link" data-scroll-target="#key-properties">Key Properties</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications">Applications</a></li>
  <li><a href="#numerical-simulation" id="toc-numerical-simulation" class="nav-link" data-scroll-target="#numerical-simulation">Numerical Simulation</a></li>
  <li><a href="#comparison-with-deterministic" id="toc-comparison-with-deterministic" class="nav-link" data-scroll-target="#comparison-with-deterministic">Comparison with Deterministic</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  <li><a href="#extensions" id="toc-extensions" class="nav-link" data-scroll-target="#extensions">Extensions</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See Also</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio">compute_signal_to_noise_ratio</a>
  <ul class="collapse">
  <li><a href="#parameters-1" id="toc-parameters-1" class="nav-link" data-scroll-target="#parameters-1">Parameters</a></li>
  <li><a href="#returns" id="toc-returns" class="nav-link" data-scroll-target="#returns">Returns</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system">define_system</a>
  <ul class="collapse">
  <li><a href="#parameters-2" id="toc-parameters-2" class="nav-link" data-scroll-target="#parameters-2">Parameters</a></li>
  <li><a href="#notes-1" id="toc-notes-1" class="nav-link" data-scroll-target="#notes-1">Notes</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth">estimate_variance_growth</a>
  <ul class="collapse">
  <li><a href="#parameters-3" id="toc-parameters-3" class="nav-link" data-scroll-target="#parameters-3">Parameters</a></li>
  <li><a href="#returns-1" id="toc-returns-1" class="nav-link" data-scroll-target="#returns-1">Returns</a></li>
  <li><a href="#notes-2" id="toc-notes-2" class="nav-link" data-scroll-target="#notes-2">Notes</a></li>
  <li><a href="#examples-1" id="toc-examples-1" class="nav-link" data-scroll-target="#examples-1">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities">get_noise_intensities</a>
  <ul class="collapse">
  <li><a href="#returns-2" id="toc-returns-2" class="nav-link" data-scroll-target="#returns-2">Returns</a></li>
  <li><a href="#examples-2" id="toc-examples-2" class="nav-link" data-scroll-target="#examples-2">Examples</a></li>
  </ul></li>
  <li><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria" id="toc-cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria" class="nav-link" data-scroll-target="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria">setup_equilibria</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7"></h1></header><div class="quarto-title-block"><div class="quarto-title-tools-only"><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>




<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor" class="level1">
<h1>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor</h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>args,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Continuous-time stochastic batch reactor with process noise.</p>
<p>Extends the deterministic batch reactor to include stochastic effects from process disturbances, parameter uncertainty, and inherent randomness. This model is essential for robust control design, risk analysis, and state estimation under uncertainty.</p>
<section id="stochastic-differential-equations" class="level2 doc-section doc-section-stochastic-differential-equations">
<h2 class="doc-section doc-section-stochastic-differential-equations anchored" data-anchor-id="stochastic-differential-equations">Stochastic Differential Equations</h2>
<p>The reactor dynamics with additive noise:</p>
<pre><code>dC_A = (-r₁)·dt + σ_A·dW_A
dC_B = (r₁ - r₂)·dt + σ_B·dW_B
dT = (Q - α·(T - T_amb))·dt + σ_T·dW_T</code></pre>
<p>where: - r₁ = k₁·C_A·exp(-E₁/T): Reaction 1 rate (A → B) - r₂ = k₂·C_B·exp(-E₂/T): Reaction 2 rate (B → C) - σ_A, σ_B: Concentration noise intensities [mol/(L·√s)] - σ_T: Temperature noise intensity [K/√s] - W_A, W_B, W_T: Independent Wiener processes</p>
</section>
<section id="physical-interpretation" class="level2 doc-section doc-section-physical-interpretation">
<h2 class="doc-section doc-section-physical-interpretation anchored" data-anchor-id="physical-interpretation">Physical Interpretation</h2>
<p><strong>Noise Sources:</strong></p>
<ol type="1">
<li><strong>Concentration Noise (σ_A, σ_B):</strong>
<ul>
<li>Feed composition variability</li>
<li>Mixing imperfections</li>
<li>Sampling uncertainty</li>
<li>Kinetic parameter fluctuations</li>
</ul></li>
<li><strong>Temperature Noise (σ_T):</strong>
<ul>
<li>Heat transfer variations</li>
<li>Ambient temperature changes</li>
<li>Control system imperfections</li>
<li>Measurement noise</li>
</ul></li>
</ol>
<p><strong>Why Three Independent Sources?</strong> - Different physical mechanisms - Spatial separation (bulk vs jacket) - Independent control loops</p>
</section>
<section id="state-space" class="level2 doc-section doc-section-state-space">
<h2 class="doc-section doc-section-state-space anchored" data-anchor-id="state-space">State Space</h2>
<p>State: x = [C_A, C_B, T] Same as deterministic model but now stochastic: - C_A(t): Random process, not deterministic function - C_B(t): Random process - T(t): Random process</p>
<pre><code>Each trajectory is one realization from probability distribution.</code></pre>
<p>Control: u = [Q] - Q: Heating/cooling rate [K/s] - Same as deterministic (no noise in control)</p>
<p>Noise: w = [w_A, w_B, w_T] - Three independent Wiener processes - Dimension: nw = 3 - Structure: Diagonal (uncorrelated)</p>
</section>
<section id="key-properties" class="level2 doc-section doc-section-key-properties">
<h2 class="doc-section doc-section-key-properties anchored" data-anchor-id="key-properties">Key Properties</h2>
<p><strong>Stochastic Nature:</strong> - Multiple runs give different trajectories - Statistics (mean, variance) evolve over time - Need ensemble analysis (Monte Carlo)</p>
<p><strong>Mean Behavior:</strong> For additive noise: E[X(t)] follows deterministic dynamics approximately.</p>
<p><strong>Variance Growth:</strong> Variance increases with time due to noise accumulation: Var[C_A(t)] ≈ Var[C_A(0)] + σ_A²·t</p>
<p><strong>Non-Gaussian:</strong> Even with Gaussian noise, nonlinear dynamics create non-Gaussian distributions (except in linear approximation).</p>
</section>
<section id="parameters" class="level2 doc-section doc-section-parameters">
<h2 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters">Parameters</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 78%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>k1</td>
<td>float</td>
<td>Pre-exponential factor for A→B reaction [1/s]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>k2</td>
<td>float</td>
<td>Pre-exponential factor for B→C reaction [1/s]</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>E1</td>
<td>float</td>
<td>Activation energy for reaction 1 [K]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>E2</td>
<td>float</td>
<td>Activation energy for reaction 2 [K]</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>alpha</td>
<td>float</td>
<td>Heat transfer coefficient [1/s]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>T_amb</td>
<td>float</td>
<td>Ambient temperature [K]</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>C_A0</td>
<td>Optional[float]</td>
<td>Initial concentration of A for equilibrium setup [mol/L]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>T0</td>
<td>Optional[float]</td>
<td>Initial temperature for equilibrium setup [K]</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>sigma_A</td>
<td>float</td>
<td>Concentration noise for A [mol/(L·√s)] - Controls C_A fluctuations - Typical: 0.001-0.1 - Should be &lt;&lt; C_A0 for realistic noise</td>
<td><code>0.01</code></td>
</tr>
<tr class="even">
<td>sigma_B</td>
<td>float</td>
<td>Concentration noise for B [mol/(L·√s)] - Controls C_B fluctuations - Typical: 0.001-0.1</td>
<td><code>0.01</code></td>
</tr>
<tr class="odd">
<td>sigma_T</td>
<td>float</td>
<td>Temperature noise [K/√s] - Controls T fluctuations - Typical: 0.1-5.0 - More critical than concentration noise (exponential effect via Arrhenius)</td>
<td><code>1.0</code></td>
</tr>
</tbody>
</table>
</section>
<section id="applications" class="level2 doc-section doc-section-applications">
<h2 class="doc-section doc-section-applications anchored" data-anchor-id="applications">Applications</h2>
<p><strong>1. Robust Optimal Control:</strong> Design controllers accounting for uncertainty: - Stochastic MPC with chance constraints - Risk-sensitive control - Robust trajectory optimization</p>
<p><strong>2. State Estimation:</strong> Kalman filter for noisy measurements: - Extended Kalman Filter (EKF) - Unscented Kalman Filter (UKF) - Particle filter</p>
<p><strong>3. Risk Analysis:</strong> Assess probability of constraint violation: - Monte Carlo simulation - Rare event estimation - Safety verification</p>
<p><strong>4. Parameter Identification:</strong> Estimate parameters from noisy data: - Maximum likelihood - Bayesian inference - Sequential Monte Carlo</p>
<p><strong>5. Process Design:</strong> Design for robustness: - Worst-case analysis - Six Sigma methodology - Process capability studies</p>
</section>
<section id="numerical-simulation" class="level2 doc-section doc-section-numerical-simulation">
<h2 class="doc-section doc-section-numerical-simulation anchored" data-anchor-id="numerical-simulation">Numerical Simulation</h2>
<p><strong>Recommended Methods:</strong> - Euler-Maruyama: Simple, robust, dt ~ 0.01-0.1 s - Milstein: Higher order, dt ~ 0.001-0.01 s - SRK: Even higher order, more cost</p>
<p><strong>Monte Carlo Ensemble:</strong> Run N = 100-10,000 simulations to characterize: - Mean trajectory: E[X(t)] - Variance: Var[X(t)] - Confidence bands: μ ± 2σ - Probability distributions</p>
<p><strong>Noise Structure:</strong> - Type: ADDITIVE (state-independent) - Dimension: nw = 3 (three Wiener processes) - Correlation: DIAGONAL (independent noise sources)</p>
</section>
<section id="comparison-with-deterministic" class="level2 doc-section doc-section-comparison-with-deterministic">
<h2 class="doc-section doc-section-comparison-with-deterministic anchored" data-anchor-id="comparison-with-deterministic">Comparison with Deterministic</h2>
<p><strong>Deterministic:</strong> - Single trajectory - Perfect prediction - Nominal design</p>
<p><strong>Stochastic:</strong> - Ensemble of trajectories - Probabilistic prediction - Robust design</p>
<p><strong>When Stochastic is Necessary:</strong> - Real process has significant noise - Robust control needed - Risk assessment required - Parameter uncertainty significant</p>
</section>
<section id="limitations" class="level2 doc-section doc-section-limitations">
<h2 class="doc-section doc-section-limitations anchored" data-anchor-id="limitations">Limitations</h2>
<ul>
<li>Additive noise only (not multiplicative)</li>
<li>Constant noise intensity (not state-dependent)</li>
<li>Independent noise sources (no correlation)</li>
<li>No jumps (only continuous Brownian paths)</li>
</ul>
</section>
<section id="extensions" class="level2 doc-section doc-section-extensions">
<h2 class="doc-section doc-section-extensions anchored" data-anchor-id="extensions">Extensions</h2>
<ul>
<li>Multiplicative noise: g(x) = diag(σ_A·C_A, σ_B·C_B, σ_T·T)</li>
<li>Correlated noise: Full covariance matrix</li>
<li>Jump diffusion: Add Poisson jumps</li>
<li>Parameter uncertainty: Random walk parameters</li>
</ul>
</section>
<section id="see-also" class="level2 doc-section doc-section-see-also">
<h2 class="doc-section doc-section-see-also anchored" data-anchor-id="see-also">See Also</h2>
<p>ContinuousBatchReactor : Deterministic version OrnsteinUhlenbeck : Mean-reverting stochastic process GeometricBrownianMotion : Multiplicative noise example</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio">compute_signal_to_noise_ratio</a></td>
<td>Compute signal-to-noise ratio for each state.</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system">define_system</a></td>
<td>Define stochastic batch reactor dynamics.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth">estimate_variance_growth</a></td>
<td>Estimate variance growth for additive noise (approximate).</td>
</tr>
<tr class="even">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities">get_noise_intensities</a></td>
<td>Get current noise intensity parameters.</td>
</tr>
<tr class="odd">
<td><a href="#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria">setup_equilibria</a></td>
<td>Set up equilibrium points.</td>
</tr>
</tbody>
</table>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio">compute_signal_to_noise_ratio</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Compute signal-to-noise ratio for each state.</p>
<p>SNR = |x| / (σ·√t)</p>
<p>Higher SNR → noise less significant.</p>
<section id="parameters-1" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>np.ndarray</td>
<td>Current state [C_A, C_B, T]</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>t</td>
<td>float</td>
<td>Time since start [s]</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>np.ndarray</td>
<td>SNR for [C_A, C_B, T]</td>
</tr>
</tbody>
</table>
</section>
<section id="notes" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes">Notes</h4>
<p>SNR &gt; 10: Noise negligible SNR ~ 1: Noise significant SNR &lt; 0.1: Noise dominates</p>
</section>
<section id="examples" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> reactor <span class="op">=</span> ContinuousStochasticBatchReactor()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="op">=</span> np.array([<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">360.0</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> snr <span class="op">=</span> reactor.compute_signal_to_noise_ratio(x, t<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"SNR: C_A=</span><span class="sc">{</span>snr[<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss">, C_B=</span><span class="sc">{</span>snr[<span class="dv">1</span>]<span class="sc">:.1f}</span><span class="ss">, T=</span><span class="sc">{</span>snr[<span class="dv">2</span>]<span class="sc">:.1f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system">define_system</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    k1_val<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    k2_val<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    E1_val<span class="op">=</span><span class="fl">1000.0</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    E2_val<span class="op">=</span><span class="fl">1500.0</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    alpha_val<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    T_amb_val<span class="op">=</span><span class="fl">300.0</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    sigma_A<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    sigma_B<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    sigma_T<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    C_A0<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    T0<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Define stochastic batch reactor dynamics.</p>
<section id="parameters-2" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 80%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>k1_val</td>
<td>float</td>
<td>Pre-exponential factor for A→B reaction [1/s]</td>
<td><code>0.5</code></td>
</tr>
<tr class="even">
<td>k2_val</td>
<td>float</td>
<td>Pre-exponential factor for B→C reaction [1/s]</td>
<td><code>0.3</code></td>
</tr>
<tr class="odd">
<td>E1_val</td>
<td>float</td>
<td>Activation energy for reaction 1 [K]</td>
<td><code>1000.0</code></td>
</tr>
<tr class="even">
<td>E2_val</td>
<td>float</td>
<td>Activation energy for reaction 2 [K]</td>
<td><code>1500.0</code></td>
</tr>
<tr class="odd">
<td>alpha_val</td>
<td>float</td>
<td>Heat transfer coefficient [1/s]</td>
<td><code>0.1</code></td>
</tr>
<tr class="even">
<td>T_amb_val</td>
<td>float</td>
<td>Ambient temperature [K]</td>
<td><code>300.0</code></td>
</tr>
<tr class="odd">
<td>sigma_A</td>
<td>float</td>
<td>Concentration noise intensity for A [mol/(L·√s)] - Typical: 0.001-0.1 mol/(L·√s) - Should be &lt;&lt; C_A0 for realistic noise - Rule of thumb: σ_A ~ 0.01·C_A0</td>
<td><code>0.01</code></td>
</tr>
<tr class="even">
<td>sigma_B</td>
<td>float</td>
<td>Concentration noise intensity for B [mol/(L·√s)] - Same magnitude as σ_A typically - Represents mixing and kinetic uncertainty</td>
<td><code>0.01</code></td>
</tr>
<tr class="odd">
<td>sigma_T</td>
<td>float</td>
<td>Temperature noise intensity [K/√s] - Typical: 0.1-5.0 K/√s - More critical than concentration noise - Affects reaction rates exponentially - Rule of thumb: σ_T ~ 1 K/√s</td>
<td><code>1.0</code></td>
</tr>
<tr class="even">
<td>C_A0</td>
<td>Optional[float]</td>
<td>Initial conditions for equilibrium setup</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>T0</td>
<td>Optional[float]</td>
<td>Initial conditions for equilibrium setup</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="notes-1" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-1">Notes</h4>
<p><strong>Drift (Deterministic Part):</strong> Identical to deterministic reactor: f(x, u) = [-r₁, r₁ - r₂, Q - α·(T - T_amb)]ᵀ</p>
<p><strong>Diffusion (Stochastic Part):</strong> Diagonal matrix (additive, independent noise): g(x, u) = diag(σ_A, σ_B, σ_T)</p>
<p>This gives three independent Wiener processes driving concentration and temperature fluctuations.</p>
<p><strong>Noise Intensity Guidelines:</strong></p>
<p>For 1% relative noise at C_A0 = 1.0 mol/L over 1 second: σ_A ~ 0.01 mol/(L·√s)</p>
<p>For 1 K standard deviation over 1 second: σ_T ~ 1.0 K/√s</p>
<p><strong>Physical Justification:</strong></p>
<p>Additive noise models: - External disturbances (feed, ambient) - Measurement errors (sensors) - Control system imperfections - Unmodeled dynamics (lumped effects)</p>
<p>Alternative: Multiplicative noise would be: g(x) = diag(σ_A·C_A, σ_B·C_B, σ_T·T)</p>
<p>This models relative errors scaling with state magnitude.</p>
<p><strong>Validation:</strong></p>
<p>Check noise levels are reasonable: 1. Run deterministic + stochastic simulations 2. Compare final states 3. Coefficient of variation should be 5-20%: CV = std(C_B_final) / mean(C_B_final) 4. If CV &gt; 30%: Noise too large 5. If CV &lt; 1%: Noise negligible</p>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth">estimate_variance_growth</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Estimate variance growth for additive noise (approximate).</p>
<p>For additive noise with independent sources: Var[X(t)] ≈ Var[X(0)] + diag(σ²)·t</p>
<p>This is exact for linear systems, approximate for nonlinear.</p>
<section id="parameters-3" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>t</td>
<td>float</td>
<td>Time [s]</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-1" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>np.ndarray</td>
<td>Estimated variance [Var(C_A), Var(C_B), Var(T)]</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-2" class="level4 doc-section doc-section-notes">
<h4 class="doc-section doc-section-notes anchored" data-anchor-id="notes-2">Notes</h4>
<p>This is a rough estimate. For accurate statistics, run Monte Carlo.</p>
</section>
<section id="examples-1" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-1">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> reactor <span class="op">=</span> ContinuousStochasticBatchReactor(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>...     sigma_A<span class="op">=</span><span class="fl">0.01</span>, sigma_B<span class="op">=</span><span class="fl">0.01</span>, sigma_T<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> var_100s <span class="op">=</span> reactor.estimate_variance_growth(t<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> std_100s <span class="op">=</span> np.sqrt(var_100s)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Estimated std after 100s: C_A=</span><span class="sc">{</span>std_100s[<span class="dv">0</span>]<span class="sc">:.3f}</span><span class="ss">, "</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>...       <span class="ss">f"C_B=</span><span class="sc">{</span>std_100s[<span class="dv">1</span>]<span class="sc">:.3f}</span><span class="ss">, T=</span><span class="sc">{</span>std_100s[<span class="dv">2</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities">get_noise_intensities</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Get current noise intensity parameters.</p>
<section id="returns-2" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-2">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>dict</td>
<td>Dictionary with keys ‘sigma_A’, ‘sigma_B’, ‘sigma_T’</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-2" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-2">Examples</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> reactor <span class="op">=</span> ContinuousStochasticBatchReactor(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>...     sigma_A<span class="op">=</span><span class="fl">0.01</span>, sigma_B<span class="op">=</span><span class="fl">0.01</span>, sigma_T<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> noise <span class="op">=</span> reactor.get_noise_intensities()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Temperature noise: </span><span class="sc">{</span>noise[<span class="st">'sigma_T'</span>]<span class="sc">}</span><span class="ss"> K/√s"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria" class="level3">
<h3 class="anchored" data-anchor-id="cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria">setup_equilibria</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Set up equilibrium points.</p>
<p>Note: For stochastic systems, “equilibrium” refers to deterministic part only. Actual trajectories fluctuate around this point.</p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/gilbenezer\.github\.io\/ControlDESymulation");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor }</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>args,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>Continuous-time stochastic batch reactor with process noise.</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>Extends the deterministic batch reactor to include stochastic effects</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>from process disturbances, parameter uncertainty, and inherent randomness.</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>This model is essential for robust control design, risk analysis, and</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>state estimation under uncertainty.</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stochastic Differential Equations {.doc-section .doc-section-stochastic-differential-equations}</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>The reactor dynamics with additive noise:</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="in">    dC_A = (-r₁)·dt + σ_A·dW_A</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="in">    dC_B = (r₁ - r₂)·dt + σ_B·dW_B</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="in">    dT = (Q - α·(T - T_amb))·dt + σ_T·dW_T</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>r₁ = k₁·C_A·exp(-E₁/T): Reaction 1 rate (A → B)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>r₂ = k₂·C_B·exp(-E₂/T): Reaction 2 rate (B → C)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>σ_A, σ_B: Concentration noise intensities <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>σ_T: Temperature noise intensity <span class="co">[</span><span class="ot">K/√s</span><span class="co">]</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>W_A, W_B, W_T: Independent Wiener processes</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Physical Interpretation {.doc-section .doc-section-physical-interpretation}</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>**Noise Sources:**</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Concentration Noise (σ_A, σ_B):**</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Feed composition variability</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mixing imperfections</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sampling uncertainty</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Kinetic parameter fluctuations</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Temperature Noise (σ_T):**</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Heat transfer variations</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ambient temperature changes</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Control system imperfections</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Measurement noise</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>**Why Three Independent Sources?**</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Different physical mechanisms</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spatial separation (bulk vs jacket)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Independent control loops</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## State Space {.doc-section .doc-section-state-space}</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>State: x = <span class="co">[</span><span class="ot">C_A, C_B, T</span><span class="co">]</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    Same as deterministic model but now stochastic:</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>C_A(t): Random process, not deterministic function</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>C_B(t): Random process</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>T(t): Random process</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    Each trajectory is one realization from probability distribution.</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>Control: u = <span class="co">[</span><span class="ot">Q</span><span class="co">]</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Q: Heating/cooling rate <span class="co">[</span><span class="ot">K/s</span><span class="co">]</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Same as deterministic (no noise in control)</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>Noise: w = <span class="co">[</span><span class="ot">w_A, w_B, w_T</span><span class="co">]</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Three independent Wiener processes</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Dimension: nw = 3</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Structure: Diagonal (uncorrelated)</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Properties {.doc-section .doc-section-key-properties}</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>**Stochastic Nature:**</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple runs give different trajectories</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistics (mean, variance) evolve over time</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Need ensemble analysis (Monte Carlo)</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>**Mean Behavior:**</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>For additive noise: E<span class="co">[</span><span class="ot">X(t)</span><span class="co">]</span> follows deterministic dynamics approximately.</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>**Variance Growth:**</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>Variance increases with time due to noise accumulation:</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>    Var<span class="co">[</span><span class="ot">C_A(t)</span><span class="co">]</span> ≈ Var<span class="co">[</span><span class="ot">C_A(0)</span><span class="co">]</span> + σ_A²·t</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>**Non-Gaussian:**</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>Even with Gaussian noise, nonlinear dynamics create non-Gaussian</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>distributions (except in linear approximation).</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name    <span class="pp">|</span> Type              <span class="pp">|</span> Description                                                                                                                                         <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|-------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|------------|</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k1      <span class="pp">|</span> float             <span class="pp">|</span> Pre-exponential factor for A→B reaction <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                       <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k2      <span class="pp">|</span> float             <span class="pp">|</span> Pre-exponential factor for B→C reaction <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                       <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E1      <span class="pp">|</span> float             <span class="pp">|</span> Activation energy for reaction 1 <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E2      <span class="pp">|</span> float             <span class="pp">|</span> Activation energy for reaction 2 <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> alpha   <span class="pp">|</span> float             <span class="pp">|</span> Heat transfer coefficient <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                                     <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_amb   <span class="pp">|</span> float             <span class="pp">|</span> Ambient temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                             <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A0    <span class="pp">|</span> Optional<span class="sc">\[</span>float<span class="sc">\]</span> <span class="pp">|</span> Initial concentration of A for equilibrium setup <span class="co">[</span><span class="ot">mol/L</span><span class="co">]</span>                                                                                            <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T0      <span class="pp">|</span> Optional<span class="sc">\[</span>float<span class="sc">\]</span> <span class="pp">|</span> Initial temperature for equilibrium setup <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                       <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_A <span class="pp">|</span> float             <span class="pp">|</span> Concentration noise for A <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span> - Controls C_A fluctuations - Typical: 0.001-0.1 - Should be &lt;&lt; C_A0 for realistic noise                     <span class="pp">|</span> <span class="in">`0.01`</span>     <span class="pp">|</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_B <span class="pp">|</span> float             <span class="pp">|</span> Concentration noise for B <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span> - Controls C_B fluctuations - Typical: 0.001-0.1                                                             <span class="pp">|</span> <span class="in">`0.01`</span>     <span class="pp">|</span></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_T <span class="pp">|</span> float             <span class="pp">|</span> Temperature noise <span class="co">[</span><span class="ot">K/√s</span><span class="co">]</span> - Controls T fluctuations - Typical: 0.1-5.0 - More critical than concentration noise   (exponential effect via Arrhenius) <span class="pp">|</span> <span class="in">`1.0`</span>      <span class="pp">|</span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Applications {.doc-section .doc-section-applications}</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>**1. Robust Optimal Control:**</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>Design controllers accounting for uncertainty:</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Stochastic MPC with chance constraints</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Risk-sensitive control</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Robust trajectory optimization</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>**2. State Estimation:**</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>Kalman filter for noisy measurements:</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Extended Kalman Filter (EKF)</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Unscented Kalman Filter (UKF)</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Particle filter</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>**3. Risk Analysis:**</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>Assess probability of constraint violation:</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Monte Carlo simulation</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Rare event estimation</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Safety verification</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>**4. Parameter Identification:**</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>Estimate parameters from noisy data:</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Maximum likelihood</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Bayesian inference</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Sequential Monte Carlo</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>**5. Process Design:**</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>Design for robustness:</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Worst-case analysis</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Six Sigma methodology</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Process capability studies</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Numerical Simulation {.doc-section .doc-section-numerical-simulation}</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>**Recommended Methods:**</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Euler-Maruyama: Simple, robust, dt ~ 0.01-0.1 s</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Milstein: Higher order, dt ~ 0.001-0.01 s</span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SRK: Even higher order, more cost</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>**Monte Carlo Ensemble:**</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>Run N = 100-10,000 simulations to characterize:</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Mean trajectory: E<span class="co">[</span><span class="ot">X(t)</span><span class="co">]</span></span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Variance: Var<span class="co">[</span><span class="ot">X(t)</span><span class="co">]</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Confidence bands: μ ± 2σ</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Probability distributions</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>**Noise Structure:**</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Type: ADDITIVE (state-independent)</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dimension: nw = 3 (three Wiener processes)</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Correlation: DIAGONAL (independent noise sources)</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison with Deterministic {.doc-section .doc-section-comparison-with-deterministic}</span></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>**Deterministic:**</span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Single trajectory</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perfect prediction</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Nominal design</span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>**Stochastic:**</span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ensemble of trajectories</span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Probabilistic prediction</span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust design</span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>**When Stochastic is Necessary:**</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Real process has significant noise</span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust control needed</span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Risk assessment required</span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parameter uncertainty significant</span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a><span class="fu">## Limitations {.doc-section .doc-section-limitations}</span></span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Additive noise only (not multiplicative)</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Constant noise intensity (not state-dependent)</span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Independent noise sources (no correlation)</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No jumps (only continuous Brownian paths)</span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Extensions {.doc-section .doc-section-extensions}</span></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiplicative noise: g(x) = diag(σ_A·C_A, σ_B·C_B, σ_T·T)</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Correlated noise: Full covariance matrix</span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Jump diffusion: Add Poisson jumps</span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parameter uncertainty: Random walk parameters</span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a><span class="fu">## See Also {.doc-section .doc-section-see-also}</span></span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>ContinuousBatchReactor : Deterministic version</span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>OrnsteinUhlenbeck : Mean-reverting stochastic process</span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>GeometricBrownianMotion : Multiplicative noise example</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name <span class="pp">|</span> Description <span class="pp">|</span></span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a><span class="pp">| ---</span> <span class="pp">| ---</span> <span class="pp">|</span></span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">compute_signal_to_noise_ratio</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio)</span> <span class="pp">|</span> Compute signal-to-noise ratio for each state. <span class="pp">|</span></span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">define_system</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system)</span> <span class="pp">|</span> Define stochastic batch reactor dynamics. <span class="pp">|</span></span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">estimate_variance_growth</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth)</span> <span class="pp">|</span> Estimate variance growth for additive noise (approximate). <span class="pp">|</span></span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">get_noise_intensities</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities)</span> <span class="pp">|</span> Get current noise intensity parameters. <span class="pp">|</span></span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">setup_equilibria</span><span class="co">](#cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria)</span> <span class="pp">|</span> Set up equilibrium points. <span class="pp">|</span></span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a><span class="fu">### compute_signal_to_noise_ratio { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio }</span></span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.compute_signal_to_noise_ratio(</span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a>Compute signal-to-noise ratio for each state.</span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a>SNR = |x| / (σ·√t)</span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a>Higher SNR → noise less significant.</span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type       <span class="pp">|</span> Description                 <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------------|-----------------------------|------------|</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> x      <span class="pp">|</span> np.ndarray <span class="pp">|</span> Current state <span class="co">[</span><span class="ot">C_A, C_B, T</span><span class="co">]</span> <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> t      <span class="pp">|</span> float      <span class="pp">|</span> Time since start <span class="co">[</span><span class="ot">s</span><span class="co">]</span>        <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type       <span class="pp">|</span> Description           <span class="pp">|</span></span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------------|-----------------------|</span></span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> np.ndarray <span class="pp">|</span> SNR for <span class="co">[</span><span class="ot">C_A, C_B, T</span><span class="co">]</span> <span class="pp">|</span></span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>SNR &gt; 10: Noise negligible</span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a>SNR ~ 1: Noise significant</span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>SNR &lt; 0.1: Noise dominates</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> reactor <span class="op">=</span> ContinuousStochasticBatchReactor()</span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> x <span class="op">=</span> np.array([<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">360.0</span>])</span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> snr <span class="op">=</span> reactor.compute_signal_to_noise_ratio(x, t<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"SNR: C_A=</span><span class="sc">{</span>snr[<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss">, C_B=</span><span class="sc">{</span>snr[<span class="dv">1</span>]<span class="sc">:.1f}</span><span class="ss">, T=</span><span class="sc">{</span>snr[<span class="dv">2</span>]<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a><span class="fu">### define_system { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system }</span></span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.define_system(</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>    k1_val<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a>    k2_val<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a>    E1_val<span class="op">=</span><span class="fl">1000.0</span>,</span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a>    E2_val<span class="op">=</span><span class="fl">1500.0</span>,</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a>    alpha_val<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a>    T_amb_val<span class="op">=</span><span class="fl">300.0</span>,</span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a>    sigma_A<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>    sigma_B<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a>    sigma_T<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a>    C_A0<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a>    T0<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a>Define stochastic batch reactor dynamics.</span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name      <span class="pp">|</span> Type              <span class="pp">|</span> Description                                                                                                                                                              <span class="pp">|</span> Default   <span class="pp">|</span></span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|-------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|</span></span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k1_val    <span class="pp">|</span> float             <span class="pp">|</span> Pre-exponential factor for A→B reaction <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                                            <span class="pp">|</span> <span class="in">`0.5`</span>     <span class="pp">|</span></span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> k2_val    <span class="pp">|</span> float             <span class="pp">|</span> Pre-exponential factor for B→C reaction <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                                            <span class="pp">|</span> <span class="in">`0.3`</span>     <span class="pp">|</span></span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E1_val    <span class="pp">|</span> float             <span class="pp">|</span> Activation energy for reaction 1 <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                                     <span class="pp">|</span> <span class="in">`1000.0`</span>  <span class="pp">|</span></span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> E2_val    <span class="pp">|</span> float             <span class="pp">|</span> Activation energy for reaction 2 <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                                     <span class="pp">|</span> <span class="in">`1500.0`</span>  <span class="pp">|</span></span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> alpha_val <span class="pp">|</span> float             <span class="pp">|</span> Heat transfer coefficient <span class="co">[</span><span class="ot">1/s</span><span class="co">]</span>                                                                                                                                          <span class="pp">|</span> <span class="in">`0.1`</span>     <span class="pp">|</span></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T_amb_val <span class="pp">|</span> float             <span class="pp">|</span> Ambient temperature <span class="co">[</span><span class="ot">K</span><span class="co">]</span>                                                                                                                                                  <span class="pp">|</span> <span class="in">`300.0`</span>   <span class="pp">|</span></span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_A   <span class="pp">|</span> float             <span class="pp">|</span> Concentration noise intensity for A <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span> - Typical: 0.001-0.1 mol/(L·√s) - Should be &lt;&lt; C_A0 for realistic noise - Rule of thumb: σ_A ~ 0.01·C_A0                <span class="pp">|</span> <span class="in">`0.01`</span>    <span class="pp">|</span></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_B   <span class="pp">|</span> float             <span class="pp">|</span> Concentration noise intensity for B <span class="co">[</span><span class="ot">mol/(L·√s)</span><span class="co">]</span> - Same magnitude as σ_A typically - Represents mixing and kinetic uncertainty                                           <span class="pp">|</span> <span class="in">`0.01`</span>    <span class="pp">|</span></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> sigma_T   <span class="pp">|</span> float             <span class="pp">|</span> Temperature noise intensity <span class="co">[</span><span class="ot">K/√s</span><span class="co">]</span> - Typical: 0.1-5.0 K/√s - More critical than concentration noise - Affects reaction rates exponentially - Rule of thumb: σ_T ~ 1 K/√s <span class="pp">|</span> <span class="in">`1.0`</span>     <span class="pp">|</span></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> C_A0      <span class="pp">|</span> Optional<span class="sc">\[</span>float<span class="sc">\]</span> <span class="pp">|</span> Initial conditions for equilibrium setup                                                                                                                                 <span class="pp">|</span> <span class="in">`None`</span>    <span class="pp">|</span></span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> T0        <span class="pp">|</span> Optional<span class="sc">\[</span>float<span class="sc">\]</span> <span class="pp">|</span> Initial conditions for equilibrium setup                                                                                                                                 <span class="pp">|</span> <span class="in">`None`</span>    <span class="pp">|</span></span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>**Drift (Deterministic Part):**</span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a>Identical to deterministic reactor:</span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>    f(x, u) = <span class="co">[</span><span class="ot">-r₁, r₁ - r₂, Q - α·(T - T_amb)</span><span class="co">]</span>ᵀ</span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>**Diffusion (Stochastic Part):**</span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a>Diagonal matrix (additive, independent noise):</span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>    g(x, u) = diag(σ_A, σ_B, σ_T)</span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a>This gives three independent Wiener processes driving</span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>concentration and temperature fluctuations.</span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>**Noise Intensity Guidelines:**</span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>For 1% relative noise at C_A0 = 1.0 mol/L over 1 second:</span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a>    σ_A ~ 0.01 mol/(L·√s)</span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>For 1 K standard deviation over 1 second:</span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a>    σ_T ~ 1.0 K/√s</span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a>**Physical Justification:**</span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a>Additive noise models:</span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>External disturbances (feed, ambient)</span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Measurement errors (sensors)</span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Control system imperfections</span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unmodeled dynamics (lumped effects)</span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a>Alternative: Multiplicative noise would be:</span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a>    g(x) = diag(σ_A·C_A, σ_B·C_B, σ_T·T)</span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>This models relative errors scaling with state magnitude.</span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>**Validation:**</span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>Check noise levels are reasonable:</span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Run deterministic + stochastic simulations</span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Compare final states</span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Coefficient of variation should be 5-20%:</span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a>       CV = std(C_B_final) / mean(C_B_final)</span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>If CV &gt; 30%: Noise too large</span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>If CV &lt; 1%: Noise negligible</span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### estimate_variance_growth { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth }</span></span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.estimate_variance_growth(</span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>    t,</span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>Estimate variance growth for additive noise (approximate).</span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a>For additive noise with independent sources:</span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>    Var<span class="co">[</span><span class="ot">X(t)</span><span class="co">]</span> ≈ Var<span class="co">[</span><span class="ot">X(0)</span><span class="co">]</span> + diag(σ²)·t</span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>This is exact for linear systems, approximate for nonlinear.</span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameters {.doc-section .doc-section-parameters}</span></span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description   <span class="pp">|</span> Default    <span class="pp">|</span></span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|---------------|------------|</span></span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> t      <span class="pp">|</span> float  <span class="pp">|</span> Time <span class="co">[</span><span class="ot">s</span><span class="co">]</span>      <span class="pp">|</span> _required_ <span class="pp">|</span></span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type       <span class="pp">|</span> Description                                     <span class="pp">|</span></span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------------|-------------------------------------------------|</span></span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> np.ndarray <span class="pp">|</span> Estimated variance <span class="co">[</span><span class="ot">Var(C_A), Var(C_B), Var(T)</span><span class="co">]</span> <span class="pp">|</span></span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notes {.doc-section .doc-section-notes}</span></span>
<span id="cb12-356"><a href="#cb12-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-357"><a href="#cb12-357" aria-hidden="true" tabindex="-1"></a>This is a rough estimate. For accurate statistics, run Monte Carlo.</span>
<span id="cb12-358"><a href="#cb12-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-359"><a href="#cb12-359" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb12-360"><a href="#cb12-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-361"><a href="#cb12-361" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-362"><a href="#cb12-362" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> reactor <span class="op">=</span> ContinuousStochasticBatchReactor(</span>
<span id="cb12-363"><a href="#cb12-363" aria-hidden="true" tabindex="-1"></a>...     sigma_A<span class="op">=</span><span class="fl">0.01</span>, sigma_B<span class="op">=</span><span class="fl">0.01</span>, sigma_T<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb12-364"><a href="#cb12-364" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb12-365"><a href="#cb12-365" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> var_100s <span class="op">=</span> reactor.estimate_variance_growth(t<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb12-366"><a href="#cb12-366" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> std_100s <span class="op">=</span> np.sqrt(var_100s)</span>
<span id="cb12-367"><a href="#cb12-367" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Estimated std after 100s: C_A=</span><span class="sc">{</span>std_100s[<span class="dv">0</span>]<span class="sc">:.3f}</span><span class="ss">, "</span></span>
<span id="cb12-368"><a href="#cb12-368" aria-hidden="true" tabindex="-1"></a>...       <span class="ss">f"C_B=</span><span class="sc">{</span>std_100s[<span class="dv">1</span>]<span class="sc">:.3f}</span><span class="ss">, T=</span><span class="sc">{</span>std_100s[<span class="dv">2</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb12-369"><a href="#cb12-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-370"><a href="#cb12-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-371"><a href="#cb12-371" aria-hidden="true" tabindex="-1"></a><span class="fu">### get_noise_intensities { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities }</span></span>
<span id="cb12-372"><a href="#cb12-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-373"><a href="#cb12-373" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-374"><a href="#cb12-374" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.get_noise_intensities(</span>
<span id="cb12-375"><a href="#cb12-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-376"><a href="#cb12-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-377"><a href="#cb12-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-378"><a href="#cb12-378" aria-hidden="true" tabindex="-1"></a>Get current noise intensity parameters.</span>
<span id="cb12-379"><a href="#cb12-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-380"><a href="#cb12-380" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Returns {.doc-section .doc-section-returns}</span></span>
<span id="cb12-381"><a href="#cb12-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-382"><a href="#cb12-382" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Name   <span class="pp">|</span> Type   <span class="pp">|</span> Description                                          <span class="pp">|</span></span>
<span id="cb12-383"><a href="#cb12-383" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------|------------------------------------------------------|</span></span>
<span id="cb12-384"><a href="#cb12-384" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>        <span class="pp">|</span> dict   <span class="pp">|</span> Dictionary with keys 'sigma_A', 'sigma_B', 'sigma_T' <span class="pp">|</span></span>
<span id="cb12-385"><a href="#cb12-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-386"><a href="#cb12-386" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Examples {.doc-section .doc-section-examples}</span></span>
<span id="cb12-387"><a href="#cb12-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-388"><a href="#cb12-388" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-389"><a href="#cb12-389" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> reactor <span class="op">=</span> ContinuousStochasticBatchReactor(</span>
<span id="cb12-390"><a href="#cb12-390" aria-hidden="true" tabindex="-1"></a>...     sigma_A<span class="op">=</span><span class="fl">0.01</span>, sigma_B<span class="op">=</span><span class="fl">0.01</span>, sigma_T<span class="op">=</span><span class="fl">1.0</span></span>
<span id="cb12-391"><a href="#cb12-391" aria-hidden="true" tabindex="-1"></a>... )</span>
<span id="cb12-392"><a href="#cb12-392" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> noise <span class="op">=</span> reactor.get_noise_intensities()</span>
<span id="cb12-393"><a href="#cb12-393" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="ss">f"Temperature noise: </span><span class="sc">{</span>noise[<span class="st">'sigma_T'</span>]<span class="sc">}</span><span class="ss"> K/√s"</span>)</span>
<span id="cb12-394"><a href="#cb12-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-395"><a href="#cb12-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-396"><a href="#cb12-396" aria-hidden="true" tabindex="-1"></a><span class="fu">### setup_equilibria { #cdesym.systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria }</span></span>
<span id="cb12-397"><a href="#cb12-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-398"><a href="#cb12-398" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb12-399"><a href="#cb12-399" aria-hidden="true" tabindex="-1"></a>systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.setup_equilibria(</span>
<span id="cb12-400"><a href="#cb12-400" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-401"><a href="#cb12-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-402"><a href="#cb12-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-403"><a href="#cb12-403" aria-hidden="true" tabindex="-1"></a>Set up equilibrium points.</span>
<span id="cb12-404"><a href="#cb12-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-405"><a href="#cb12-405" aria-hidden="true" tabindex="-1"></a>Note: For stochastic systems, "equilibrium" refers to deterministic</span>
<span id="cb12-406"><a href="#cb12-406" aria-hidden="true" tabindex="-1"></a>part only. Actual trajectories fluctuate around this point.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/api/systems.builtin.stochastic.continuous.ContinuousStochasticBatchReactor.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>