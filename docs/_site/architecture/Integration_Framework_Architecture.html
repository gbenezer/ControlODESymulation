<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gil Benezer">
<meta name="dcterms.date" content="2026-01-08">

<title>Integration Framework Architecture – ControlDESymulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a3223af6d9a06cb5fa59671b90af6e33.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ControlDESymulation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../tutorials/installation.html" aria-current="page"> 
<span class="menu-text">Installation Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-architecture" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Architecture</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-architecture">    
        <li>
    <a class="dropdown-item" href="../architecture/index.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../architecture/cdesym_Design_Philosophy.html">
 <span class="dropdown-text">ControlDESymulation: Design Philosophy and Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/UI_Framework_Architecture.html">
 <span class="dropdown-text">UI Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Type_System_Architecture.html">
 <span class="dropdown-text">Type System Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Integration_Framework_Architecture.html">
 <span class="dropdown-text">Integration Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Control_Framework_Architecture.html">
 <span class="dropdown-text">Control Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Visualization_Framework_Architecture.html">
 <span class="dropdown-text">Visualization Framework Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../architecture/Delegation_Layer_Architecture.html">
 <span class="dropdown-text">Delegation Layer Architecture</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../tutorials/basic_usage.html">
 <span class="dropdown-text">Basic Usage</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li class="dropdown-header">examples/pendulum_control.qmd</li>
        <li class="dropdown-header">examples/cartpole_swingup.qmd</li>
        <li class="dropdown-header">examples/quadrotor_lqr.qmd</li>
        <li class="dropdown-header">examples/cstr_multiplicity.qmd</li>
        <li class="dropdown-header">examples/lorenz_chaos.qmd</li>
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../api/index.html"> 
<span class="menu-text">API Reference</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gilbenezer/ControlDESymulation"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../architecture/index.html">Framework Design</a></li><li class="breadcrumb-item"><a href="../architecture/Integration_Framework_Architecture.html">Integration Framework Architecture</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Installation Guide</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation Guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Framework Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/cdesym_Design_Philosophy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ControlDESymulation: Design Philosophy and Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/UI_Framework_Architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UI Framework Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/Type_System_Architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Type System Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/Integration_Framework_Architecture.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Integration Framework Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/Control_Framework_Architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Framework Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/Visualization_Framework_Architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization Framework Architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../architecture/Delegation_Layer_Architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Delegation Layer Architecture</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-overview" id="toc-sec-overview" class="nav-link active" data-scroll-target="#sec-overview">Overview</a></li>
  <li><a href="#sec-architecture" id="toc-sec-architecture" class="nav-link" data-scroll-target="#sec-architecture">Architecture Overview</a></li>
  <li><a href="#sec-method-registry" id="toc-sec-method-registry" class="nav-link" data-scroll-target="#sec-method-registry">Method Registry: Centralized Method Management</a>
  <ul>
  <li><a href="#design-philosophy" id="toc-design-philosophy" class="nav-link" data-scroll-target="#design-philosophy">Design Philosophy</a></li>
  <li><a href="#core-functions" id="toc-core-functions" class="nav-link" data-scroll-target="#core-functions">Core Functions</a></li>
  <li><a href="#method-classification" id="toc-method-classification" class="nav-link" data-scroll-target="#method-classification">Method Classification</a></li>
  <li><a href="#normalization-map" id="toc-normalization-map" class="nav-link" data-scroll-target="#normalization-map">Normalization Map</a></li>
  <li><a href="#usage-in-factories" id="toc-usage-in-factories" class="nav-link" data-scroll-target="#usage-in-factories">Usage in Factories</a></li>
  </ul></li>
  <li><a href="#sec-track-1" id="toc-sec-track-1" class="nav-link" data-scroll-target="#sec-track-1">Track 1: Deterministic ODE Integration</a>
  <ul>
  <li><a href="#sec-integratorbase" id="toc-sec-integratorbase" class="nav-link" data-scroll-target="#sec-integratorbase">IntegratorBase: Abstract Interface</a></li>
  <li><a href="#sec-integratorfactory" id="toc-sec-integratorfactory" class="nav-link" data-scroll-target="#sec-integratorfactory">IntegratorFactory: Smart Creation</a></li>
  <li><a href="#sec-scipyintegrator" id="toc-sec-scipyintegrator" class="nav-link" data-scroll-target="#sec-scipyintegrator">ScipyIntegrator: Adaptive NumPy Integration</a></li>
  <li><a href="#sec-torchdiffeqintegrator" id="toc-sec-torchdiffeqintegrator" class="nav-link" data-scroll-target="#sec-torchdiffeqintegrator">TorchDiffEqIntegrator: GPU-Accelerated PyTorch</a></li>
  <li><a href="#sec-diffraxintegrator" id="toc-sec-diffraxintegrator" class="nav-link" data-scroll-target="#sec-diffraxintegrator">DiffraxIntegrator: JAX with XLA Compilation</a></li>
  <li><a href="#sec-diffeqpyintegrator" id="toc-sec-diffeqpyintegrator" class="nav-link" data-scroll-target="#sec-diffeqpyintegrator">DiffEqPyIntegrator: Julia’s Solver Ecosystem</a></li>
  <li><a href="#sec-fixedstepintegrators" id="toc-sec-fixedstepintegrators" class="nav-link" data-scroll-target="#sec-fixedstepintegrators">FixedStepIntegrators: Educational and Simple Systems</a></li>
  </ul></li>
  <li><a href="#sec-track-2" id="toc-sec-track-2" class="nav-link" data-scroll-target="#sec-track-2">Track 2: Stochastic SDE Integration</a>
  <ul>
  <li><a href="#sec-sdeintegratorbase" id="toc-sec-sdeintegratorbase" class="nav-link" data-scroll-target="#sec-sdeintegratorbase">SDEIntegratorBase: Stochastic Abstract Interface</a></li>
  <li><a href="#sec-sdeintegratorfactory" id="toc-sec-sdeintegratorfactory" class="nav-link" data-scroll-target="#sec-sdeintegratorfactory">SDEIntegratorFactory: SDE-Specific Creation</a></li>
  <li><a href="#sec-torchsdeintegrator" id="toc-sec-torchsdeintegrator" class="nav-link" data-scroll-target="#sec-torchsdeintegrator">TorchSDEIntegrator: PyTorch SDE Integration</a></li>
  <li><a href="#sec-diffraxsdeintegrator" id="toc-sec-diffraxsdeintegrator" class="nav-link" data-scroll-target="#sec-diffraxsdeintegrator">DiffraxSDEIntegrator: JAX SDE Integration</a></li>
  <li><a href="#sec-diffeqpysdeintegrator" id="toc-sec-diffeqpysdeintegrator" class="nav-link" data-scroll-target="#sec-diffeqpysdeintegrator">DiffEqPySDEIntegrator: Julia SDE Integration</a></li>
  <li><a href="#sec-custombrownianpath" id="toc-sec-custombrownianpath" class="nav-link" data-scroll-target="#sec-custombrownianpath">CustomBrownianPath: Deterministic Noise for Testing</a></li>
  </ul></li>
  <li><a href="#sec-result-types" id="toc-sec-result-types" class="nav-link" data-scroll-target="#sec-result-types">Integration Result Types</a>
  <ul>
  <li><a href="#sec-integrationresult" id="toc-sec-integrationresult" class="nav-link" data-scroll-target="#sec-integrationresult">IntegrationResult (Deterministic ODEs)</a></li>
  <li><a href="#sec-sdeintegrationresult" id="toc-sec-sdeintegrationresult" class="nav-link" data-scroll-target="#sec-sdeintegrationresult">SDEIntegrationResult (Stochastic SDEs)</a></li>
  </ul></li>
  <li><a href="#sec-usage-examples" id="toc-sec-usage-examples" class="nav-link" data-scroll-target="#sec-usage-examples">Practical Usage Examples</a>
  <ul>
  <li><a href="#example-1-recommended-high-level-interface" id="toc-example-1-recommended-high-level-interface" class="nav-link" data-scroll-target="#example-1-recommended-high-level-interface">Example 1: Recommended High-Level Interface</a></li>
  <li><a href="#example-2-advanced---direct-integrator-access" id="toc-example-2-advanced---direct-integrator-access" class="nav-link" data-scroll-target="#example-2-advanced---direct-integrator-access">Example 2: Advanced - Direct Integrator Access</a></li>
  <li><a href="#example-3-high-accuracy-julia-integration" id="toc-example-3-high-accuracy-julia-integration" class="nav-link" data-scroll-target="#example-3-high-accuracy-julia-integration">Example 3: High-Accuracy Julia Integration</a></li>
  <li><a href="#example-4-gpu-accelerated-neural-ode" id="toc-example-4-gpu-accelerated-neural-ode" class="nav-link" data-scroll-target="#example-4-gpu-accelerated-neural-ode">Example 4: GPU-Accelerated Neural ODE</a></li>
  <li><a href="#example-5-stochastic-simulation-with-monte-carlo" id="toc-example-5-stochastic-simulation-with-monte-carlo" class="nav-link" data-scroll-target="#example-5-stochastic-simulation-with-monte-carlo">Example 5: Stochastic Simulation with Monte Carlo</a></li>
  <li><a href="#example-6-deterministic-testing-with-custom-noise" id="toc-example-6-deterministic-testing-with-custom-noise" class="nav-link" data-scroll-target="#example-6-deterministic-testing-with-custom-noise">Example 6: Deterministic Testing with Custom Noise</a></li>
  </ul></li>
  <li><a href="#sec-selection-guide" id="toc-sec-selection-guide" class="nav-link" data-scroll-target="#sec-selection-guide">Integrator Selection Guide</a>
  <ul>
  <li><a href="#by-use-case" id="toc-by-use-case" class="nav-link" data-scroll-target="#by-use-case">By Use Case</a></li>
  <li><a href="#by-backend-capabilities" id="toc-by-backend-capabilities" class="nav-link" data-scroll-target="#by-backend-capabilities">By Backend Capabilities</a></li>
  <li><a href="#by-system-properties" id="toc-by-system-properties" class="nav-link" data-scroll-target="#by-system-properties">By System Properties</a></li>
  </ul></li>
  <li><a href="#sec-design-principles" id="toc-sec-design-principles" class="nav-link" data-scroll-target="#sec-design-principles">Design Principles</a>
  <ul>
  <li><a href="#backend-abstraction" id="toc-backend-abstraction" class="nav-link" data-scroll-target="#backend-abstraction">Backend Abstraction</a></li>
  <li><a href="#factory-pattern-for-complexity-management" id="toc-factory-pattern-for-complexity-management" class="nav-link" data-scroll-target="#factory-pattern-for-complexity-management">Factory Pattern for Complexity Management</a></li>
  <li><a href="#unified-result-types" id="toc-unified-result-types" class="nav-link" data-scroll-target="#unified-result-types">Unified Result Types</a></li>
  <li><a href="#composition-over-inheritance" id="toc-composition-over-inheritance" class="nav-link" data-scroll-target="#composition-over-inheritance">Composition Over Inheritance</a></li>
  <li><a href="#built-in-performance-tracking" id="toc-built-in-performance-tracking" class="nav-link" data-scroll-target="#built-in-performance-tracking">Built-in Performance Tracking</a></li>
  </ul></li>
  <li><a href="#sec-strengths" id="toc-sec-strengths" class="nav-link" data-scroll-target="#sec-strengths">Key Strengths</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/architecture/Integration_Framework_Architecture.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../architecture/index.html">Framework Design</a></li><li class="breadcrumb-item"><a href="../architecture/Integration_Framework_Architecture.html">Integration Framework Architecture</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Integration Framework Architecture</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Multi-Backend Integration for ODEs and SDEs</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gil Benezer </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 8, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="sec-overview" class="level2">
<h2 class="anchored" data-anchor-id="sec-overview">Overview</h2>
<p>The ControlDESymulation numerical integration framework provides <strong>multi-backend</strong>, <strong>multi-method</strong> support for integrating both <strong>deterministic ordinary differential equations (ODEs)</strong> and <strong>stochastic differential equations (SDEs)</strong>. The framework consists of 14 core files organized into a clean two-track architecture with a shared method registry.</p>
<p><strong>Key capabilities:</strong></p>
<ul>
<li><strong>Backend agnostic</strong>: Seamless switching between NumPy, PyTorch, and JAX</li>
<li><strong>40+ integration methods</strong>: From simple Euler to high-order adaptive schemes</li>
<li><strong>Stochastic support</strong>: Full SDE integration with noise structure exploitation</li>
<li><strong>Factory pattern</strong>: Automatic method selection based on system properties</li>
<li><strong>Production ready</strong>: Professional-grade error control and performance tracking</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>User Interface
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Most users should NOT directly instantiate integrators or factories.</strong> Instead, use the high-level system interface:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended: Use system.integrate() - delegates to appropriate integrator</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    x0<span class="op">=</span>np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>]),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'RK45'</span>,  <span class="co"># Optional: framework selects automatically</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced: Direct integrator access (only when needed for fine control)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.auto(system)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The system’s <code>integrate()</code> method automatically handles backend selection, method routing, and integrator lifecycle. Direct integrator instantiation is only needed for advanced use cases requiring explicit integrator reuse or fine-grained control.</p>
</div>
</div>
</section>
<section id="sec-architecture" class="level2">
<h2 class="anchored" data-anchor-id="sec-architecture">Architecture Overview</h2>
<p>The framework follows a dual-track design separating deterministic and stochastic integration, with a shared <strong>method registry</strong> providing centralized method management:</p>
<pre><code>Shared Infrastructure
├── MethodRegistry (centralized method normalization and validation)
│   ├── normalize_method_name() - cross-backend name mapping
│   ├── validate_method() - backend/system compatibility
│   ├── is_sde_method() / is_fixed_step() - classification
│   └── get_available_methods() - method discovery
│
Track 1: Deterministic ODE Integration
├── IntegratorBase (abstract interface)
├── IntegratorFactory (method selection via registry)
├── Backend-Specific Implementations:
│   ├── ScipyIntegrator (NumPy/SciPy)
│   ├── TorchDiffEqIntegrator (PyTorch with GPU)
│   ├── DiffraxIntegrator (JAX with XLA)
│   └── DiffEqPyIntegrator (Julia via Python)
└── FixedStepIntegrators (Euler, Heun, Midpoint, RK4)

Track 2: Stochastic SDE Integration
├── SDEIntegratorBase (extends IntegratorBase)
├── SDEIntegratorFactory (SDE-specific creation via registry)
├── Backend-Specific Implementations:
│   ├── TorchSDEIntegrator (PyTorch SDEs)
│   ├── DiffraxSDEIntegrator (JAX SDEs)
│   └── DiffEqPySDEIntegrator (Julia SDEs)
└── CustomBrownianPath (deterministic noise for testing)</code></pre>
</section>
<section id="sec-method-registry" class="level2">
<h2 class="anchored" data-anchor-id="sec-method-registry">Method Registry: Centralized Method Management</h2>
<p><strong>File:</strong> <code>method_registry.py</code></p>
<p>The <code>method_registry</code> module serves as the <strong>single source of truth</strong> for all integration methods across backends. It provides centralized method normalization, validation, and classification for both ODE and SDE integrators.</p>
<section id="design-philosophy" class="level3">
<h3 class="anchored" data-anchor-id="design-philosophy">Design Philosophy</h3>
<p><strong>Backend Naming Conventions:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 38%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Backend</th>
<th>Convention</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NumPy/Julia (DiffEqPy)</td>
<td>Capitalized</td>
<td><code>EM</code>, <code>Tsit5</code>, <code>SRIW1</code></td>
</tr>
<tr class="even">
<td>PyTorch (TorchSDE/TorchDiffEq)</td>
<td>lowercase</td>
<td><code>euler</code>, <code>dopri5</code>, <code>milstein</code></td>
</tr>
<tr class="odd">
<td>JAX (Diffrax)</td>
<td>PascalCase</td>
<td><code>Euler</code>, <code>ItoMilstein</code>, <code>Tsit5</code></td>
</tr>
</tbody>
</table>
<p><strong>Canonical Names:</strong></p>
<p>User-friendly aliases that work across all backends (e.g., <code>euler_maruyama</code>, <code>milstein</code>, <code>rk45</code>). These are automatically normalized to backend-specific names.</p>
</section>
<section id="core-functions" class="level3">
<h3 class="anchored" data-anchor-id="core-functions">Core Functions</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.method_registry <span class="im">import</span> (</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    normalize_method_name,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    validate_method,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    is_sde_method,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    is_fixed_step,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    get_available_methods,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    get_method_info,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize canonical names to backend-specific</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>normalize_method_name(<span class="st">'euler_maruyama'</span>, <span class="st">'numpy'</span>)  <span class="co"># → 'EM'</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>normalize_method_name(<span class="st">'euler_maruyama'</span>, <span class="st">'torch'</span>)  <span class="co"># → 'euler'</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>normalize_method_name(<span class="st">'euler_maruyama'</span>, <span class="st">'jax'</span>)    <span class="co"># → 'Euler'</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate method/backend/system compatibility</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(<span class="st">'euler_maruyama'</span>, <span class="st">'torch'</span>, is_stochastic<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify methods</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>is_sde_method(<span class="st">'euler_maruyama'</span>)  <span class="co"># → True</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>is_sde_method(<span class="st">'rk4'</span>)              <span class="co"># → False</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>is_fixed_step(<span class="st">'rk4'</span>)              <span class="co"># → True</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>is_fixed_step(<span class="st">'RK45'</span>)             <span class="co"># → False (adaptive)</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Discover available methods</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> get_available_methods(<span class="st">'torch'</span>, method_type<span class="op">=</span><span class="st">'stochastic'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="method-classification" class="level3">
<h3 class="anchored" data-anchor-id="method-classification">Method Classification</h3>
<p>Methods are classified along two dimensions:</p>
<ol type="1">
<li><strong>System type</strong>: Deterministic (ODE) vs Stochastic (SDE)</li>
<li><strong>Time stepping</strong>: Fixed-step vs Adaptive</li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Category</th>
<th>Examples</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>DETERMINISTIC_FIXED_STEP</code></td>
<td><code>euler</code>, <code>heun</code>, <code>midpoint</code>, <code>rk4</code></td>
<td>Manual implementations</td>
</tr>
<tr class="even">
<td><code>DETERMINISTIC_ADAPTIVE</code></td>
<td><code>RK45</code>, <code>LSODA</code>, <code>dopri5</code>, <code>tsit5</code></td>
<td>Production ODE solvers</td>
</tr>
<tr class="odd">
<td><code>SDE_FIXED_STEP</code></td>
<td><code>EM</code>, <code>euler</code>, <code>milstein</code>, <code>SRIW1</code></td>
<td>Most SDE methods</td>
</tr>
<tr class="even">
<td><code>SDE_ADAPTIVE</code></td>
<td><code>LambaEM</code>, <code>AutoEM</code>, <code>adaptive_heun</code></td>
<td>Rare adaptive SDE</td>
</tr>
</tbody>
</table>
</section>
<section id="normalization-map" class="level3">
<h3 class="anchored" data-anchor-id="normalization-map">Normalization Map</h3>
<p>The registry maintains a comprehensive map for cross-backend method translation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>NORMALIZATION_MAP <span class="op">=</span> {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SDE Methods</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'euler_maruyama'</span>: {<span class="st">'numpy'</span>: <span class="st">'EM'</span>, <span class="st">'torch'</span>: <span class="st">'euler'</span>, <span class="st">'jax'</span>: <span class="st">'Euler'</span>},</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'milstein'</span>: {<span class="st">'numpy'</span>: <span class="st">'RKMil'</span>, <span class="st">'torch'</span>: <span class="st">'milstein'</span>, <span class="st">'jax'</span>: <span class="st">'ItoMilstein'</span>},</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sra1'</span>: {<span class="st">'numpy'</span>: <span class="st">'SRA1'</span>, <span class="st">'torch'</span>: <span class="st">'srk'</span>, <span class="st">'jax'</span>: <span class="st">'SRA1'</span>},</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ODE Methods</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rk45'</span>: {<span class="st">'numpy'</span>: <span class="st">'RK45'</span>, <span class="st">'torch'</span>: <span class="st">'dopri5'</span>, <span class="st">'jax'</span>: <span class="st">'tsit5'</span>},</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dopri5'</span>: {<span class="st">'numpy'</span>: <span class="st">'RK45'</span>, <span class="st">'torch'</span>: <span class="st">'dopri5'</span>, <span class="st">'jax'</span>: <span class="st">'dopri5'</span>},</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tsit5'</span>: {<span class="st">'numpy'</span>: <span class="st">'Tsit5'</span>, <span class="st">'torch'</span>: <span class="st">'dopri5'</span>, <span class="st">'jax'</span>: <span class="st">'tsit5'</span>},</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... more mappings</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="usage-in-factories" class="level3">
<h3 class="anchored" data-anchor-id="usage-in-factories">Usage in Factories</h3>
<p>Both <code>IntegratorFactory</code> and <code>SDEIntegratorFactory</code> use the registry for method handling:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IntegratorFactory.create() internally:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> normalize_method_name(method, backend)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(method, backend, is_stochastic<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_fixed_step(method) <span class="kw">and</span> dt <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Fixed-step method requires dt"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="sec-track-1" class="level2">
<h2 class="anchored" data-anchor-id="sec-track-1">Track 1: Deterministic ODE Integration</h2>
<section id="sec-integratorbase" class="level3">
<h3 class="anchored" data-anchor-id="sec-integratorbase">IntegratorBase: Abstract Interface</h3>
<p><strong>File:</strong> <code>integrator_base.py</code></p>
<p>The <code>IntegratorBase</code> class defines the unified interface that all numerical integrators must implement. This abstraction enables backend-agnostic integration while maintaining consistent behavior across implementations.</p>
<p><strong>Core responsibilities:</strong></p>
<ul>
<li>Define integration contract through abstract methods</li>
<li>Track performance statistics (function evaluations, steps, timing)</li>
<li>Manage integration parameters (time step, tolerances, backend)</li>
<li>Provide consistent result format via <code>IntegrationResult</code> TypedDict</li>
</ul>
<p><strong>Key attributes:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>system: ContinuousSystemBase     <span class="co"># Dynamical system to integrate</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dt: <span class="bu">float</span>                        <span class="co"># Time step (or initial guess for adaptive)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>step_mode: StepMode              <span class="co"># FIXED or ADAPTIVE</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>backend: Backend                 <span class="co"># 'numpy', 'torch', or 'jax'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>rtol: <span class="bu">float</span>                      <span class="co"># Relative error tolerance (adaptive methods)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>atol: <span class="bu">float</span>                      <span class="co"># Absolute error tolerance (adaptive methods)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>_stats: <span class="bu">dict</span>                     <span class="co"># Performance tracking</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Abstract methods required by all implementations:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step(<span class="va">self</span>, x: Array, u: Array, dt: <span class="bu">float</span>) <span class="op">-&gt;</span> Array:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Single integration step: x(t) -&gt; x(t + dt)"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrate(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    x0: Array, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    u_func: Callable, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    t_span: <span class="bu">tuple</span>[<span class="bu">float</span>, <span class="bu">float</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> IntegrationResult:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Multi-step integration over time interval"""</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="at">@property</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> name(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Unique identifier for this integrator"""</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>StepMode enumeration:</strong></p>
<ul>
<li><code>FIXED</code>: Constant time step (euler, rk4, midpoint)</li>
<li><code>ADAPTIVE</code>: Variable time step with error control (RK45, dopri5, tsit5)</li>
</ul>
</section>
<section id="sec-integratorfactory" class="level3">
<h3 class="anchored" data-anchor-id="sec-integratorfactory">IntegratorFactory: Smart Creation</h3>
<p><strong>File:</strong> <code>integrator_factory.py</code></p>
<p>The <code>IntegratorFactory</code> provides intelligent integrator creation with automatic backend and method selection. It encapsulates the complexity of choosing appropriate integration methods based on system properties and use case requirements.</p>
<p><strong>Integration with Method Registry:</strong></p>
<p>The factory delegates method normalization and validation to the centralized <code>method_registry</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Internally, IntegratorFactory.create() does:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> normalize_method_name(method, backend)  <span class="co"># Registry function</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(method, backend, is_stochastic<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_fixed_step(method) <span class="kw">and</span> dt <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Fixed-step method requires dt"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Julia Preference for NumPy Backend:</strong></p>
<p>When using the NumPy backend, <code>IntegratorFactory</code> automatically prefers Julia implementations for basic methods when DiffEqPy is available:</p>
<ul>
<li><code>euler</code> → Julia’s <code>Euler</code> (better performance)</li>
<li><code>heun</code> → Julia’s <code>Heun</code></li>
<li><code>midpoint</code> → Julia’s <code>Midpoint</code></li>
</ul>
<p>To explicitly use manual Python implementations:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.create(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    system, backend<span class="op">=</span><span class="st">'numpy'</span>, method<span class="op">=</span><span class="st">'euler'</span>, prefer_manual<span class="op">=</span><span class="va">True</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Factory methods:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatic selection based on system and backend</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.auto(system, backend<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Production use with auto-stiffness detection</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_production(system, <span class="op">**</span>options)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># High-performance Julia integration</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_julia(system, algorithm<span class="op">=</span><span class="st">'Tsit5'</span>, <span class="op">**</span>options)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Neural ODE training with adjoint gradients</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_neural_ode(system, <span class="op">**</span>options)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># JAX optimization workflows</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_optimization(system, <span class="op">**</span>options)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct method specification</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.create(system, backend, method, <span class="op">**</span>options)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Method registry:</strong></p>
<p>The factory uses the centralized method registry for mapping method names to backends and capabilities:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Backend</th>
<th>Type</th>
<th>Order</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LSODA</td>
<td>NumPy (scipy)</td>
<td>Adaptive</td>
<td>Variable</td>
<td>Automatic stiffness detection</td>
</tr>
<tr class="even">
<td>RK45</td>
<td>NumPy (scipy)</td>
<td>Adaptive</td>
<td>5(4)</td>
<td>General non-stiff ODEs</td>
</tr>
<tr class="odd">
<td>DOP853</td>
<td>NumPy (scipy)</td>
<td>Adaptive</td>
<td>8(5,3)</td>
<td>High-accuracy requirements</td>
</tr>
<tr class="even">
<td>Radau</td>
<td>NumPy (scipy)</td>
<td>Adaptive</td>
<td>5</td>
<td>Stiff systems (implicit)</td>
</tr>
<tr class="odd">
<td>BDF</td>
<td>NumPy (scipy)</td>
<td>Adaptive</td>
<td>Variable</td>
<td>Very stiff systems</td>
</tr>
<tr class="even">
<td>Tsit5</td>
<td>NumPy (Julia)</td>
<td>Adaptive</td>
<td>5(4)</td>
<td>High performance</td>
</tr>
<tr class="odd">
<td>Vern9</td>
<td>NumPy (Julia)</td>
<td>Adaptive</td>
<td>9(8)</td>
<td>Maximum accuracy</td>
</tr>
<tr class="even">
<td>Rodas5</td>
<td>NumPy (Julia)</td>
<td>Adaptive</td>
<td>5(4)</td>
<td>Stiff (Rosenbrock method)</td>
</tr>
<tr class="odd">
<td>dopri5</td>
<td>PyTorch/JAX</td>
<td>Adaptive</td>
<td>5(4)</td>
<td>Neural ODEs, GPU acceleration</td>
</tr>
<tr class="even">
<td>dopri8</td>
<td>PyTorch/JAX</td>
<td>Adaptive</td>
<td>8</td>
<td>High-accuracy neural ODEs</td>
</tr>
<tr class="odd">
<td>tsit5</td>
<td>JAX (diffrax)</td>
<td>Adaptive</td>
<td>5(4)</td>
<td>Optimization, XLA compilation</td>
</tr>
<tr class="even">
<td>euler</td>
<td>Any</td>
<td>Fixed</td>
<td>1</td>
<td>Simple systems, education</td>
</tr>
<tr class="odd">
<td>heun</td>
<td>Any</td>
<td>Fixed</td>
<td>2</td>
<td>Improved Euler, predictor-corrector</td>
</tr>
<tr class="even">
<td>midpoint</td>
<td>Any</td>
<td>Fixed</td>
<td>2</td>
<td>Second-order, midpoint evaluation</td>
</tr>
<tr class="odd">
<td>rk4</td>
<td>Any</td>
<td>Fixed</td>
<td>4</td>
<td>Moderate accuracy, fixed step</td>
</tr>
</tbody>
</table>
</section>
<section id="sec-scipyintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-scipyintegrator">ScipyIntegrator: Adaptive NumPy Integration</h3>
<p><strong>File:</strong> <code>scipy_integrator.py</code></p>
<p>Wraps <code>scipy.integrate.solve_ivp</code> to provide professional-grade adaptive integration with comprehensive error control. This is the recommended starting point for most NumPy-based applications.</p>
<p><strong>Supported methods:</strong></p>
<ul>
<li><strong>RK45</strong> (default): Dormand-Prince 5(4) — general purpose, good balance</li>
<li><strong>RK23</strong>: Bogacki-Shampine 3(2) — fast, lower accuracy</li>
<li><strong>DOP853</strong>: Dormand-Prince 8(5,3) — very high accuracy</li>
<li><strong>Radau</strong>: Implicit Runge-Kutta — stiff systems</li>
<li><strong>BDF</strong>: Backward differentiation formulas — very stiff systems</li>
<li><strong>LSODA</strong>: Automatic stiffness detection — adapts to problem</li>
</ul>
<p><strong>Key features:</strong></p>
<ul>
<li>Professional adaptive time stepping with embedded error estimation</li>
<li>Configurable error tolerances (<code>rtol</code>, <code>atol</code>)</li>
<li>Dense output via continuous extension (interpolation between steps)</li>
<li>Event detection for state-dependent conditions</li>
<li>Support for both controlled and autonomous systems</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-scipy" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.scipy_integrator <span class="im">import</span> ScipyIntegrator</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create system</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create adaptive integrator with tight tolerances</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> ScipyIntegrator(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'RK45'</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-8</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Integrate over time span</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])  <span class="co"># [angle, angular_velocity]</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)  <span class="co"># No control input</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Success: </span><span class="sc">{</span>result[<span class="st">'success'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>result[<span class="st">'nfev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps taken: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>When to use:</strong></p>
<ul>
<li>General-purpose NumPy applications</li>
<li>When you need reliable adaptive stepping</li>
<li>Systems with unknown stiffness (use LSODA)</li>
<li>When dense output is required</li>
</ul>
</section>
<section id="sec-torchdiffeqintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-torchdiffeqintegrator">TorchDiffEqIntegrator: GPU-Accelerated PyTorch</h3>
<p><strong>File:</strong> `torchdiffeq_integrator.py**</p>
<p>Provides PyTorch integration with GPU acceleration and automatic differentiation support. Essential for neural ODE applications and gradient-based optimization.</p>
<p><strong>Supported methods:</strong></p>
<ul>
<li><strong>dopri5</strong>: Dormand-Prince 5(4) — recommended default</li>
<li><strong>dopri8</strong>: Dormand-Prince 8 — high accuracy</li>
<li><strong>adaptive_heun</strong>: Heun’s method — good for moderately stiff</li>
<li><strong>bosh3</strong>: Bogacki-Shampine 3 — fast, lower accuracy</li>
<li><strong>fehlberg2</strong>: Fehlberg 2(1) — very fast, low accuracy</li>
<li><strong>explicit_adams</strong>, <strong>implicit_adams</strong>: Multi-step methods</li>
</ul>
<p><strong>Key features:</strong></p>
<ul>
<li><strong>GPU acceleration</strong>: Automatic CUDA support for large-scale problems</li>
<li><strong>Automatic differentiation</strong>: Seamless gradient computation through dynamics</li>
<li><strong>Adjoint method</strong>: Memory-efficient backpropagation for neural ODEs</li>
<li><strong>Batch processing</strong>: Vectorized integration of multiple trajectories</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-torch" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.torchdiffeq_integrator <span class="im">import</span> TorchDiffEqIntegrator</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create GPU-accelerated integrator</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> TorchDiffEqIntegrator(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'dopri5'</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'torch'</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    device<span class="op">=</span><span class="st">'cpu'</span>,  <span class="co"># Use 'cuda:0' for GPU</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-8</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> torch.tensor([<span class="fl">1.0</span>, <span class="fl">0.0</span>], requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: torch.zeros(<span class="dv">1</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Solver: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Integration time: </span><span class="sc">{</span>result[<span class="st">'integration_time'</span>]<span class="sc">:.4f}</span><span class="ss">s"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>When to use:</strong></p>
<ul>
<li>Neural ODE training</li>
<li>GPU-accelerated simulations</li>
<li>Gradient-based optimization</li>
<li>Large-scale batch processing</li>
</ul>
</section>
<section id="sec-diffraxintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-diffraxintegrator">DiffraxIntegrator: JAX with XLA Compilation</h3>
<p><strong>File:</strong> <code>diffrax_integrator.py</code></p>
<p>Leverages JAX’s diffrax library for high-performance integration with XLA compilation. Ideal for optimization workflows requiring extensive JIT compilation and functional transformations.</p>
<p><strong>Supported methods:</strong></p>
<ul>
<li><strong>tsit5</strong>: Tsitouras 5(4) — recommended, efficient</li>
<li><strong>dopri5</strong>: Dormand-Prince 5(4) — standard reference</li>
<li><strong>dopri8</strong>: Dormand-Prince 8 — high accuracy</li>
<li><strong>heun</strong>: Heun’s method — simple, robust</li>
<li><strong>ralston</strong>: Ralston’s method — improved stability</li>
<li><strong>reversible_heun</strong>: Time-reversible integration</li>
</ul>
<p><strong>Key features:</strong></p>
<ul>
<li><strong>XLA compilation</strong>: Near-C++ performance via just-in-time compilation</li>
<li><strong>JAX transformations</strong>: <code>jit</code>, <code>vmap</code>, <code>grad</code>, <code>pmap</code> all work seamlessly</li>
<li><strong>Functional style</strong>: Pure functions enable advanced optimizations</li>
<li><strong>Efficient for optimization</strong>: Fast repeated evaluations with parameter sweeps</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-jax" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.diffrax_integrator <span class="im">import</span> DiffraxIntegrator</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create JAX integrator</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffraxIntegrator(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'tsit5'</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'jax'</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-8</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Success: </span><span class="sc">{</span>result[<span class="st">'success'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>When to use:</strong></p>
<ul>
<li>Parameter optimization requiring many integrations</li>
<li>When you need <code>vmap</code> for batch parameter sweeps</li>
<li>Gradient-based control optimization</li>
<li>Maximum computational efficiency</li>
</ul>
</section>
<section id="sec-diffeqpyintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-diffeqpyintegrator">DiffEqPyIntegrator: Julia’s Solver Ecosystem</h3>
<p><strong>File:</strong> <code>diffeqpy_integrator.py</code></p>
<p>Accesses Julia’s extensive DifferentialEquations.jl ecosystem through Python bindings. Provides the most comprehensive method library with production-grade performance.</p>
<p><strong>Supported method families:</strong></p>
<p><strong>Explicit Runge-Kutta:</strong> - Tsit5, Vern6, Vern7, Vern8, Vern9 — variable order adaptive - DP5, DP8 — Dormand-Prince variants</p>
<p><strong>Rosenbrock (implicit for stiff):</strong> - Rosenbrock23, Rosenbrock32, Rodas4, Rodas5</p>
<p><strong>BDF methods:</strong> - TRBDF2, KenCarp3, KenCarp4, KenCarp5</p>
<p><strong>Specialized:</strong> - RadauIIA5 — implicit Runge-Kutta - ROCK2, ROCK4 — stabilized methods - VelocityVerlet, SymplecticEuler — symplectic integrators</p>
<p><strong>Auto-switching (composite):</strong> - AutoTsit5(Rosenbrock23()) — switches based on stiffness - AutoVern7(Rodas5()) — high accuracy with stiffness handling</p>
<p><strong>Key features:</strong></p>
<ul>
<li><strong>Highest performance</strong>: Often 2-10× faster than SciPy</li>
<li><strong>Automatic stiffness detection</strong>: Seamlessly switches solvers</li>
<li><strong>Extensive method library</strong>: 100+ algorithms available</li>
<li><strong>Production reliability</strong>: Battle-tested in scientific computing</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-julia" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.diffeqpy_integrator <span class="im">import</span> DiffEqPyIntegrator</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ultra-high accuracy Julia integration</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffEqPyIntegrator(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    algorithm<span class="op">=</span><span class="st">'Vern9'</span>,  <span class="co"># 9th order method</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'numpy'</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    reltol<span class="op">=</span><span class="fl">1e-12</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    abstol<span class="op">=</span><span class="fl">1e-14</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>result[<span class="st">'nfev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Achieved accuracy: reltol=</span><span class="sc">{</span><span class="fl">1e-12</span><span class="sc">}</span><span class="ss">, abstol=</span><span class="sc">{</span><span class="fl">1e-14</span><span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>When to use:</strong></p>
<ul>
<li>Maximum performance requirements</li>
<li>Very stiff systems needing automatic detection</li>
<li>High-accuracy applications (&gt;8 digits)</li>
<li>Production environments with reliability requirements</li>
</ul>
</section>
<section id="sec-fixedstepintegrators" class="level3">
<h3 class="anchored" data-anchor-id="sec-fixedstepintegrators">FixedStepIntegrators: Educational and Simple Systems</h3>
<p><strong>File:</strong> <code>fixed_step_integrators.py</code></p>
<p>Manual implementations of classic fixed-step methods. These provide transparent, backend-agnostic integration suitable for education and simple systems where adaptive stepping is unnecessary.</p>
<p><strong>Available methods:</strong></p>
<ul>
<li><strong>ExplicitEulerIntegrator</strong>: Forward Euler (order 1) — simplest method</li>
<li><strong>HeunIntegrator</strong>: Heun’s method / Improved Euler (order 2) — predictor-corrector approach</li>
<li><strong>MidpointIntegrator</strong>: Midpoint method (order 2) — midpoint evaluation</li>
<li><strong>RK4Integrator</strong>: Classic Runge-Kutta 4 (order 4) — excellent balance</li>
</ul>
<p><strong>HeunIntegrator:</strong></p>
<p>Heun’s method uses a predictor-corrector approach with trapezoidal averaging:</p>
<pre><code>k1 = f(x_k, u_k)                    # Predictor (Euler step)
x_pred = x_k + dt * k1
k2 = f(x_pred, u_k)                 # Corrector
x_{k+1} = x_k + (dt/2) * (k1 + k2)  # Trapezoidal rule</code></pre>
<p>Also known as Improved Euler or Explicit Trapezoid method. Uses 2 function evaluations per step for second-order accuracy.</p>
<p><strong>Key features:</strong></p>
<ul>
<li><strong>Backend agnostic</strong>: Work with NumPy, PyTorch, and JAX arrays</li>
<li><strong>Transparent implementation</strong>: Clear, readable code for learning</li>
<li><strong>Constant time step</strong>: Predictable computational cost</li>
<li><strong>No external dependencies</strong>: Pure Python implementations</li>
<li><strong>TypedDict results</strong>: All integrators return <code>IntegrationResult</code> TypedDict</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-fixed" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.fixed_step_integrators <span class="im">import</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    RK4Integrator,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    HeunIntegrator,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># RK4 with fixed time step (4 function evals/step)</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>rk4_integrator <span class="op">=</span> RK4Integrator(system, dt<span class="op">=</span><span class="fl">0.01</span>, backend<span class="op">=</span><span class="st">'numpy'</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>result_rk4 <span class="op">=</span> rk4_integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Heun's method (2 function evals/step, predictor-corrector)</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>heun_integrator <span class="op">=</span> HeunIntegrator(system, dt<span class="op">=</span><span class="fl">0.01</span>, backend<span class="op">=</span><span class="st">'numpy'</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>result_heun <span class="op">=</span> heun_integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"RK4 - Steps: </span><span class="sc">{</span>result_rk4[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">, Solver: </span><span class="sc">{</span>result_rk4[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Heun - Steps: </span><span class="sc">{</span>result_heun[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">, Solver: </span><span class="sc">{</span>result_heun[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>When to use:</strong></p>
<ul>
<li>Educational purposes and learning</li>
<li>Simple systems with smooth dynamics</li>
<li>Real-time applications requiring predictable timing</li>
<li>Debugging with deterministic stepping</li>
</ul>
</section>
</section>
<section id="sec-track-2" class="level2">
<h2 class="anchored" data-anchor-id="sec-track-2">Track 2: Stochastic SDE Integration</h2>
<section id="sec-sdeintegratorbase" class="level3">
<h3 class="anchored" data-anchor-id="sec-sdeintegratorbase">SDEIntegratorBase: Stochastic Abstract Interface</h3>
<p><strong>File:</strong> <code>sde_integrator_base.py</code></p>
<p>Extends <code>IntegratorBase</code> to handle stochastic differential equations of the form:</p>
<p><span class="math display">\[dx = f(x, u, t)dt + g(x, u, t)dW\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(f(x, u, t)\)</span>: Drift term (deterministic dynamics)</li>
<li><span class="math inline">\(g(x, u, t)\)</span>: Diffusion term (stochastic intensity)</li>
<li><span class="math inline">\(dW\)</span>: Brownian motion increments (Wiener process)</li>
</ul>
<p><strong>Key differences from deterministic integration:</strong></p>
<ol type="1">
<li><strong>Random noise generation</strong>: Requires proper Brownian motion sampling</li>
<li><strong>Convergence types</strong>:
<ul>
<li><strong>Strong convergence</strong>: Pathwise accuracy (Monte Carlo, control)</li>
<li><strong>Weak convergence</strong>: Distribution accuracy (statistics)</li>
</ul></li>
<li><strong>Noise structure exploitation</strong>: Additive, diagonal, scalar, or general</li>
<li><strong>Multiple realizations</strong>: Monte Carlo simulation support</li>
<li><strong>Interpretation</strong>: Itô vs Stratonovich calculus</li>
</ol>
<p><strong>Additional abstract methods:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    x: Array, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    u: Array, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    dt: <span class="bu">float</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    dW: Array</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Array:</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Single SDE step with provided noise"""</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrate_monte_carlo(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    x0: Array,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    u_func: Callable,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    t_span: <span class="bu">tuple</span>[<span class="bu">float</span>, <span class="bu">float</span>],</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    n_paths: <span class="bu">int</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> SDEIntegrationResult:</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Multiple trajectory simulation for statistics"""</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sec-sdeintegratorfactory" class="level3">
<h3 class="anchored" data-anchor-id="sec-sdeintegratorfactory">SDEIntegratorFactory: SDE-Specific Creation</h3>
<p><strong>File:</strong> <code>sde_integrator_factory.py</code></p>
<p>Provides intelligent SDE integrator creation with automatic noise structure detection and method selection.</p>
<p><strong>Integration with Method Registry:</strong></p>
<p>Like <code>IntegratorFactory</code>, the SDE factory delegates to the centralized <code>method_registry</code> for method normalization and validation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Internally, SDEIntegratorFactory.create() does:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> normalize_method_name(method, backend)  <span class="co"># Registry function</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(method, backend, is_stochastic<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_fixed_step(method) <span class="kw">and</span> dt <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Fixed-step SDE method requires dt"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Factory methods:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatic selection based on noise structure</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.auto(sde_system, backend<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct method specification</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.create(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    sde_system, backend, method, dt, <span class="op">**</span>options</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimized for Monte Carlo simulations</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_monte_carlo(</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    sde_system, noise_type<span class="op">=</span><span class="st">'general'</span>, <span class="op">**</span>options</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Neural SDE training with adjoint</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_neural_sde(sde_system, adjoint<span class="op">=</span><span class="va">True</span>, <span class="op">**</span>options)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Julia DiffEqPy SDE solvers</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_julia(sde_system, algorithm<span class="op">=</span><span class="st">'SRIW1'</span>, <span class="op">**</span>options)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient-based optimization</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_optimization(sde_system, backend<span class="op">=</span><span class="va">None</span>, <span class="op">**</span>options)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Available SDE methods:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Backend</th>
<th>Convergence</th>
<th>Noise Type</th>
<th>Order</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>euler-maruyama</td>
<td>All</td>
<td>Strong 0.5</td>
<td>General</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>milstein</td>
<td>PyTorch/NumPy</td>
<td>Strong 1.0</td>
<td>Diagonal</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>reversible_heun</td>
<td>PyTorch/JAX</td>
<td>Strong 1.0</td>
<td>Additive</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>adaptive_heun</td>
<td>PyTorch</td>
<td>Strong 1.0</td>
<td>Additive</td>
<td>1.0 (adaptive)</td>
</tr>
<tr class="odd">
<td>srk</td>
<td>PyTorch</td>
<td>Strong</td>
<td>General</td>
<td>Variable</td>
</tr>
<tr class="even">
<td>midpoint</td>
<td>PyTorch</td>
<td>Strong</td>
<td>General</td>
<td>Variable</td>
</tr>
</tbody>
</table>
<p><strong>Noise structure types:</strong></p>
<ul>
<li><strong>Additive</strong>: <span class="math inline">\(g(x, u, t) = g(t)\)</span> — diffusion independent of state</li>
<li><strong>Diagonal</strong>: <span class="math inline">\(g\)</span> is diagonal matrix — independent noise channels</li>
<li><strong>Scalar</strong>: <span class="math inline">\(g\)</span> is scalar — single noise source</li>
<li><strong>General</strong>: Full matrix <span class="math inline">\(g\)</span> — correlated noise</li>
</ul>
</section>
<section id="sec-torchsdeintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-torchsdeintegrator">TorchSDEIntegrator: PyTorch SDE Integration</h3>
<p><strong>File:</strong> <code>torchsde_integrator.py</code></p>
<p>GPU-accelerated SDE integration using the <code>torchsde</code> library. Supports automatic differentiation through stochastic dynamics.</p>
<p><strong>Supported methods:</strong></p>
<ul>
<li><strong>euler</strong>: Euler-Maruyama (strong order 0.5) — Itô and Stratonovich</li>
<li><strong>milstein</strong>: Milstein method (strong order 1.0 for diagonal noise) — Itô only</li>
<li><strong>srk</strong>: Stochastic Runge-Kutta (general noise) — Itô and Stratonovich</li>
<li><strong>midpoint</strong>: Midpoint method — Stratonovich only</li>
<li><strong>reversible_heun</strong>: Reversible Heun (strong order 1.0 for additive noise) — Stratonovich only</li>
<li><strong>adaptive_heun</strong>: Adaptive Heun with error control — Itô and Stratonovich</li>
</ul>
<p><strong>Key features:</strong></p>
<ul>
<li>GPU acceleration for large-scale stochastic simulations</li>
<li>Adaptive stepping with stochastic error control</li>
<li>Noise structure exploitation for efficiency</li>
<li>Adjoint method for memory-efficient gradients through SDEs</li>
<li><strong>SDE type compatibility</strong>: Most methods support either Itô or Stratonovich (see method list)</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-torchsde" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.torchsde_integrator <span class="im">import</span> TorchSDEIntegrator</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Ornstein-Uhlenbeck process: dx = -α*x*dt + σ*dW</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> TorchSDEIntegrator(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'euler'</span>,  <span class="co"># Euler-Maruyama for Itô SDEs</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'torch'</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> torch.tensor([<span class="fl">0.5</span>])</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: torch.zeros(<span class="dv">1</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Convergence type: </span><span class="sc">{</span>result[<span class="st">'convergence_type'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"SDE type: </span><span class="sc">{</span>result[<span class="st">'sde_type'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="sec-diffraxsdeintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-diffraxsdeintegrator">DiffraxSDEIntegrator: JAX SDE Integration</h3>
<p><strong>File:</strong> <code>diffrax_sde_integrator.py</code></p>
<p>JAX-based SDE integration with XLA compilation and functional transformations. Excellent for optimization involving stochastic dynamics.</p>
<p><strong>Supported methods:</strong></p>
<ul>
<li><strong>euler</strong>: Euler-Maruyama</li>
<li><strong>heun</strong>: Heun’s method (if supported by diffrax)</li>
<li><strong>reversible_heun</strong>: Time-reversible stochastic integration</li>
</ul>
<p><strong>Key features:</strong></p>
<ul>
<li>XLA compilation for near-C++ performance</li>
<li>JAX transformations (<code>jit</code>, <code>vmap</code>, <code>grad</code>) work seamlessly</li>
<li>Custom noise support for deterministic testing</li>
<li>Efficient for stochastic optimization</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-diffraxsde" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.diffrax_sde_integrator <span class="im">import</span> DiffraxSDEIntegrator</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffraxSDEIntegrator(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'euler'</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'jax'</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>SEED</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">0.5</span>])</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="sec-diffeqpysdeintegrator" class="level3">
<h3 class="anchored" data-anchor-id="sec-diffeqpysdeintegrator">DiffEqPySDEIntegrator: Julia SDE Integration</h3>
<p><strong>File:</strong> <code>diffeqpy_sde_integrator.py</code></p>
<p>Access to Julia’s comprehensive SDE solver ecosystem through Python bindings.</p>
<p><strong>Supported methods:</strong></p>
<ul>
<li>Euler-Maruyama variants</li>
<li>Milstein method</li>
<li>Stochastic Rosenbrock methods</li>
<li>Advanced Julia SDE algorithms</li>
</ul>
<p><strong>Key features:</strong></p>
<ul>
<li>Production-grade SDE solvers</li>
<li>Automatic noise structure detection</li>
<li>High-performance algorithms</li>
<li>Extensive method library</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-diffeqpysde" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.diffeqpy_sde_integrator <span class="im">import</span> DiffEqPySDEIntegrator</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffEqPySDEIntegrator(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'EM'</span>,  <span class="co"># Euler-Maruyama</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'numpy'</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>SEED</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">0.5</span>])</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Diffusion evaluations: </span><span class="sc">{</span>result[<span class="st">'diffusion_evals'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="sec-custombrownianpath" class="level3">
<h3 class="anchored" data-anchor-id="sec-custombrownianpath">CustomBrownianPath: Deterministic Noise for Testing</h3>
<p><strong>File:</strong> <code>custom_brownian.py</code></p>
<p>Provides custom Brownian motion paths for deterministic testing and reproducibility. Implements diffrax’s <code>AbstractPath</code> interface.</p>
<p><strong>Key features:</strong></p>
<ul>
<li>User-provided noise increments</li>
<li>Deterministic testing support</li>
<li>Custom noise patterns (e.g., zero noise, specific realizations)</li>
<li>Compatible with diffrax integrators</li>
</ul>
<p><strong>Usage example:</strong></p>
<div id="ex-custombrown" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jax <span class="im">import</span> random</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.custom_brownian <span class="im">import</span> (</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    CustomBrownianPath, create_custom_or_random_brownian</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.diffrax_sde_integrator <span class="im">import</span> DiffraxSDEIntegrator</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>nw <span class="op">=</span> sde_system.nw</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Zero noise for deterministic testing</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>dW <span class="op">=</span> jnp.zeros((nw,))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>brownian <span class="op">=</span> CustomBrownianPath(t0<span class="op">=</span><span class="fl">0.0</span>, t1<span class="op">=</span><span class="fl">10.0</span>, dW<span class="op">=</span>dW)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Or generate random noise</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>key <span class="op">=</span> random.key(SEED)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>brownian_random <span class="op">=</span> create_custom_or_random_brownian(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    key, t0<span class="op">=</span><span class="fl">0.0</span>, t1<span class="op">=</span><span class="fl">10.0</span>, shape<span class="op">=</span>(nw,), dW<span class="op">=</span><span class="va">None</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Use in integration</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffraxSDEIntegrator(sde_system, method<span class="op">=</span><span class="st">'euler'</span>, dt<span class="op">=</span><span class="fl">0.01</span>, backend<span class="op">=</span><span class="st">'jax'</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">0.5</span>])</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), brownian_path<span class="op">=</span>brownian</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Deterministic SDE integration (zero noise)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Important notes:</strong></p>
<ol type="1">
<li><strong>Time span matching</strong>: <code>CustomBrownianPath(t0, t1, dW)</code> must match <code>t_span</code></li>
<li><strong>Single dW for entire integration</strong>: Unlike <code>step()</code>, provide one <code>dW</code> for the full interval</li>
<li><strong>Automatic interpolation</strong>: Diffrax handles internal time queries</li>
</ol>
</section>
</section>
<section id="sec-result-types" class="level2">
<h2 class="anchored" data-anchor-id="sec-result-types">Integration Result Types</h2>
<section id="sec-integrationresult" class="level3">
<h3 class="anchored" data-anchor-id="sec-integrationresult">IntegrationResult (Deterministic ODEs)</h3>
<p>All ODE integrators return a TypedDict with consistent fields:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t'</span>: array,              <span class="co"># Time points (T,)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x'</span>: array,              <span class="co"># States (T, nx) - time-major format</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'success'</span>: <span class="bu">bool</span>,         <span class="co"># Integration succeeded</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'message'</span>: <span class="bu">str</span>,          <span class="co"># Status message</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nfev'</span>: <span class="bu">int</span>,             <span class="co"># Function evaluations</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nsteps'</span>: <span class="bu">int</span>,           <span class="co"># Steps taken</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'integration_time'</span>: <span class="bu">float</span>,  <span class="co"># Wall clock time (seconds)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'solver'</span>: <span class="bu">str</span>,           <span class="co"># Integrator name</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optional (adaptive methods only):</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'njev'</span>: <span class="bu">int</span>,             <span class="co"># Jacobian evaluations</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nlu'</span>: <span class="bu">int</span>,              <span class="co"># LU decompositions</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'status'</span>: <span class="bu">int</span>,           <span class="co"># Solver-specific status code</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sol'</span>: <span class="bu">object</span>,           <span class="co"># Dense output object (if requested)</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dense_output'</span>: <span class="bu">bool</span>,    <span class="co"># Dense output available</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sec-sdeintegrationresult" class="level3">
<h3 class="anchored" data-anchor-id="sec-sdeintegrationresult">SDEIntegrationResult (Stochastic SDEs)</h3>
<p>SDE integrators extend <code>IntegrationResult</code> with stochastic-specific fields:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># All IntegrationResult fields, plus:</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'diffusion_evals'</span>: <span class="bu">int</span>,     <span class="co"># Diffusion function calls</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'noise_samples'</span>: array,     <span class="co"># Brownian increments used</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_paths'</span>: <span class="bu">int</span>,             <span class="co"># Number of trajectories</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'convergence_type'</span>: <span class="bu">str</span>,    <span class="co"># 'strong' or 'weak'</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sde_type'</span>: <span class="bu">str</span>,            <span class="co"># 'ito' or 'stratonovich'</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'noise_type'</span>: <span class="bu">str</span>,          <span class="co"># 'additive', 'diagonal', 'scalar', 'general'</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For Monte Carlo (n_paths &gt; 1):</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x'</span>: array,                 <span class="co"># (n_paths, T, nx)</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'statistics'</span>: <span class="bu">dict</span>,         <span class="co"># {'mean', 'std', 'q25', 'q50', 'q75'}</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="sec-usage-examples" class="level2">
<h2 class="anchored" data-anchor-id="sec-usage-examples">Practical Usage Examples</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Recommended Usage Pattern
</div>
</div>
<div class="callout-body-container callout-body">
<p>The examples below show <strong>direct integrator instantiation for documentation purposes</strong>. In practice, most users should use the system’s <code>integrate()</code> method which delegates to the appropriate integrator automatically:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended approach</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(x0<span class="op">=</span>x0, method<span class="op">=</span><span class="st">'RK45'</span>, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced approach (shown in examples below)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.auto(system)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<section id="example-1-recommended-high-level-interface" class="level3">
<h3 class="anchored" data-anchor-id="example-1-recommended-high-level-interface">Example 1: Recommended High-Level Interface</h3>
<div id="ex-recommended" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Most users should use this approach - system handles delegation</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">0.1</span>, <span class="fl">0.0</span>])</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    x0<span class="op">=</span>x0,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'RK45'</span>,  <span class="co"># Optional: auto-selected if not specified</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    t_span<span class="op">=</span>(<span class="fl">0.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Success: </span><span class="sc">{</span>result[<span class="st">'success'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="example-2-advanced---direct-integrator-access" class="level3">
<h3 class="anchored" data-anchor-id="example-2-advanced---direct-integrator-access">Example 2: Advanced - Direct Integrator Access</h3>
<div id="ex-quickstart" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced: Direct integrator instantiation for reuse or fine control</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.auto(system)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Can reuse integrator for multiple integrations</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">0.1</span>, <span class="fl">0.0</span>])</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="fl">0.0</span>, <span class="fl">10.0</span>))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="example-3-high-accuracy-julia-integration" class="level3">
<h3 class="anchored" data-anchor-id="example-3-high-accuracy-julia-integration">Example 3: High-Accuracy Julia Integration</h3>
<div id="ex-julia-accuracy" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended: System-level interface</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    x0<span class="op">=</span>x0,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'Vern9'</span>,  <span class="co"># Julia's 9th order method</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-12</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-14</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>result[<span class="st">'nfev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Integration time: </span><span class="sc">{</span>result[<span class="st">'integration_time'</span>]<span class="sc">:.4f}</span><span class="ss">s"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="example-4-gpu-accelerated-neural-ode" class="level3">
<h3 class="anchored" data-anchor-id="example-4-gpu-accelerated-neural-ode">Example 4: GPU-Accelerated Neural ODE</h3>
<div id="ex-neural-ode" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Switch to PyTorch backend for gradients</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> system.use_backend(<span class="st">'torch'</span>):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> torch.tensor([<span class="fl">1.0</span>, <span class="fl">0.0</span>], requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> system.integrate(</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        x0<span class="op">=</span>x0,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        method<span class="op">=</span><span class="st">'dopri5'</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        device<span class="op">=</span><span class="st">'cpu'</span>,  <span class="co"># Use 'cuda:0' for GPU</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gradient computation works seamlessly</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    final_state <span class="op">=</span> result[<span class="st">'x'</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> final_state.<span class="bu">sum</span>()</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    loss.backward()</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Gradient w.r.t. x0: </span><span class="sc">{</span>x0<span class="sc">.</span>grad<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="example-5-stochastic-simulation-with-monte-carlo" class="level3">
<h3 class="anchored" data-anchor-id="example-5-stochastic-simulation-with-monte-carlo">Example 5: Stochastic Simulation with Monte Carlo</h3>
<div id="ex-monte-carlo" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic <span class="im">import</span> get_trajectory_statistics</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create stochastic system</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use integrator for Monte Carlo (don't specify backend, it's handled internally)</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> SDEIntegratorFactory.for_monte_carlo(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    sde_system, n_paths<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>])</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate_monte_carlo(</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), n_paths<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract statistics</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> get_trajectory_statistics(result)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract scalar values from arrays</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>mean_final <span class="op">=</span> <span class="bu">float</span>(stats[<span class="st">'mean'</span>][<span class="op">-</span><span class="dv">1</span>].flat[<span class="dv">0</span>])</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>std_final <span class="op">=</span> <span class="bu">float</span>(stats[<span class="st">'std'</span>][<span class="op">-</span><span class="dv">1</span>].flat[<span class="dv">0</span>])</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean at t=10: </span><span class="sc">{</span>mean_final<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std at t=10: </span><span class="sc">{</span>std_final<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="example-6-deterministic-testing-with-custom-noise" class="level3">
<h3 class="anchored" data-anchor-id="example-6-deterministic-testing-with-custom-noise">Example 6: Deterministic Testing with Custom Noise</h3>
<div id="ex-custom-noise" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.custom_brownian <span class="im">import</span> CustomBrownianPath</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>nw <span class="op">=</span> sde_system.nw</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Zero noise for deterministic testing</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>dW <span class="op">=</span> jnp.zeros((nw,))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>brownian <span class="op">=</span> CustomBrownianPath(t0<span class="op">=</span><span class="fl">0.0</span>, t1<span class="op">=</span><span class="fl">10.0</span>, dW<span class="op">=</span>dW)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create JAX integrator</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> SDEIntegratorFactory.create(</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'jax'</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'Euler'</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>SEED</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Integrate with custom noise</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">0.5</span>])</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), brownian_path<span class="op">=</span>brownian</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Deterministic integration complete"</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Final state: </span><span class="sc">{</span>result[<span class="st">'x'</span>][<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="sec-selection-guide" class="level2">
<h2 class="anchored" data-anchor-id="sec-selection-guide">Integrator Selection Guide</h2>
<section id="by-use-case" class="level3">
<h3 class="anchored" data-anchor-id="by-use-case">By Use Case</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 50%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Use Case</th>
<th>Recommended Approach</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>General ODE</td>
<td><code>IntegratorFactory.for_production(system)</code></td>
<td>LSODA auto-stiffness detection</td>
</tr>
<tr class="even">
<td>Neural ODE</td>
<td><code>IntegratorFactory.for_neural_ode(system)</code></td>
<td>Adjoint method for memory efficiency</td>
</tr>
<tr class="odd">
<td>Optimization</td>
<td><code>IntegratorFactory.for_optimization(system)</code></td>
<td>JAX with XLA compilation</td>
</tr>
<tr class="even">
<td>High Accuracy</td>
<td><code>IntegratorFactory.for_julia(system, 'Vern9')</code></td>
<td>Julia 9th order methods</td>
</tr>
<tr class="odd">
<td>Stiff ODE</td>
<td><code>ScipyIntegrator(system, method='BDF')</code></td>
<td>Backward differentiation</td>
</tr>
<tr class="even">
<td>Simple ODE</td>
<td><code>RK4Integrator(system, dt=0.01)</code></td>
<td>Classic fixed-step</td>
</tr>
<tr class="odd">
<td>General SDE</td>
<td><code>SDEIntegratorFactory.auto(sde_system)</code></td>
<td>Automatic noise detection</td>
</tr>
<tr class="even">
<td>Monte Carlo</td>
<td><code>SDEIntegratorFactory.for_monte_carlo(...)</code></td>
<td>Parallelized trajectories</td>
</tr>
</tbody>
</table>
</section>
<section id="by-backend-capabilities" class="level3">
<h3 class="anchored" data-anchor-id="by-backend-capabilities">By Backend Capabilities</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 32%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Backend</th>
<th>ODE Integrator</th>
<th>SDE Integrator</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NumPy</td>
<td>ScipyIntegrator, DiffEqPyIntegrator</td>
<td>DiffEqPySDEIntegrator</td>
<td>General purpose, highest compatibility</td>
</tr>
<tr class="even">
<td>PyTorch</td>
<td>TorchDiffEqIntegrator</td>
<td>TorchSDEIntegrator</td>
<td>GPU acceleration, neural networks</td>
</tr>
<tr class="odd">
<td>JAX</td>
<td>DiffraxIntegrator</td>
<td>DiffraxSDEIntegrator</td>
<td>Optimization, functional programming</td>
</tr>
</tbody>
</table>
</section>
<section id="by-system-properties" class="level3">
<h3 class="anchored" data-anchor-id="by-system-properties">By System Properties</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 36%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>System Type</th>
<th>Best Method</th>
<th>Convergence Order</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Non-stiff</td>
<td>RK45, Tsit5, dopri5</td>
<td>5(4)</td>
<td>General purpose</td>
</tr>
<tr class="even">
<td>Stiff</td>
<td>BDF, Radau, Rodas5</td>
<td>Variable</td>
<td>Implicit methods required</td>
</tr>
<tr class="odd">
<td>Very stiff</td>
<td>BDF, LSODA</td>
<td>Variable</td>
<td>Automatic stiffness detection</td>
</tr>
<tr class="even">
<td>High accuracy</td>
<td>Vern9, DOP853</td>
<td>9(8) or 8(5,3)</td>
<td>For precision-critical applications</td>
</tr>
<tr class="odd">
<td>Real-time</td>
<td>RK4, euler</td>
<td>4 or 1</td>
<td>Fixed step, predictable timing</td>
</tr>
<tr class="even">
<td>Additive noise SDE</td>
<td>reversible_heun, adaptive_heun</td>
<td>1.0 (strong)</td>
<td>Exploits simplified noise structure</td>
</tr>
<tr class="odd">
<td>General SDE</td>
<td>Euler-Maruyama</td>
<td>0.5 (strong)</td>
<td>Robust for any noise type</td>
</tr>
<tr class="even">
<td>Diagonal noise SDE</td>
<td>Milstein</td>
<td>1.0 (strong)</td>
<td>Higher order for independent channels</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="sec-design-principles" class="level2">
<h2 class="anchored" data-anchor-id="sec-design-principles">Design Principles</h2>
<section id="backend-abstraction" class="level3">
<h3 class="anchored" data-anchor-id="backend-abstraction">Backend Abstraction</h3>
<p>All integrators provide consistent interfaces across computational backends. Switch between NumPy, PyTorch, and JAX without changing integration code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same interface, different backends</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>integrator_numpy <span class="op">=</span> IntegratorFactory.auto(system, backend<span class="op">=</span><span class="st">'numpy'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>integrator_torch <span class="op">=</span> IntegratorFactory.auto(system, backend<span class="op">=</span><span class="st">'torch'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>integrator_jax <span class="op">=</span> IntegratorFactory.auto(system, backend<span class="op">=</span><span class="st">'jax'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="factory-pattern-for-complexity-management" class="level3">
<h3 class="anchored" data-anchor-id="factory-pattern-for-complexity-management">Factory Pattern for Complexity Management</h3>
<p>Factories encapsulate the complexity of choosing appropriate integrators:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># User specifies intent, factory handles details</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_production(system)  <span class="co"># → LSODA</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_neural_ode(system)  <span class="co"># → dopri5 with adjoint</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_optimization(system)  <span class="co"># → tsit5 with JAX</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="unified-result-types" class="level3">
<h3 class="anchored" data-anchor-id="unified-result-types">Unified Result Types</h3>
<p>TypedDict results provide consistent structure with IDE support:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>result: IntegrationResult <span class="op">=</span> integrator.integrate(...)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># IDE knows 'success', 'nfev', 'x', 't' are available</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="composition-over-inheritance" class="level3">
<h3 class="anchored" data-anchor-id="composition-over-inheritance">Composition Over Inheritance</h3>
<p>Integrators compose with systems rather than inheriting deeply:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Integrator:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, system: ContinuousSystemBase):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.system <span class="op">=</span> system  <span class="co"># Composition</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="built-in-performance-tracking" class="level3">
<h3 class="anchored" data-anchor-id="built-in-performance-tracking">Built-in Performance Tracking</h3>
<p>All integrators track statistics automatically:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>integrator<span class="sc">.</span>_stats[<span class="st">'total_fev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Integration steps: </span><span class="sc">{</span>integrator<span class="sc">.</span>_stats[<span class="st">'total_steps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Computation time: </span><span class="sc">{</span>integrator<span class="sc">.</span>_stats[<span class="st">'total_time'</span>]<span class="sc">:.4f}</span><span class="ss">s"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="sec-strengths" class="level2">
<h2 class="anchored" data-anchor-id="sec-strengths">Key Strengths</h2>
<ol type="1">
<li><strong>Multi-backend support</strong>: Seamless NumPy/PyTorch/JAX switching</li>
<li><strong>Extensive method library</strong>: 40+ integration methods across ODE and SDE</li>
<li><strong>Centralized method registry</strong>: Unified method normalization, validation, and discovery</li>
<li><strong>Canonical name support</strong>: Use portable names (<code>euler_maruyama</code>, <code>rk45</code>) across backends</li>
<li><strong>Intelligent factories</strong>: Automatic method selection based on system properties</li>
<li><strong>Type safety</strong>: TypedDict results with full IDE support</li>
<li><strong>GPU acceleration</strong>: First-class support via PyTorch and JAX</li>
<li><strong>XLA compilation</strong>: Near-native performance with JAX</li>
<li><strong>Julia integration</strong>: Access to world-class DifferentialEquations.jl ecosystem</li>
<li><strong>SDE support</strong>: Comprehensive stochastic integration framework</li>
<li><strong>Noise exploitation</strong>: Automatic detection and optimization for noise structure</li>
<li><strong>Monte Carlo</strong>: Built-in multi-trajectory simulation</li>
<li><strong>Custom noise</strong>: Deterministic testing with user-provided Brownian paths</li>
<li><strong>Production ready</strong>: Professional error control and performance tracking</li>
</ol>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>The ControlDESymulation integration framework provides a comprehensive, production-ready solution for numerical integration across deterministic and stochastic systems. With support for multiple backends, extensive method libraries, and intelligent automation through factory patterns, it enables efficient development of control theory and machine learning applications requiring state-of-the-art numerical integration.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/gilbenezer\.github\.io\/ControlDESymulation");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Integration Framework Architecture"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Multi-Backend Integration for ODEs and SDEs"</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Gil Benezer"</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview {#sec-overview}</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>The ControlDESymulation numerical integration framework provides **multi-backend**, **multi-method** support for integrating both **deterministic ordinary differential equations (ODEs)** and **stochastic differential equations (SDEs)**. The framework consists of 14 core files organized into a clean two-track architecture with a shared method registry.</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>**Key capabilities:**</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Backend agnostic**: Seamless switching between NumPy, PyTorch, and JAX</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**40+ integration methods**: From simple Euler to high-order adaptive schemes</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Stochastic support**: Full SDE integration with noise structure exploitation</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Factory pattern**: Automatic method selection based on system properties</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Production ready**: Professional-grade error control and performance tracking</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## User Interface</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>**Most users should NOT directly instantiate integrators or factories.** Instead, use the high-level system interface:</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended: Use system.integrate() - delegates to appropriate integrator</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    x0<span class="op">=</span>np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>]),</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'RK45'</span>,  <span class="co"># Optional: framework selects automatically</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced: Direct integrator access (only when needed for fine control)</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.auto(system)</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>The system's <span class="in">`integrate()`</span> method automatically handles backend selection, method routing, and integrator lifecycle. Direct integrator instantiation is only needed for advanced use cases requiring explicit integrator reuse or fine-grained control.</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Architecture Overview {#sec-architecture}</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>The framework follows a dual-track design separating deterministic and stochastic integration, with a shared **method registry** providing centralized method management:</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="in">Shared Infrastructure</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a><span class="in">├── MethodRegistry (centralized method normalization and validation)</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── normalize_method_name() - cross-backend name mapping</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── validate_method() - backend/system compatibility</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── is_sde_method() / is_fixed_step() - classification</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── get_available_methods() - method discovery</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a><span class="in">│</span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a><span class="in">Track 1: Deterministic ODE Integration</span></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a><span class="in">├── IntegratorBase (abstract interface)</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a><span class="in">├── IntegratorFactory (method selection via registry)</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="in">├── Backend-Specific Implementations:</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── ScipyIntegrator (NumPy/SciPy)</span></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── TorchDiffEqIntegrator (PyTorch with GPU)</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── DiffraxIntegrator (JAX with XLA)</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── DiffEqPyIntegrator (Julia via Python)</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a><span class="in">└── FixedStepIntegrators (Euler, Heun, Midpoint, RK4)</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a><span class="in">Track 2: Stochastic SDE Integration</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a><span class="in">├── SDEIntegratorBase (extends IntegratorBase)</span></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a><span class="in">├── SDEIntegratorFactory (SDE-specific creation via registry)</span></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a><span class="in">├── Backend-Specific Implementations:</span></span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── TorchSDEIntegrator (PyTorch SDEs)</span></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── DiffraxSDEIntegrator (JAX SDEs)</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── DiffEqPySDEIntegrator (Julia SDEs)</span></span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a><span class="in">└── CustomBrownianPath (deterministic noise for testing)</span></span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup-imports</span></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Global setup for all code examples</span></span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jax</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jax.numpy <span class="im">as</span> jnp</span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym <span class="im">import</span> (</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a>    Pendulum,</span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>    IntegratorFactory,</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>    OrnsteinUhlenbeck,</span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>    SDEIntegratorFactory,</span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppress JAX GPU warnings</span></span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>, category<span class="op">=</span><span class="pp">UserWarning</span>, module<span class="op">=</span><span class="st">'jax'</span>)</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Method Registry: Centralized Method Management {#sec-method-registry}</span></span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`method_registry.py`</span></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a>The <span class="in">`method_registry`</span> module serves as the **single source of truth** for all integration methods across backends. It provides centralized method normalization, validation, and classification for both ODE and SDE integrators.</span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Design Philosophy</span></span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a>**Backend Naming Conventions:**</span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Backend <span class="pp">|</span> Convention <span class="pp">|</span> Examples <span class="pp">|</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|------------|----------|</span></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> NumPy/Julia (DiffEqPy) <span class="pp">|</span> Capitalized <span class="pp">|</span> <span class="in">`EM`</span>, <span class="in">`Tsit5`</span>, <span class="in">`SRIW1`</span> <span class="pp">|</span></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> PyTorch (TorchSDE/TorchDiffEq) <span class="pp">|</span> lowercase <span class="pp">|</span> <span class="in">`euler`</span>, <span class="in">`dopri5`</span>, <span class="in">`milstein`</span> <span class="pp">|</span></span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> JAX (Diffrax) <span class="pp">|</span> PascalCase <span class="pp">|</span> <span class="in">`Euler`</span>, <span class="in">`ItoMilstein`</span>, <span class="in">`Tsit5`</span> <span class="pp">|</span></span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a>**Canonical Names:**</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a>User-friendly aliases that work across all backends (e.g., <span class="in">`euler_maruyama`</span>, <span class="in">`milstein`</span>, <span class="in">`rk45`</span>). These are automatically normalized to backend-specific names.</span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a><span class="fu">### Core Functions</span></span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.method_registry <span class="im">import</span> (</span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a>    normalize_method_name,</span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a>    validate_method,</span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a>    is_sde_method,</span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a>    is_fixed_step,</span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a>    get_available_methods,</span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a>    get_method_info,</span>
<span id="cb38-141"><a href="#cb38-141" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize canonical names to backend-specific</span></span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a>normalize_method_name(<span class="st">'euler_maruyama'</span>, <span class="st">'numpy'</span>)  <span class="co"># → 'EM'</span></span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a>normalize_method_name(<span class="st">'euler_maruyama'</span>, <span class="st">'torch'</span>)  <span class="co"># → 'euler'</span></span>
<span id="cb38-146"><a href="#cb38-146" aria-hidden="true" tabindex="-1"></a>normalize_method_name(<span class="st">'euler_maruyama'</span>, <span class="st">'jax'</span>)    <span class="co"># → 'Euler'</span></span>
<span id="cb38-147"><a href="#cb38-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate method/backend/system compatibility</span></span>
<span id="cb38-149"><a href="#cb38-149" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(<span class="st">'euler_maruyama'</span>, <span class="st">'torch'</span>, is_stochastic<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-150"><a href="#cb38-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-151"><a href="#cb38-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify methods</span></span>
<span id="cb38-152"><a href="#cb38-152" aria-hidden="true" tabindex="-1"></a>is_sde_method(<span class="st">'euler_maruyama'</span>)  <span class="co"># → True</span></span>
<span id="cb38-153"><a href="#cb38-153" aria-hidden="true" tabindex="-1"></a>is_sde_method(<span class="st">'rk4'</span>)              <span class="co"># → False</span></span>
<span id="cb38-154"><a href="#cb38-154" aria-hidden="true" tabindex="-1"></a>is_fixed_step(<span class="st">'rk4'</span>)              <span class="co"># → True</span></span>
<span id="cb38-155"><a href="#cb38-155" aria-hidden="true" tabindex="-1"></a>is_fixed_step(<span class="st">'RK45'</span>)             <span class="co"># → False (adaptive)</span></span>
<span id="cb38-156"><a href="#cb38-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-157"><a href="#cb38-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Discover available methods</span></span>
<span id="cb38-158"><a href="#cb38-158" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> get_available_methods(<span class="st">'torch'</span>, method_type<span class="op">=</span><span class="st">'stochastic'</span>)</span>
<span id="cb38-159"><a href="#cb38-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-160"><a href="#cb38-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-161"><a href="#cb38-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### Method Classification</span></span>
<span id="cb38-162"><a href="#cb38-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-163"><a href="#cb38-163" aria-hidden="true" tabindex="-1"></a>Methods are classified along two dimensions:</span>
<span id="cb38-164"><a href="#cb38-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-165"><a href="#cb38-165" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**System type**: Deterministic (ODE) vs Stochastic (SDE)</span>
<span id="cb38-166"><a href="#cb38-166" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Time stepping**: Fixed-step vs Adaptive</span>
<span id="cb38-167"><a href="#cb38-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-168"><a href="#cb38-168" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Category <span class="pp">|</span> Examples <span class="pp">|</span> Use Case <span class="pp">|</span></span>
<span id="cb38-169"><a href="#cb38-169" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|----------|----------|</span></span>
<span id="cb38-170"><a href="#cb38-170" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`DETERMINISTIC_FIXED_STEP`</span> <span class="pp">|</span> <span class="in">`euler`</span>, <span class="in">`heun`</span>, <span class="in">`midpoint`</span>, <span class="in">`rk4`</span> <span class="pp">|</span> Manual implementations <span class="pp">|</span></span>
<span id="cb38-171"><a href="#cb38-171" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`DETERMINISTIC_ADAPTIVE`</span> <span class="pp">|</span> <span class="in">`RK45`</span>, <span class="in">`LSODA`</span>, <span class="in">`dopri5`</span>, <span class="in">`tsit5`</span> <span class="pp">|</span> Production ODE solvers <span class="pp">|</span></span>
<span id="cb38-172"><a href="#cb38-172" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`SDE_FIXED_STEP`</span> <span class="pp">|</span> <span class="in">`EM`</span>, <span class="in">`euler`</span>, <span class="in">`milstein`</span>, <span class="in">`SRIW1`</span> <span class="pp">|</span> Most SDE methods <span class="pp">|</span></span>
<span id="cb38-173"><a href="#cb38-173" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`SDE_ADAPTIVE`</span> <span class="pp">|</span> <span class="in">`LambaEM`</span>, <span class="in">`AutoEM`</span>, <span class="in">`adaptive_heun`</span> <span class="pp">|</span> Rare adaptive SDE <span class="pp">|</span></span>
<span id="cb38-174"><a href="#cb38-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-175"><a href="#cb38-175" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normalization Map</span></span>
<span id="cb38-176"><a href="#cb38-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-177"><a href="#cb38-177" aria-hidden="true" tabindex="-1"></a>The registry maintains a comprehensive map for cross-backend method translation:</span>
<span id="cb38-178"><a href="#cb38-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-179"><a href="#cb38-179" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-180"><a href="#cb38-180" aria-hidden="true" tabindex="-1"></a>NORMALIZATION_MAP <span class="op">=</span> {</span>
<span id="cb38-181"><a href="#cb38-181" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SDE Methods</span></span>
<span id="cb38-182"><a href="#cb38-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">'euler_maruyama'</span>: {<span class="st">'numpy'</span>: <span class="st">'EM'</span>, <span class="st">'torch'</span>: <span class="st">'euler'</span>, <span class="st">'jax'</span>: <span class="st">'Euler'</span>},</span>
<span id="cb38-183"><a href="#cb38-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">'milstein'</span>: {<span class="st">'numpy'</span>: <span class="st">'RKMil'</span>, <span class="st">'torch'</span>: <span class="st">'milstein'</span>, <span class="st">'jax'</span>: <span class="st">'ItoMilstein'</span>},</span>
<span id="cb38-184"><a href="#cb38-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sra1'</span>: {<span class="st">'numpy'</span>: <span class="st">'SRA1'</span>, <span class="st">'torch'</span>: <span class="st">'srk'</span>, <span class="st">'jax'</span>: <span class="st">'SRA1'</span>},</span>
<span id="cb38-185"><a href="#cb38-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-186"><a href="#cb38-186" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ODE Methods</span></span>
<span id="cb38-187"><a href="#cb38-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rk45'</span>: {<span class="st">'numpy'</span>: <span class="st">'RK45'</span>, <span class="st">'torch'</span>: <span class="st">'dopri5'</span>, <span class="st">'jax'</span>: <span class="st">'tsit5'</span>},</span>
<span id="cb38-188"><a href="#cb38-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dopri5'</span>: {<span class="st">'numpy'</span>: <span class="st">'RK45'</span>, <span class="st">'torch'</span>: <span class="st">'dopri5'</span>, <span class="st">'jax'</span>: <span class="st">'dopri5'</span>},</span>
<span id="cb38-189"><a href="#cb38-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tsit5'</span>: {<span class="st">'numpy'</span>: <span class="st">'Tsit5'</span>, <span class="st">'torch'</span>: <span class="st">'dopri5'</span>, <span class="st">'jax'</span>: <span class="st">'tsit5'</span>},</span>
<span id="cb38-190"><a href="#cb38-190" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... more mappings</span></span>
<span id="cb38-191"><a href="#cb38-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-192"><a href="#cb38-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-193"><a href="#cb38-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-194"><a href="#cb38-194" aria-hidden="true" tabindex="-1"></a><span class="fu">### Usage in Factories</span></span>
<span id="cb38-195"><a href="#cb38-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-196"><a href="#cb38-196" aria-hidden="true" tabindex="-1"></a>Both <span class="in">`IntegratorFactory`</span> and <span class="in">`SDEIntegratorFactory`</span> use the registry for method handling:</span>
<span id="cb38-197"><a href="#cb38-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-198"><a href="#cb38-198" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-199"><a href="#cb38-199" aria-hidden="true" tabindex="-1"></a><span class="co"># IntegratorFactory.create() internally:</span></span>
<span id="cb38-200"><a href="#cb38-200" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> normalize_method_name(method, backend)</span>
<span id="cb38-201"><a href="#cb38-201" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(method, backend, is_stochastic<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-202"><a href="#cb38-202" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_fixed_step(method) <span class="kw">and</span> dt <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb38-203"><a href="#cb38-203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Fixed-step method requires dt"</span>)</span>
<span id="cb38-204"><a href="#cb38-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-205"><a href="#cb38-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-206"><a href="#cb38-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Track 1: Deterministic ODE Integration {#sec-track-1}</span></span>
<span id="cb38-207"><a href="#cb38-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-208"><a href="#cb38-208" aria-hidden="true" tabindex="-1"></a><span class="fu">### IntegratorBase: Abstract Interface {#sec-integratorbase}</span></span>
<span id="cb38-209"><a href="#cb38-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-210"><a href="#cb38-210" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`integrator_base.py`</span></span>
<span id="cb38-211"><a href="#cb38-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-212"><a href="#cb38-212" aria-hidden="true" tabindex="-1"></a>The <span class="in">`IntegratorBase`</span> class defines the unified interface that all numerical integrators must implement. This abstraction enables backend-agnostic integration while maintaining consistent behavior across implementations.</span>
<span id="cb38-213"><a href="#cb38-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-214"><a href="#cb38-214" aria-hidden="true" tabindex="-1"></a>**Core responsibilities:**</span>
<span id="cb38-215"><a href="#cb38-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-216"><a href="#cb38-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define integration contract through abstract methods</span>
<span id="cb38-217"><a href="#cb38-217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Track performance statistics (function evaluations, steps, timing)</span>
<span id="cb38-218"><a href="#cb38-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Manage integration parameters (time step, tolerances, backend)</span>
<span id="cb38-219"><a href="#cb38-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide consistent result format via <span class="in">`IntegrationResult`</span> TypedDict</span>
<span id="cb38-220"><a href="#cb38-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-221"><a href="#cb38-221" aria-hidden="true" tabindex="-1"></a>**Key attributes:**</span>
<span id="cb38-222"><a href="#cb38-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-223"><a href="#cb38-223" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-224"><a href="#cb38-224" aria-hidden="true" tabindex="-1"></a>system: ContinuousSystemBase     <span class="co"># Dynamical system to integrate</span></span>
<span id="cb38-225"><a href="#cb38-225" aria-hidden="true" tabindex="-1"></a>dt: <span class="bu">float</span>                        <span class="co"># Time step (or initial guess for adaptive)</span></span>
<span id="cb38-226"><a href="#cb38-226" aria-hidden="true" tabindex="-1"></a>step_mode: StepMode              <span class="co"># FIXED or ADAPTIVE</span></span>
<span id="cb38-227"><a href="#cb38-227" aria-hidden="true" tabindex="-1"></a>backend: Backend                 <span class="co"># 'numpy', 'torch', or 'jax'</span></span>
<span id="cb38-228"><a href="#cb38-228" aria-hidden="true" tabindex="-1"></a>rtol: <span class="bu">float</span>                      <span class="co"># Relative error tolerance (adaptive methods)</span></span>
<span id="cb38-229"><a href="#cb38-229" aria-hidden="true" tabindex="-1"></a>atol: <span class="bu">float</span>                      <span class="co"># Absolute error tolerance (adaptive methods)</span></span>
<span id="cb38-230"><a href="#cb38-230" aria-hidden="true" tabindex="-1"></a>_stats: <span class="bu">dict</span>                     <span class="co"># Performance tracking</span></span>
<span id="cb38-231"><a href="#cb38-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-232"><a href="#cb38-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-233"><a href="#cb38-233" aria-hidden="true" tabindex="-1"></a>**Abstract methods required by all implementations:**</span>
<span id="cb38-234"><a href="#cb38-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-235"><a href="#cb38-235" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-236"><a href="#cb38-236" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step(<span class="va">self</span>, x: Array, u: Array, dt: <span class="bu">float</span>) <span class="op">-&gt;</span> Array:</span>
<span id="cb38-237"><a href="#cb38-237" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Single integration step: x(t) -&gt; x(t + dt)"""</span></span>
<span id="cb38-238"><a href="#cb38-238" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-239"><a href="#cb38-239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrate(</span>
<span id="cb38-240"><a href="#cb38-240" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>, </span>
<span id="cb38-241"><a href="#cb38-241" aria-hidden="true" tabindex="-1"></a>    x0: Array, </span>
<span id="cb38-242"><a href="#cb38-242" aria-hidden="true" tabindex="-1"></a>    u_func: Callable, </span>
<span id="cb38-243"><a href="#cb38-243" aria-hidden="true" tabindex="-1"></a>    t_span: <span class="bu">tuple</span>[<span class="bu">float</span>, <span class="bu">float</span>]</span>
<span id="cb38-244"><a href="#cb38-244" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> IntegrationResult:</span>
<span id="cb38-245"><a href="#cb38-245" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Multi-step integration over time interval"""</span></span>
<span id="cb38-246"><a href="#cb38-246" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-247"><a href="#cb38-247" aria-hidden="true" tabindex="-1"></a><span class="at">@property</span></span>
<span id="cb38-248"><a href="#cb38-248" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> name(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb38-249"><a href="#cb38-249" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Unique identifier for this integrator"""</span></span>
<span id="cb38-250"><a href="#cb38-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-251"><a href="#cb38-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-252"><a href="#cb38-252" aria-hidden="true" tabindex="-1"></a>**StepMode enumeration:**</span>
<span id="cb38-253"><a href="#cb38-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-254"><a href="#cb38-254" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`FIXED`</span>: Constant time step (euler, rk4, midpoint)</span>
<span id="cb38-255"><a href="#cb38-255" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ADAPTIVE`</span>: Variable time step with error control (RK45, dopri5, tsit5)</span>
<span id="cb38-256"><a href="#cb38-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-257"><a href="#cb38-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### IntegratorFactory: Smart Creation {#sec-integratorfactory}</span></span>
<span id="cb38-258"><a href="#cb38-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-259"><a href="#cb38-259" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`integrator_factory.py`</span></span>
<span id="cb38-260"><a href="#cb38-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-261"><a href="#cb38-261" aria-hidden="true" tabindex="-1"></a>The <span class="in">`IntegratorFactory`</span> provides intelligent integrator creation with automatic backend and method selection. It encapsulates the complexity of choosing appropriate integration methods based on system properties and use case requirements.</span>
<span id="cb38-262"><a href="#cb38-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-263"><a href="#cb38-263" aria-hidden="true" tabindex="-1"></a>**Integration with Method Registry:**</span>
<span id="cb38-264"><a href="#cb38-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-265"><a href="#cb38-265" aria-hidden="true" tabindex="-1"></a>The factory delegates method normalization and validation to the centralized <span class="in">`method_registry`</span>:</span>
<span id="cb38-266"><a href="#cb38-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-267"><a href="#cb38-267" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-268"><a href="#cb38-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Internally, IntegratorFactory.create() does:</span></span>
<span id="cb38-269"><a href="#cb38-269" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> normalize_method_name(method, backend)  <span class="co"># Registry function</span></span>
<span id="cb38-270"><a href="#cb38-270" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(method, backend, is_stochastic<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-271"><a href="#cb38-271" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_fixed_step(method) <span class="kw">and</span> dt <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb38-272"><a href="#cb38-272" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Fixed-step method requires dt"</span>)</span>
<span id="cb38-273"><a href="#cb38-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-274"><a href="#cb38-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-275"><a href="#cb38-275" aria-hidden="true" tabindex="-1"></a>**Julia Preference for NumPy Backend:**</span>
<span id="cb38-276"><a href="#cb38-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-277"><a href="#cb38-277" aria-hidden="true" tabindex="-1"></a>When using the NumPy backend, <span class="in">`IntegratorFactory`</span> automatically prefers Julia implementations for basic methods when DiffEqPy is available:</span>
<span id="cb38-278"><a href="#cb38-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-279"><a href="#cb38-279" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`euler`</span> → Julia's <span class="in">`Euler`</span> (better performance)</span>
<span id="cb38-280"><a href="#cb38-280" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`heun`</span> → Julia's <span class="in">`Heun`</span></span>
<span id="cb38-281"><a href="#cb38-281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`midpoint`</span> → Julia's <span class="in">`Midpoint`</span></span>
<span id="cb38-282"><a href="#cb38-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-283"><a href="#cb38-283" aria-hidden="true" tabindex="-1"></a>To explicitly use manual Python implementations:</span>
<span id="cb38-284"><a href="#cb38-284" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-285"><a href="#cb38-285" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.create(</span>
<span id="cb38-286"><a href="#cb38-286" aria-hidden="true" tabindex="-1"></a>    system, backend<span class="op">=</span><span class="st">'numpy'</span>, method<span class="op">=</span><span class="st">'euler'</span>, prefer_manual<span class="op">=</span><span class="va">True</span></span>
<span id="cb38-287"><a href="#cb38-287" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-288"><a href="#cb38-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-289"><a href="#cb38-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-290"><a href="#cb38-290" aria-hidden="true" tabindex="-1"></a>**Factory methods:**</span>
<span id="cb38-291"><a href="#cb38-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-292"><a href="#cb38-292" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-293"><a href="#cb38-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatic selection based on system and backend</span></span>
<span id="cb38-294"><a href="#cb38-294" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.auto(system, backend<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb38-295"><a href="#cb38-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-296"><a href="#cb38-296" aria-hidden="true" tabindex="-1"></a><span class="co"># Production use with auto-stiffness detection</span></span>
<span id="cb38-297"><a href="#cb38-297" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_production(system, <span class="op">**</span>options)</span>
<span id="cb38-298"><a href="#cb38-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-299"><a href="#cb38-299" aria-hidden="true" tabindex="-1"></a><span class="co"># High-performance Julia integration</span></span>
<span id="cb38-300"><a href="#cb38-300" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_julia(system, algorithm<span class="op">=</span><span class="st">'Tsit5'</span>, <span class="op">**</span>options)</span>
<span id="cb38-301"><a href="#cb38-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-302"><a href="#cb38-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Neural ODE training with adjoint gradients</span></span>
<span id="cb38-303"><a href="#cb38-303" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_neural_ode(system, <span class="op">**</span>options)</span>
<span id="cb38-304"><a href="#cb38-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-305"><a href="#cb38-305" aria-hidden="true" tabindex="-1"></a><span class="co"># JAX optimization workflows</span></span>
<span id="cb38-306"><a href="#cb38-306" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_optimization(system, <span class="op">**</span>options)</span>
<span id="cb38-307"><a href="#cb38-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-308"><a href="#cb38-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct method specification</span></span>
<span id="cb38-309"><a href="#cb38-309" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.create(system, backend, method, <span class="op">**</span>options)</span>
<span id="cb38-310"><a href="#cb38-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-311"><a href="#cb38-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-312"><a href="#cb38-312" aria-hidden="true" tabindex="-1"></a>**Method registry:**</span>
<span id="cb38-313"><a href="#cb38-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-314"><a href="#cb38-314" aria-hidden="true" tabindex="-1"></a>The factory uses the centralized method registry for mapping method names to backends and capabilities:</span>
<span id="cb38-315"><a href="#cb38-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-316"><a href="#cb38-316" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Method <span class="pp">|</span> Backend <span class="pp">|</span> Type <span class="pp">|</span> Order <span class="pp">|</span> Best For <span class="pp">|</span></span>
<span id="cb38-317"><a href="#cb38-317" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|---------|------|-------|----------|</span></span>
<span id="cb38-318"><a href="#cb38-318" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> LSODA <span class="pp">|</span> NumPy (scipy) <span class="pp">|</span> Adaptive <span class="pp">|</span> Variable <span class="pp">|</span> Automatic stiffness detection <span class="pp">|</span></span>
<span id="cb38-319"><a href="#cb38-319" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> RK45 <span class="pp">|</span> NumPy (scipy) <span class="pp">|</span> Adaptive <span class="pp">|</span> 5(4) <span class="pp">|</span> General non-stiff ODEs <span class="pp">|</span></span>
<span id="cb38-320"><a href="#cb38-320" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> DOP853 <span class="pp">|</span> NumPy (scipy) <span class="pp">|</span> Adaptive <span class="pp">|</span> 8(5,3) <span class="pp">|</span> High-accuracy requirements <span class="pp">|</span></span>
<span id="cb38-321"><a href="#cb38-321" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Radau <span class="pp">|</span> NumPy (scipy) <span class="pp">|</span> Adaptive <span class="pp">|</span> 5 <span class="pp">|</span> Stiff systems (implicit) <span class="pp">|</span></span>
<span id="cb38-322"><a href="#cb38-322" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> BDF <span class="pp">|</span> NumPy (scipy) <span class="pp">|</span> Adaptive <span class="pp">|</span> Variable <span class="pp">|</span> Very stiff systems <span class="pp">|</span></span>
<span id="cb38-323"><a href="#cb38-323" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Tsit5 <span class="pp">|</span> NumPy (Julia) <span class="pp">|</span> Adaptive <span class="pp">|</span> 5(4) <span class="pp">|</span> High performance <span class="pp">|</span></span>
<span id="cb38-324"><a href="#cb38-324" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Vern9 <span class="pp">|</span> NumPy (Julia) <span class="pp">|</span> Adaptive <span class="pp">|</span> 9(8) <span class="pp">|</span> Maximum accuracy <span class="pp">|</span></span>
<span id="cb38-325"><a href="#cb38-325" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Rodas5 <span class="pp">|</span> NumPy (Julia) <span class="pp">|</span> Adaptive <span class="pp">|</span> 5(4) <span class="pp">|</span> Stiff (Rosenbrock method) <span class="pp">|</span></span>
<span id="cb38-326"><a href="#cb38-326" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> dopri5 <span class="pp">|</span> PyTorch/JAX <span class="pp">|</span> Adaptive <span class="pp">|</span> 5(4) <span class="pp">|</span> Neural ODEs, GPU acceleration <span class="pp">|</span></span>
<span id="cb38-327"><a href="#cb38-327" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> dopri8 <span class="pp">|</span> PyTorch/JAX <span class="pp">|</span> Adaptive <span class="pp">|</span> 8 <span class="pp">|</span> High-accuracy neural ODEs <span class="pp">|</span></span>
<span id="cb38-328"><a href="#cb38-328" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> tsit5 <span class="pp">|</span> JAX (diffrax) <span class="pp">|</span> Adaptive <span class="pp">|</span> 5(4) <span class="pp">|</span> Optimization, XLA compilation <span class="pp">|</span></span>
<span id="cb38-329"><a href="#cb38-329" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> euler <span class="pp">|</span> Any <span class="pp">|</span> Fixed <span class="pp">|</span> 1 <span class="pp">|</span> Simple systems, education <span class="pp">|</span></span>
<span id="cb38-330"><a href="#cb38-330" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> heun <span class="pp">|</span> Any <span class="pp">|</span> Fixed <span class="pp">|</span> 2 <span class="pp">|</span> Improved Euler, predictor-corrector <span class="pp">|</span></span>
<span id="cb38-331"><a href="#cb38-331" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> midpoint <span class="pp">|</span> Any <span class="pp">|</span> Fixed <span class="pp">|</span> 2 <span class="pp">|</span> Second-order, midpoint evaluation <span class="pp">|</span></span>
<span id="cb38-332"><a href="#cb38-332" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> rk4 <span class="pp">|</span> Any <span class="pp">|</span> Fixed <span class="pp">|</span> 4 <span class="pp">|</span> Moderate accuracy, fixed step <span class="pp">|</span></span>
<span id="cb38-333"><a href="#cb38-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-334"><a href="#cb38-334" aria-hidden="true" tabindex="-1"></a><span class="fu">### ScipyIntegrator: Adaptive NumPy Integration {#sec-scipyintegrator}</span></span>
<span id="cb38-335"><a href="#cb38-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-336"><a href="#cb38-336" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`scipy_integrator.py`</span></span>
<span id="cb38-337"><a href="#cb38-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-338"><a href="#cb38-338" aria-hidden="true" tabindex="-1"></a>Wraps <span class="in">`scipy.integrate.solve_ivp`</span> to provide professional-grade adaptive integration with comprehensive error control. This is the recommended starting point for most NumPy-based applications.</span>
<span id="cb38-339"><a href="#cb38-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-340"><a href="#cb38-340" aria-hidden="true" tabindex="-1"></a>**Supported methods:**</span>
<span id="cb38-341"><a href="#cb38-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-342"><a href="#cb38-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RK45** (default): Dormand-Prince 5(4) — general purpose, good balance</span>
<span id="cb38-343"><a href="#cb38-343" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RK23**: Bogacki-Shampine 3(2) — fast, lower accuracy</span>
<span id="cb38-344"><a href="#cb38-344" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**DOP853**: Dormand-Prince 8(5,3) — very high accuracy</span>
<span id="cb38-345"><a href="#cb38-345" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Radau**: Implicit Runge-Kutta — stiff systems</span>
<span id="cb38-346"><a href="#cb38-346" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**BDF**: Backward differentiation formulas — very stiff systems</span>
<span id="cb38-347"><a href="#cb38-347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**LSODA**: Automatic stiffness detection — adapts to problem</span>
<span id="cb38-348"><a href="#cb38-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-349"><a href="#cb38-349" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-350"><a href="#cb38-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-351"><a href="#cb38-351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Professional adaptive time stepping with embedded error estimation</span>
<span id="cb38-352"><a href="#cb38-352" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Configurable error tolerances (<span class="in">`rtol`</span>, <span class="in">`atol`</span>)</span>
<span id="cb38-353"><a href="#cb38-353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dense output via continuous extension (interpolation between steps)</span>
<span id="cb38-354"><a href="#cb38-354" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Event detection for state-dependent conditions</span>
<span id="cb38-355"><a href="#cb38-355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Support for both controlled and autonomous systems</span>
<span id="cb38-356"><a href="#cb38-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-357"><a href="#cb38-357" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-358"><a href="#cb38-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-361"><a href="#cb38-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-362"><a href="#cb38-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-scipy</span></span>
<span id="cb38-363"><a href="#cb38-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-364"><a href="#cb38-364" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.scipy_integrator <span class="im">import</span> ScipyIntegrator</span>
<span id="cb38-365"><a href="#cb38-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-366"><a href="#cb38-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Create system</span></span>
<span id="cb38-367"><a href="#cb38-367" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-368"><a href="#cb38-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-369"><a href="#cb38-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Create adaptive integrator with tight tolerances</span></span>
<span id="cb38-370"><a href="#cb38-370" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> ScipyIntegrator(</span>
<span id="cb38-371"><a href="#cb38-371" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb38-372"><a href="#cb38-372" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'RK45'</span>,</span>
<span id="cb38-373"><a href="#cb38-373" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb38-374"><a href="#cb38-374" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-8</span></span>
<span id="cb38-375"><a href="#cb38-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-376"><a href="#cb38-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-377"><a href="#cb38-377" aria-hidden="true" tabindex="-1"></a><span class="co"># Integrate over time span</span></span>
<span id="cb38-378"><a href="#cb38-378" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])  <span class="co"># [angle, angular_velocity]</span></span>
<span id="cb38-379"><a href="#cb38-379" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)  <span class="co"># No control input</span></span>
<span id="cb38-380"><a href="#cb38-380" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-381"><a href="#cb38-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-382"><a href="#cb38-382" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Success: </span><span class="sc">{</span>result[<span class="st">'success'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-383"><a href="#cb38-383" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>result[<span class="st">'nfev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-384"><a href="#cb38-384" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps taken: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-385"><a href="#cb38-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-386"><a href="#cb38-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-387"><a href="#cb38-387" aria-hidden="true" tabindex="-1"></a>**When to use:**</span>
<span id="cb38-388"><a href="#cb38-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-389"><a href="#cb38-389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>General-purpose NumPy applications</span>
<span id="cb38-390"><a href="#cb38-390" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When you need reliable adaptive stepping</span>
<span id="cb38-391"><a href="#cb38-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Systems with unknown stiffness (use LSODA)</span>
<span id="cb38-392"><a href="#cb38-392" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When dense output is required</span>
<span id="cb38-393"><a href="#cb38-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-394"><a href="#cb38-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### TorchDiffEqIntegrator: GPU-Accelerated PyTorch {#sec-torchdiffeqintegrator}</span></span>
<span id="cb38-395"><a href="#cb38-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-396"><a href="#cb38-396" aria-hidden="true" tabindex="-1"></a>**File:** `torchdiffeq_integrator.py**</span>
<span id="cb38-397"><a href="#cb38-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-398"><a href="#cb38-398" aria-hidden="true" tabindex="-1"></a>Provides PyTorch integration with GPU acceleration and automatic differentiation support. Essential for neural ODE applications and gradient-based optimization.</span>
<span id="cb38-399"><a href="#cb38-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-400"><a href="#cb38-400" aria-hidden="true" tabindex="-1"></a>**Supported methods:**</span>
<span id="cb38-401"><a href="#cb38-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-402"><a href="#cb38-402" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**dopri5**: Dormand-Prince 5(4) — recommended default</span>
<span id="cb38-403"><a href="#cb38-403" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**dopri8**: Dormand-Prince 8 — high accuracy</span>
<span id="cb38-404"><a href="#cb38-404" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**adaptive_heun**: Heun's method — good for moderately stiff</span>
<span id="cb38-405"><a href="#cb38-405" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**bosh3**: Bogacki-Shampine 3 — fast, lower accuracy</span>
<span id="cb38-406"><a href="#cb38-406" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**fehlberg2**: Fehlberg 2(1) — very fast, low accuracy</span>
<span id="cb38-407"><a href="#cb38-407" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**explicit_adams**, **implicit_adams**: Multi-step methods</span>
<span id="cb38-408"><a href="#cb38-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-409"><a href="#cb38-409" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-410"><a href="#cb38-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-411"><a href="#cb38-411" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**GPU acceleration**: Automatic CUDA support for large-scale problems</span>
<span id="cb38-412"><a href="#cb38-412" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Automatic differentiation**: Seamless gradient computation through dynamics</span>
<span id="cb38-413"><a href="#cb38-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Adjoint method**: Memory-efficient backpropagation for neural ODEs</span>
<span id="cb38-414"><a href="#cb38-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Batch processing**: Vectorized integration of multiple trajectories</span>
<span id="cb38-415"><a href="#cb38-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-416"><a href="#cb38-416" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-417"><a href="#cb38-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-420"><a href="#cb38-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-421"><a href="#cb38-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-torch</span></span>
<span id="cb38-422"><a href="#cb38-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-423"><a href="#cb38-423" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.torchdiffeq_integrator <span class="im">import</span> TorchDiffEqIntegrator</span>
<span id="cb38-424"><a href="#cb38-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-425"><a href="#cb38-425" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-426"><a href="#cb38-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-427"><a href="#cb38-427" aria-hidden="true" tabindex="-1"></a><span class="co"># Create GPU-accelerated integrator</span></span>
<span id="cb38-428"><a href="#cb38-428" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> TorchDiffEqIntegrator(</span>
<span id="cb38-429"><a href="#cb38-429" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb38-430"><a href="#cb38-430" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'dopri5'</span>,</span>
<span id="cb38-431"><a href="#cb38-431" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'torch'</span>,</span>
<span id="cb38-432"><a href="#cb38-432" aria-hidden="true" tabindex="-1"></a>    device<span class="op">=</span><span class="st">'cpu'</span>,  <span class="co"># Use 'cuda:0' for GPU</span></span>
<span id="cb38-433"><a href="#cb38-433" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb38-434"><a href="#cb38-434" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-8</span></span>
<span id="cb38-435"><a href="#cb38-435" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-436"><a href="#cb38-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-437"><a href="#cb38-437" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> torch.tensor([<span class="fl">1.0</span>, <span class="fl">0.0</span>], requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-438"><a href="#cb38-438" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: torch.zeros(<span class="dv">1</span>)</span>
<span id="cb38-439"><a href="#cb38-439" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-440"><a href="#cb38-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-441"><a href="#cb38-441" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Solver: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-442"><a href="#cb38-442" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Integration time: </span><span class="sc">{</span>result[<span class="st">'integration_time'</span>]<span class="sc">:.4f}</span><span class="ss">s"</span>)</span>
<span id="cb38-443"><a href="#cb38-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-444"><a href="#cb38-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-445"><a href="#cb38-445" aria-hidden="true" tabindex="-1"></a>**When to use:**</span>
<span id="cb38-446"><a href="#cb38-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-447"><a href="#cb38-447" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Neural ODE training</span>
<span id="cb38-448"><a href="#cb38-448" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>GPU-accelerated simulations</span>
<span id="cb38-449"><a href="#cb38-449" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gradient-based optimization</span>
<span id="cb38-450"><a href="#cb38-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Large-scale batch processing</span>
<span id="cb38-451"><a href="#cb38-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-452"><a href="#cb38-452" aria-hidden="true" tabindex="-1"></a><span class="fu">### DiffraxIntegrator: JAX with XLA Compilation {#sec-diffraxintegrator}</span></span>
<span id="cb38-453"><a href="#cb38-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-454"><a href="#cb38-454" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`diffrax_integrator.py`</span></span>
<span id="cb38-455"><a href="#cb38-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-456"><a href="#cb38-456" aria-hidden="true" tabindex="-1"></a>Leverages JAX's diffrax library for high-performance integration with XLA compilation. Ideal for optimization workflows requiring extensive JIT compilation and functional transformations.</span>
<span id="cb38-457"><a href="#cb38-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-458"><a href="#cb38-458" aria-hidden="true" tabindex="-1"></a>**Supported methods:**</span>
<span id="cb38-459"><a href="#cb38-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-460"><a href="#cb38-460" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**tsit5**: Tsitouras 5(4) — recommended, efficient</span>
<span id="cb38-461"><a href="#cb38-461" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**dopri5**: Dormand-Prince 5(4) — standard reference</span>
<span id="cb38-462"><a href="#cb38-462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**dopri8**: Dormand-Prince 8 — high accuracy</span>
<span id="cb38-463"><a href="#cb38-463" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**heun**: Heun's method — simple, robust</span>
<span id="cb38-464"><a href="#cb38-464" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**ralston**: Ralston's method — improved stability</span>
<span id="cb38-465"><a href="#cb38-465" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**reversible_heun**: Time-reversible integration</span>
<span id="cb38-466"><a href="#cb38-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-467"><a href="#cb38-467" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-468"><a href="#cb38-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-469"><a href="#cb38-469" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**XLA compilation**: Near-C++ performance via just-in-time compilation</span>
<span id="cb38-470"><a href="#cb38-470" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**JAX transformations**: <span class="in">`jit`</span>, <span class="in">`vmap`</span>, <span class="in">`grad`</span>, <span class="in">`pmap`</span> all work seamlessly</span>
<span id="cb38-471"><a href="#cb38-471" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Functional style**: Pure functions enable advanced optimizations</span>
<span id="cb38-472"><a href="#cb38-472" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Efficient for optimization**: Fast repeated evaluations with parameter sweeps</span>
<span id="cb38-473"><a href="#cb38-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-474"><a href="#cb38-474" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-475"><a href="#cb38-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-478"><a href="#cb38-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-479"><a href="#cb38-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-jax</span></span>
<span id="cb38-480"><a href="#cb38-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-481"><a href="#cb38-481" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.diffrax_integrator <span class="im">import</span> DiffraxIntegrator</span>
<span id="cb38-482"><a href="#cb38-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-483"><a href="#cb38-483" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-484"><a href="#cb38-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-485"><a href="#cb38-485" aria-hidden="true" tabindex="-1"></a><span class="co"># Create JAX integrator</span></span>
<span id="cb38-486"><a href="#cb38-486" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffraxIntegrator(</span>
<span id="cb38-487"><a href="#cb38-487" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb38-488"><a href="#cb38-488" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'tsit5'</span>,</span>
<span id="cb38-489"><a href="#cb38-489" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'jax'</span>,</span>
<span id="cb38-490"><a href="#cb38-490" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-6</span>,</span>
<span id="cb38-491"><a href="#cb38-491" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-8</span></span>
<span id="cb38-492"><a href="#cb38-492" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-493"><a href="#cb38-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-494"><a href="#cb38-494" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb38-495"><a href="#cb38-495" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb38-496"><a href="#cb38-496" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-497"><a href="#cb38-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-498"><a href="#cb38-498" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-499"><a href="#cb38-499" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Success: </span><span class="sc">{</span>result[<span class="st">'success'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-500"><a href="#cb38-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-501"><a href="#cb38-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-502"><a href="#cb38-502" aria-hidden="true" tabindex="-1"></a>**When to use:**</span>
<span id="cb38-503"><a href="#cb38-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-504"><a href="#cb38-504" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parameter optimization requiring many integrations</span>
<span id="cb38-505"><a href="#cb38-505" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When you need <span class="in">`vmap`</span> for batch parameter sweeps</span>
<span id="cb38-506"><a href="#cb38-506" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gradient-based control optimization</span>
<span id="cb38-507"><a href="#cb38-507" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maximum computational efficiency</span>
<span id="cb38-508"><a href="#cb38-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-509"><a href="#cb38-509" aria-hidden="true" tabindex="-1"></a><span class="fu">### DiffEqPyIntegrator: Julia's Solver Ecosystem {#sec-diffeqpyintegrator}</span></span>
<span id="cb38-510"><a href="#cb38-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-511"><a href="#cb38-511" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`diffeqpy_integrator.py`</span></span>
<span id="cb38-512"><a href="#cb38-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-513"><a href="#cb38-513" aria-hidden="true" tabindex="-1"></a>Accesses Julia's extensive DifferentialEquations.jl ecosystem through Python bindings. Provides the most comprehensive method library with production-grade performance.</span>
<span id="cb38-514"><a href="#cb38-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-515"><a href="#cb38-515" aria-hidden="true" tabindex="-1"></a>**Supported method families:**</span>
<span id="cb38-516"><a href="#cb38-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-517"><a href="#cb38-517" aria-hidden="true" tabindex="-1"></a>**Explicit Runge-Kutta:**</span>
<span id="cb38-518"><a href="#cb38-518" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tsit5, Vern6, Vern7, Vern8, Vern9 — variable order adaptive</span>
<span id="cb38-519"><a href="#cb38-519" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>DP5, DP8 — Dormand-Prince variants</span>
<span id="cb38-520"><a href="#cb38-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-521"><a href="#cb38-521" aria-hidden="true" tabindex="-1"></a>**Rosenbrock (implicit for stiff):**</span>
<span id="cb38-522"><a href="#cb38-522" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rosenbrock23, Rosenbrock32, Rodas4, Rodas5</span>
<span id="cb38-523"><a href="#cb38-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-524"><a href="#cb38-524" aria-hidden="true" tabindex="-1"></a>**BDF methods:**</span>
<span id="cb38-525"><a href="#cb38-525" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>TRBDF2, KenCarp3, KenCarp4, KenCarp5</span>
<span id="cb38-526"><a href="#cb38-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-527"><a href="#cb38-527" aria-hidden="true" tabindex="-1"></a>**Specialized:**</span>
<span id="cb38-528"><a href="#cb38-528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>RadauIIA5 — implicit Runge-Kutta</span>
<span id="cb38-529"><a href="#cb38-529" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ROCK2, ROCK4 — stabilized methods</span>
<span id="cb38-530"><a href="#cb38-530" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>VelocityVerlet, SymplecticEuler — symplectic integrators</span>
<span id="cb38-531"><a href="#cb38-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-532"><a href="#cb38-532" aria-hidden="true" tabindex="-1"></a>**Auto-switching (composite):**</span>
<span id="cb38-533"><a href="#cb38-533" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AutoTsit5(Rosenbrock23()) — switches based on stiffness</span>
<span id="cb38-534"><a href="#cb38-534" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AutoVern7(Rodas5()) — high accuracy with stiffness handling</span>
<span id="cb38-535"><a href="#cb38-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-536"><a href="#cb38-536" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-537"><a href="#cb38-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-538"><a href="#cb38-538" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Highest performance**: Often 2-10× faster than SciPy</span>
<span id="cb38-539"><a href="#cb38-539" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Automatic stiffness detection**: Seamlessly switches solvers</span>
<span id="cb38-540"><a href="#cb38-540" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Extensive method library**: 100+ algorithms available</span>
<span id="cb38-541"><a href="#cb38-541" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Production reliability**: Battle-tested in scientific computing</span>
<span id="cb38-542"><a href="#cb38-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-543"><a href="#cb38-543" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-544"><a href="#cb38-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-547"><a href="#cb38-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-548"><a href="#cb38-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-julia</span></span>
<span id="cb38-549"><a href="#cb38-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-550"><a href="#cb38-550" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.diffeqpy_integrator <span class="im">import</span> DiffEqPyIntegrator</span>
<span id="cb38-551"><a href="#cb38-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-552"><a href="#cb38-552" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-553"><a href="#cb38-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-554"><a href="#cb38-554" aria-hidden="true" tabindex="-1"></a><span class="co"># Ultra-high accuracy Julia integration</span></span>
<span id="cb38-555"><a href="#cb38-555" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffEqPyIntegrator(</span>
<span id="cb38-556"><a href="#cb38-556" aria-hidden="true" tabindex="-1"></a>    system,</span>
<span id="cb38-557"><a href="#cb38-557" aria-hidden="true" tabindex="-1"></a>    algorithm<span class="op">=</span><span class="st">'Vern9'</span>,  <span class="co"># 9th order method</span></span>
<span id="cb38-558"><a href="#cb38-558" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'numpy'</span>,</span>
<span id="cb38-559"><a href="#cb38-559" aria-hidden="true" tabindex="-1"></a>    reltol<span class="op">=</span><span class="fl">1e-12</span>,</span>
<span id="cb38-560"><a href="#cb38-560" aria-hidden="true" tabindex="-1"></a>    abstol<span class="op">=</span><span class="fl">1e-14</span></span>
<span id="cb38-561"><a href="#cb38-561" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-562"><a href="#cb38-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-563"><a href="#cb38-563" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb38-564"><a href="#cb38-564" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb38-565"><a href="#cb38-565" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb38-566"><a href="#cb38-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-567"><a href="#cb38-567" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>result[<span class="st">'nfev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-568"><a href="#cb38-568" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Achieved accuracy: reltol=</span><span class="sc">{</span><span class="fl">1e-12</span><span class="sc">}</span><span class="ss">, abstol=</span><span class="sc">{</span><span class="fl">1e-14</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-569"><a href="#cb38-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-570"><a href="#cb38-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-571"><a href="#cb38-571" aria-hidden="true" tabindex="-1"></a>**When to use:**</span>
<span id="cb38-572"><a href="#cb38-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-573"><a href="#cb38-573" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maximum performance requirements</span>
<span id="cb38-574"><a href="#cb38-574" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Very stiff systems needing automatic detection</span>
<span id="cb38-575"><a href="#cb38-575" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High-accuracy applications (&gt;8 digits)</span>
<span id="cb38-576"><a href="#cb38-576" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Production environments with reliability requirements</span>
<span id="cb38-577"><a href="#cb38-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-578"><a href="#cb38-578" aria-hidden="true" tabindex="-1"></a><span class="fu">### FixedStepIntegrators: Educational and Simple Systems {#sec-fixedstepintegrators}</span></span>
<span id="cb38-579"><a href="#cb38-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-580"><a href="#cb38-580" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`fixed_step_integrators.py`</span></span>
<span id="cb38-581"><a href="#cb38-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-582"><a href="#cb38-582" aria-hidden="true" tabindex="-1"></a>Manual implementations of classic fixed-step methods. These provide transparent, backend-agnostic integration suitable for education and simple systems where adaptive stepping is unnecessary.</span>
<span id="cb38-583"><a href="#cb38-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-584"><a href="#cb38-584" aria-hidden="true" tabindex="-1"></a>**Available methods:**</span>
<span id="cb38-585"><a href="#cb38-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-586"><a href="#cb38-586" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**ExplicitEulerIntegrator**: Forward Euler (order 1) — simplest method</span>
<span id="cb38-587"><a href="#cb38-587" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**HeunIntegrator**: Heun's method / Improved Euler (order 2) — predictor-corrector approach</span>
<span id="cb38-588"><a href="#cb38-588" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MidpointIntegrator**: Midpoint method (order 2) — midpoint evaluation</span>
<span id="cb38-589"><a href="#cb38-589" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RK4Integrator**: Classic Runge-Kutta 4 (order 4) — excellent balance</span>
<span id="cb38-590"><a href="#cb38-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-591"><a href="#cb38-591" aria-hidden="true" tabindex="-1"></a>**HeunIntegrator:**</span>
<span id="cb38-592"><a href="#cb38-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-593"><a href="#cb38-593" aria-hidden="true" tabindex="-1"></a>Heun's method uses a predictor-corrector approach with trapezoidal averaging:</span>
<span id="cb38-594"><a href="#cb38-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-595"><a href="#cb38-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-596"><a href="#cb38-596" aria-hidden="true" tabindex="-1"></a><span class="in">k1 = f(x_k, u_k)                    # Predictor (Euler step)</span></span>
<span id="cb38-597"><a href="#cb38-597" aria-hidden="true" tabindex="-1"></a><span class="in">x_pred = x_k + dt * k1</span></span>
<span id="cb38-598"><a href="#cb38-598" aria-hidden="true" tabindex="-1"></a><span class="in">k2 = f(x_pred, u_k)                 # Corrector</span></span>
<span id="cb38-599"><a href="#cb38-599" aria-hidden="true" tabindex="-1"></a><span class="in">x_{k+1} = x_k + (dt/2) * (k1 + k2)  # Trapezoidal rule</span></span>
<span id="cb38-600"><a href="#cb38-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-601"><a href="#cb38-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-602"><a href="#cb38-602" aria-hidden="true" tabindex="-1"></a>Also known as Improved Euler or Explicit Trapezoid method. Uses 2 function evaluations per step for second-order accuracy.</span>
<span id="cb38-603"><a href="#cb38-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-604"><a href="#cb38-604" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-605"><a href="#cb38-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-606"><a href="#cb38-606" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Backend agnostic**: Work with NumPy, PyTorch, and JAX arrays</span>
<span id="cb38-607"><a href="#cb38-607" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Transparent implementation**: Clear, readable code for learning</span>
<span id="cb38-608"><a href="#cb38-608" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Constant time step**: Predictable computational cost</span>
<span id="cb38-609"><a href="#cb38-609" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**No external dependencies**: Pure Python implementations</span>
<span id="cb38-610"><a href="#cb38-610" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**TypedDict results**: All integrators return <span class="in">`IntegrationResult`</span> TypedDict</span>
<span id="cb38-611"><a href="#cb38-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-612"><a href="#cb38-612" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-613"><a href="#cb38-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-616"><a href="#cb38-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-617"><a href="#cb38-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-fixed</span></span>
<span id="cb38-618"><a href="#cb38-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-619"><a href="#cb38-619" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.fixed_step_integrators <span class="im">import</span> (</span>
<span id="cb38-620"><a href="#cb38-620" aria-hidden="true" tabindex="-1"></a>    RK4Integrator,</span>
<span id="cb38-621"><a href="#cb38-621" aria-hidden="true" tabindex="-1"></a>    HeunIntegrator,</span>
<span id="cb38-622"><a href="#cb38-622" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-623"><a href="#cb38-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-624"><a href="#cb38-624" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-625"><a href="#cb38-625" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb38-626"><a href="#cb38-626" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb38-627"><a href="#cb38-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-628"><a href="#cb38-628" aria-hidden="true" tabindex="-1"></a><span class="co"># RK4 with fixed time step (4 function evals/step)</span></span>
<span id="cb38-629"><a href="#cb38-629" aria-hidden="true" tabindex="-1"></a>rk4_integrator <span class="op">=</span> RK4Integrator(system, dt<span class="op">=</span><span class="fl">0.01</span>, backend<span class="op">=</span><span class="st">'numpy'</span>)</span>
<span id="cb38-630"><a href="#cb38-630" aria-hidden="true" tabindex="-1"></a>result_rk4 <span class="op">=</span> rk4_integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-631"><a href="#cb38-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-632"><a href="#cb38-632" aria-hidden="true" tabindex="-1"></a><span class="co"># Heun's method (2 function evals/step, predictor-corrector)</span></span>
<span id="cb38-633"><a href="#cb38-633" aria-hidden="true" tabindex="-1"></a>heun_integrator <span class="op">=</span> HeunIntegrator(system, dt<span class="op">=</span><span class="fl">0.01</span>, backend<span class="op">=</span><span class="st">'numpy'</span>)</span>
<span id="cb38-634"><a href="#cb38-634" aria-hidden="true" tabindex="-1"></a>result_heun <span class="op">=</span> heun_integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-635"><a href="#cb38-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-636"><a href="#cb38-636" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"RK4 - Steps: </span><span class="sc">{</span>result_rk4[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">, Solver: </span><span class="sc">{</span>result_rk4[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-637"><a href="#cb38-637" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Heun - Steps: </span><span class="sc">{</span>result_heun[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">, Solver: </span><span class="sc">{</span>result_heun[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-638"><a href="#cb38-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-639"><a href="#cb38-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-640"><a href="#cb38-640" aria-hidden="true" tabindex="-1"></a>**When to use:**</span>
<span id="cb38-641"><a href="#cb38-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-642"><a href="#cb38-642" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Educational purposes and learning</span>
<span id="cb38-643"><a href="#cb38-643" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Simple systems with smooth dynamics</span>
<span id="cb38-644"><a href="#cb38-644" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Real-time applications requiring predictable timing</span>
<span id="cb38-645"><a href="#cb38-645" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Debugging with deterministic stepping</span>
<span id="cb38-646"><a href="#cb38-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-647"><a href="#cb38-647" aria-hidden="true" tabindex="-1"></a><span class="fu">## Track 2: Stochastic SDE Integration {#sec-track-2}</span></span>
<span id="cb38-648"><a href="#cb38-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-649"><a href="#cb38-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### SDEIntegratorBase: Stochastic Abstract Interface {#sec-sdeintegratorbase}</span></span>
<span id="cb38-650"><a href="#cb38-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-651"><a href="#cb38-651" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`sde_integrator_base.py`</span></span>
<span id="cb38-652"><a href="#cb38-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-653"><a href="#cb38-653" aria-hidden="true" tabindex="-1"></a>Extends <span class="in">`IntegratorBase`</span> to handle stochastic differential equations of the form:</span>
<span id="cb38-654"><a href="#cb38-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-655"><a href="#cb38-655" aria-hidden="true" tabindex="-1"></a>$$dx = f(x, u, t)dt + g(x, u, t)dW$$</span>
<span id="cb38-656"><a href="#cb38-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-657"><a href="#cb38-657" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb38-658"><a href="#cb38-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-659"><a href="#cb38-659" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$f(x, u, t)$: Drift term (deterministic dynamics)</span>
<span id="cb38-660"><a href="#cb38-660" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$g(x, u, t)$: Diffusion term (stochastic intensity)</span>
<span id="cb38-661"><a href="#cb38-661" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$dW$: Brownian motion increments (Wiener process)</span>
<span id="cb38-662"><a href="#cb38-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-663"><a href="#cb38-663" aria-hidden="true" tabindex="-1"></a>**Key differences from deterministic integration:**</span>
<span id="cb38-664"><a href="#cb38-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-665"><a href="#cb38-665" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Random noise generation**: Requires proper Brownian motion sampling</span>
<span id="cb38-666"><a href="#cb38-666" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Convergence types**: </span>
<span id="cb38-667"><a href="#cb38-667" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Strong convergence**: Pathwise accuracy (Monte Carlo, control)</span>
<span id="cb38-668"><a href="#cb38-668" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Weak convergence**: Distribution accuracy (statistics)</span>
<span id="cb38-669"><a href="#cb38-669" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Noise structure exploitation**: Additive, diagonal, scalar, or general</span>
<span id="cb38-670"><a href="#cb38-670" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Multiple realizations**: Monte Carlo simulation support</span>
<span id="cb38-671"><a href="#cb38-671" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Interpretation**: Itô vs Stratonovich calculus</span>
<span id="cb38-672"><a href="#cb38-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-673"><a href="#cb38-673" aria-hidden="true" tabindex="-1"></a>**Additional abstract methods:**</span>
<span id="cb38-674"><a href="#cb38-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-675"><a href="#cb38-675" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-676"><a href="#cb38-676" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step(</span>
<span id="cb38-677"><a href="#cb38-677" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>, </span>
<span id="cb38-678"><a href="#cb38-678" aria-hidden="true" tabindex="-1"></a>    x: Array, </span>
<span id="cb38-679"><a href="#cb38-679" aria-hidden="true" tabindex="-1"></a>    u: Array, </span>
<span id="cb38-680"><a href="#cb38-680" aria-hidden="true" tabindex="-1"></a>    dt: <span class="bu">float</span>, </span>
<span id="cb38-681"><a href="#cb38-681" aria-hidden="true" tabindex="-1"></a>    dW: Array</span>
<span id="cb38-682"><a href="#cb38-682" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Array:</span>
<span id="cb38-683"><a href="#cb38-683" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Single SDE step with provided noise"""</span></span>
<span id="cb38-684"><a href="#cb38-684" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-685"><a href="#cb38-685" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrate_monte_carlo(</span>
<span id="cb38-686"><a href="#cb38-686" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>,</span>
<span id="cb38-687"><a href="#cb38-687" aria-hidden="true" tabindex="-1"></a>    x0: Array,</span>
<span id="cb38-688"><a href="#cb38-688" aria-hidden="true" tabindex="-1"></a>    u_func: Callable,</span>
<span id="cb38-689"><a href="#cb38-689" aria-hidden="true" tabindex="-1"></a>    t_span: <span class="bu">tuple</span>[<span class="bu">float</span>, <span class="bu">float</span>],</span>
<span id="cb38-690"><a href="#cb38-690" aria-hidden="true" tabindex="-1"></a>    n_paths: <span class="bu">int</span></span>
<span id="cb38-691"><a href="#cb38-691" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> SDEIntegrationResult:</span>
<span id="cb38-692"><a href="#cb38-692" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Multiple trajectory simulation for statistics"""</span></span>
<span id="cb38-693"><a href="#cb38-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-694"><a href="#cb38-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-695"><a href="#cb38-695" aria-hidden="true" tabindex="-1"></a><span class="fu">### SDEIntegratorFactory: SDE-Specific Creation {#sec-sdeintegratorfactory}</span></span>
<span id="cb38-696"><a href="#cb38-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-697"><a href="#cb38-697" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`sde_integrator_factory.py`</span></span>
<span id="cb38-698"><a href="#cb38-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-699"><a href="#cb38-699" aria-hidden="true" tabindex="-1"></a>Provides intelligent SDE integrator creation with automatic noise structure detection and method selection.</span>
<span id="cb38-700"><a href="#cb38-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-701"><a href="#cb38-701" aria-hidden="true" tabindex="-1"></a>**Integration with Method Registry:**</span>
<span id="cb38-702"><a href="#cb38-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-703"><a href="#cb38-703" aria-hidden="true" tabindex="-1"></a>Like <span class="in">`IntegratorFactory`</span>, the SDE factory delegates to the centralized <span class="in">`method_registry`</span> for method normalization and validation:</span>
<span id="cb38-704"><a href="#cb38-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-705"><a href="#cb38-705" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-706"><a href="#cb38-706" aria-hidden="true" tabindex="-1"></a><span class="co"># Internally, SDEIntegratorFactory.create() does:</span></span>
<span id="cb38-707"><a href="#cb38-707" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> normalize_method_name(method, backend)  <span class="co"># Registry function</span></span>
<span id="cb38-708"><a href="#cb38-708" aria-hidden="true" tabindex="-1"></a>is_valid, error <span class="op">=</span> validate_method(method, backend, is_stochastic<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-709"><a href="#cb38-709" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_fixed_step(method) <span class="kw">and</span> dt <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb38-710"><a href="#cb38-710" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Fixed-step SDE method requires dt"</span>)</span>
<span id="cb38-711"><a href="#cb38-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-712"><a href="#cb38-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-713"><a href="#cb38-713" aria-hidden="true" tabindex="-1"></a>**Factory methods:**</span>
<span id="cb38-714"><a href="#cb38-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-715"><a href="#cb38-715" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-716"><a href="#cb38-716" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatic selection based on noise structure</span></span>
<span id="cb38-717"><a href="#cb38-717" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.auto(sde_system, backend<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb38-718"><a href="#cb38-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-719"><a href="#cb38-719" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct method specification</span></span>
<span id="cb38-720"><a href="#cb38-720" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.create(</span>
<span id="cb38-721"><a href="#cb38-721" aria-hidden="true" tabindex="-1"></a>    sde_system, backend, method, dt, <span class="op">**</span>options</span>
<span id="cb38-722"><a href="#cb38-722" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-723"><a href="#cb38-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-724"><a href="#cb38-724" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimized for Monte Carlo simulations</span></span>
<span id="cb38-725"><a href="#cb38-725" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_monte_carlo(</span>
<span id="cb38-726"><a href="#cb38-726" aria-hidden="true" tabindex="-1"></a>    sde_system, noise_type<span class="op">=</span><span class="st">'general'</span>, <span class="op">**</span>options</span>
<span id="cb38-727"><a href="#cb38-727" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-728"><a href="#cb38-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-729"><a href="#cb38-729" aria-hidden="true" tabindex="-1"></a><span class="co"># Neural SDE training with adjoint</span></span>
<span id="cb38-730"><a href="#cb38-730" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_neural_sde(sde_system, adjoint<span class="op">=</span><span class="va">True</span>, <span class="op">**</span>options)</span>
<span id="cb38-731"><a href="#cb38-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-732"><a href="#cb38-732" aria-hidden="true" tabindex="-1"></a><span class="co"># Julia DiffEqPy SDE solvers</span></span>
<span id="cb38-733"><a href="#cb38-733" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_julia(sde_system, algorithm<span class="op">=</span><span class="st">'SRIW1'</span>, <span class="op">**</span>options)</span>
<span id="cb38-734"><a href="#cb38-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-735"><a href="#cb38-735" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient-based optimization</span></span>
<span id="cb38-736"><a href="#cb38-736" aria-hidden="true" tabindex="-1"></a>SDEIntegratorFactory.for_optimization(sde_system, backend<span class="op">=</span><span class="va">None</span>, <span class="op">**</span>options)</span>
<span id="cb38-737"><a href="#cb38-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-738"><a href="#cb38-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-739"><a href="#cb38-739" aria-hidden="true" tabindex="-1"></a>**Available SDE methods:**</span>
<span id="cb38-740"><a href="#cb38-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-741"><a href="#cb38-741" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Method <span class="pp">|</span> Backend <span class="pp">|</span> Convergence <span class="pp">|</span> Noise Type <span class="pp">|</span> Order <span class="pp">|</span></span>
<span id="cb38-742"><a href="#cb38-742" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|---------|-------------|------------|-------|</span></span>
<span id="cb38-743"><a href="#cb38-743" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> euler-maruyama <span class="pp">|</span> All <span class="pp">|</span> Strong 0.5 <span class="pp">|</span> General <span class="pp">|</span> 0.5 <span class="pp">|</span></span>
<span id="cb38-744"><a href="#cb38-744" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> milstein <span class="pp">|</span> PyTorch/NumPy <span class="pp">|</span> Strong 1.0 <span class="pp">|</span> Diagonal <span class="pp">|</span> 1.0 <span class="pp">|</span></span>
<span id="cb38-745"><a href="#cb38-745" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> reversible_heun <span class="pp">|</span> PyTorch/JAX <span class="pp">|</span> Strong 1.0 <span class="pp">|</span> Additive <span class="pp">|</span> 1.0 <span class="pp">|</span></span>
<span id="cb38-746"><a href="#cb38-746" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> adaptive_heun <span class="pp">|</span> PyTorch <span class="pp">|</span> Strong 1.0 <span class="pp">|</span> Additive <span class="pp">|</span> 1.0 (adaptive) <span class="pp">|</span></span>
<span id="cb38-747"><a href="#cb38-747" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> srk <span class="pp">|</span> PyTorch <span class="pp">|</span> Strong <span class="pp">|</span> General <span class="pp">|</span> Variable <span class="pp">|</span></span>
<span id="cb38-748"><a href="#cb38-748" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> midpoint <span class="pp">|</span> PyTorch <span class="pp">|</span> Strong <span class="pp">|</span> General <span class="pp">|</span> Variable <span class="pp">|</span></span>
<span id="cb38-749"><a href="#cb38-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-750"><a href="#cb38-750" aria-hidden="true" tabindex="-1"></a>**Noise structure types:**</span>
<span id="cb38-751"><a href="#cb38-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-752"><a href="#cb38-752" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Additive**: $g(x, u, t) = g(t)$ — diffusion independent of state</span>
<span id="cb38-753"><a href="#cb38-753" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Diagonal**: $g$ is diagonal matrix — independent noise channels</span>
<span id="cb38-754"><a href="#cb38-754" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Scalar**: $g$ is scalar — single noise source</span>
<span id="cb38-755"><a href="#cb38-755" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**General**: Full matrix $g$ — correlated noise</span>
<span id="cb38-756"><a href="#cb38-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-757"><a href="#cb38-757" aria-hidden="true" tabindex="-1"></a><span class="fu">### TorchSDEIntegrator: PyTorch SDE Integration {#sec-torchsdeintegrator}</span></span>
<span id="cb38-758"><a href="#cb38-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-759"><a href="#cb38-759" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`torchsde_integrator.py`</span></span>
<span id="cb38-760"><a href="#cb38-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-761"><a href="#cb38-761" aria-hidden="true" tabindex="-1"></a>GPU-accelerated SDE integration using the <span class="in">`torchsde`</span> library. Supports automatic differentiation through stochastic dynamics.</span>
<span id="cb38-762"><a href="#cb38-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-763"><a href="#cb38-763" aria-hidden="true" tabindex="-1"></a>**Supported methods:**</span>
<span id="cb38-764"><a href="#cb38-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-765"><a href="#cb38-765" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**euler**: Euler-Maruyama (strong order 0.5) — Itô and Stratonovich</span>
<span id="cb38-766"><a href="#cb38-766" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**milstein**: Milstein method (strong order 1.0 for diagonal noise) — Itô only</span>
<span id="cb38-767"><a href="#cb38-767" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**srk**: Stochastic Runge-Kutta (general noise) — Itô and Stratonovich</span>
<span id="cb38-768"><a href="#cb38-768" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**midpoint**: Midpoint method — Stratonovich only</span>
<span id="cb38-769"><a href="#cb38-769" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**reversible_heun**: Reversible Heun (strong order 1.0 for additive noise) — Stratonovich only</span>
<span id="cb38-770"><a href="#cb38-770" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**adaptive_heun**: Adaptive Heun with error control — Itô and Stratonovich</span>
<span id="cb38-771"><a href="#cb38-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-772"><a href="#cb38-772" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-773"><a href="#cb38-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-774"><a href="#cb38-774" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>GPU acceleration for large-scale stochastic simulations</span>
<span id="cb38-775"><a href="#cb38-775" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adaptive stepping with stochastic error control</span>
<span id="cb38-776"><a href="#cb38-776" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Noise structure exploitation for efficiency</span>
<span id="cb38-777"><a href="#cb38-777" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adjoint method for memory-efficient gradients through SDEs</span>
<span id="cb38-778"><a href="#cb38-778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SDE type compatibility**: Most methods support either Itô or Stratonovich (see method list)</span>
<span id="cb38-779"><a href="#cb38-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-780"><a href="#cb38-780" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-781"><a href="#cb38-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-784"><a href="#cb38-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-785"><a href="#cb38-785" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-torchsde</span></span>
<span id="cb38-786"><a href="#cb38-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-787"><a href="#cb38-787" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.torchsde_integrator <span class="im">import</span> TorchSDEIntegrator</span>
<span id="cb38-788"><a href="#cb38-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-789"><a href="#cb38-789" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Ornstein-Uhlenbeck process: dx = -α*x*dt + σ*dW</span></span>
<span id="cb38-790"><a href="#cb38-790" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-791"><a href="#cb38-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-792"><a href="#cb38-792" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> TorchSDEIntegrator(</span>
<span id="cb38-793"><a href="#cb38-793" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb38-794"><a href="#cb38-794" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'euler'</span>,  <span class="co"># Euler-Maruyama for Itô SDEs</span></span>
<span id="cb38-795"><a href="#cb38-795" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb38-796"><a href="#cb38-796" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'torch'</span></span>
<span id="cb38-797"><a href="#cb38-797" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-798"><a href="#cb38-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-799"><a href="#cb38-799" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> torch.tensor([<span class="fl">0.5</span>])</span>
<span id="cb38-800"><a href="#cb38-800" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: torch.zeros(<span class="dv">1</span>)</span>
<span id="cb38-801"><a href="#cb38-801" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-802"><a href="#cb38-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-803"><a href="#cb38-803" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Convergence type: </span><span class="sc">{</span>result[<span class="st">'convergence_type'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-804"><a href="#cb38-804" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"SDE type: </span><span class="sc">{</span>result[<span class="st">'sde_type'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-805"><a href="#cb38-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-806"><a href="#cb38-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-807"><a href="#cb38-807" aria-hidden="true" tabindex="-1"></a><span class="fu">### DiffraxSDEIntegrator: JAX SDE Integration {#sec-diffraxsdeintegrator}</span></span>
<span id="cb38-808"><a href="#cb38-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-809"><a href="#cb38-809" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`diffrax_sde_integrator.py`</span></span>
<span id="cb38-810"><a href="#cb38-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-811"><a href="#cb38-811" aria-hidden="true" tabindex="-1"></a>JAX-based SDE integration with XLA compilation and functional transformations. Excellent for optimization involving stochastic dynamics.</span>
<span id="cb38-812"><a href="#cb38-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-813"><a href="#cb38-813" aria-hidden="true" tabindex="-1"></a>**Supported methods:**</span>
<span id="cb38-814"><a href="#cb38-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-815"><a href="#cb38-815" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**euler**: Euler-Maruyama</span>
<span id="cb38-816"><a href="#cb38-816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**heun**: Heun's method (if supported by diffrax)</span>
<span id="cb38-817"><a href="#cb38-817" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**reversible_heun**: Time-reversible stochastic integration</span>
<span id="cb38-818"><a href="#cb38-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-819"><a href="#cb38-819" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-820"><a href="#cb38-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-821"><a href="#cb38-821" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>XLA compilation for near-C++ performance</span>
<span id="cb38-822"><a href="#cb38-822" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>JAX transformations (<span class="in">`jit`</span>, <span class="in">`vmap`</span>, <span class="in">`grad`</span>) work seamlessly</span>
<span id="cb38-823"><a href="#cb38-823" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Custom noise support for deterministic testing</span>
<span id="cb38-824"><a href="#cb38-824" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Efficient for stochastic optimization</span>
<span id="cb38-825"><a href="#cb38-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-826"><a href="#cb38-826" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-827"><a href="#cb38-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-830"><a href="#cb38-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-831"><a href="#cb38-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-diffraxsde</span></span>
<span id="cb38-832"><a href="#cb38-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-833"><a href="#cb38-833" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.diffrax_sde_integrator <span class="im">import</span> DiffraxSDEIntegrator</span>
<span id="cb38-834"><a href="#cb38-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-835"><a href="#cb38-835" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-836"><a href="#cb38-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-837"><a href="#cb38-837" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffraxSDEIntegrator(</span>
<span id="cb38-838"><a href="#cb38-838" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb38-839"><a href="#cb38-839" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'euler'</span>,</span>
<span id="cb38-840"><a href="#cb38-840" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb38-841"><a href="#cb38-841" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'jax'</span>,</span>
<span id="cb38-842"><a href="#cb38-842" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>SEED</span>
<span id="cb38-843"><a href="#cb38-843" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-844"><a href="#cb38-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-845"><a href="#cb38-845" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">0.5</span>])</span>
<span id="cb38-846"><a href="#cb38-846" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb38-847"><a href="#cb38-847" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-848"><a href="#cb38-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-849"><a href="#cb38-849" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-850"><a href="#cb38-850" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-851"><a href="#cb38-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-852"><a href="#cb38-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-853"><a href="#cb38-853" aria-hidden="true" tabindex="-1"></a><span class="fu">### DiffEqPySDEIntegrator: Julia SDE Integration {#sec-diffeqpysdeintegrator}</span></span>
<span id="cb38-854"><a href="#cb38-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-855"><a href="#cb38-855" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`diffeqpy_sde_integrator.py`</span></span>
<span id="cb38-856"><a href="#cb38-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-857"><a href="#cb38-857" aria-hidden="true" tabindex="-1"></a>Access to Julia's comprehensive SDE solver ecosystem through Python bindings.</span>
<span id="cb38-858"><a href="#cb38-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-859"><a href="#cb38-859" aria-hidden="true" tabindex="-1"></a>**Supported methods:**</span>
<span id="cb38-860"><a href="#cb38-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-861"><a href="#cb38-861" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Euler-Maruyama variants</span>
<span id="cb38-862"><a href="#cb38-862" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Milstein method</span>
<span id="cb38-863"><a href="#cb38-863" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stochastic Rosenbrock methods</span>
<span id="cb38-864"><a href="#cb38-864" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Advanced Julia SDE algorithms</span>
<span id="cb38-865"><a href="#cb38-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-866"><a href="#cb38-866" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-867"><a href="#cb38-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-868"><a href="#cb38-868" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Production-grade SDE solvers</span>
<span id="cb38-869"><a href="#cb38-869" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Automatic noise structure detection</span>
<span id="cb38-870"><a href="#cb38-870" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High-performance algorithms</span>
<span id="cb38-871"><a href="#cb38-871" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extensive method library</span>
<span id="cb38-872"><a href="#cb38-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-873"><a href="#cb38-873" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-874"><a href="#cb38-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-877"><a href="#cb38-877" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-878"><a href="#cb38-878" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-diffeqpysde</span></span>
<span id="cb38-879"><a href="#cb38-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-880"><a href="#cb38-880" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.diffeqpy_sde_integrator <span class="im">import</span> DiffEqPySDEIntegrator</span>
<span id="cb38-881"><a href="#cb38-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-882"><a href="#cb38-882" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-883"><a href="#cb38-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-884"><a href="#cb38-884" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffEqPySDEIntegrator(</span>
<span id="cb38-885"><a href="#cb38-885" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb38-886"><a href="#cb38-886" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'EM'</span>,  <span class="co"># Euler-Maruyama</span></span>
<span id="cb38-887"><a href="#cb38-887" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb38-888"><a href="#cb38-888" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'numpy'</span>,</span>
<span id="cb38-889"><a href="#cb38-889" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>SEED</span>
<span id="cb38-890"><a href="#cb38-890" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-891"><a href="#cb38-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-892"><a href="#cb38-892" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">0.5</span>])</span>
<span id="cb38-893"><a href="#cb38-893" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb38-894"><a href="#cb38-894" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-895"><a href="#cb38-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-896"><a href="#cb38-896" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Diffusion evaluations: </span><span class="sc">{</span>result[<span class="st">'diffusion_evals'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-897"><a href="#cb38-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-898"><a href="#cb38-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-899"><a href="#cb38-899" aria-hidden="true" tabindex="-1"></a><span class="fu">### CustomBrownianPath: Deterministic Noise for Testing {#sec-custombrownianpath}</span></span>
<span id="cb38-900"><a href="#cb38-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-901"><a href="#cb38-901" aria-hidden="true" tabindex="-1"></a>**File:** <span class="in">`custom_brownian.py`</span></span>
<span id="cb38-902"><a href="#cb38-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-903"><a href="#cb38-903" aria-hidden="true" tabindex="-1"></a>Provides custom Brownian motion paths for deterministic testing and reproducibility. Implements diffrax's <span class="in">`AbstractPath`</span> interface.</span>
<span id="cb38-904"><a href="#cb38-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-905"><a href="#cb38-905" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb38-906"><a href="#cb38-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-907"><a href="#cb38-907" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>User-provided noise increments</span>
<span id="cb38-908"><a href="#cb38-908" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Deterministic testing support</span>
<span id="cb38-909"><a href="#cb38-909" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Custom noise patterns (e.g., zero noise, specific realizations)</span>
<span id="cb38-910"><a href="#cb38-910" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compatible with diffrax integrators</span>
<span id="cb38-911"><a href="#cb38-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-912"><a href="#cb38-912" aria-hidden="true" tabindex="-1"></a>**Usage example:**</span>
<span id="cb38-913"><a href="#cb38-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-916"><a href="#cb38-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-917"><a href="#cb38-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-custombrown</span></span>
<span id="cb38-918"><a href="#cb38-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-919"><a href="#cb38-919" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jax <span class="im">import</span> random</span>
<span id="cb38-920"><a href="#cb38-920" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.custom_brownian <span class="im">import</span> (</span>
<span id="cb38-921"><a href="#cb38-921" aria-hidden="true" tabindex="-1"></a>    CustomBrownianPath, create_custom_or_random_brownian</span>
<span id="cb38-922"><a href="#cb38-922" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-923"><a href="#cb38-923" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.diffrax_sde_integrator <span class="im">import</span> DiffraxSDEIntegrator</span>
<span id="cb38-924"><a href="#cb38-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-925"><a href="#cb38-925" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-926"><a href="#cb38-926" aria-hidden="true" tabindex="-1"></a>nw <span class="op">=</span> sde_system.nw</span>
<span id="cb38-927"><a href="#cb38-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-928"><a href="#cb38-928" aria-hidden="true" tabindex="-1"></a><span class="co"># Zero noise for deterministic testing</span></span>
<span id="cb38-929"><a href="#cb38-929" aria-hidden="true" tabindex="-1"></a>dW <span class="op">=</span> jnp.zeros((nw,))</span>
<span id="cb38-930"><a href="#cb38-930" aria-hidden="true" tabindex="-1"></a>brownian <span class="op">=</span> CustomBrownianPath(t0<span class="op">=</span><span class="fl">0.0</span>, t1<span class="op">=</span><span class="fl">10.0</span>, dW<span class="op">=</span>dW)</span>
<span id="cb38-931"><a href="#cb38-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-932"><a href="#cb38-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Or generate random noise</span></span>
<span id="cb38-933"><a href="#cb38-933" aria-hidden="true" tabindex="-1"></a>key <span class="op">=</span> random.key(SEED)</span>
<span id="cb38-934"><a href="#cb38-934" aria-hidden="true" tabindex="-1"></a>brownian_random <span class="op">=</span> create_custom_or_random_brownian(</span>
<span id="cb38-935"><a href="#cb38-935" aria-hidden="true" tabindex="-1"></a>    key, t0<span class="op">=</span><span class="fl">0.0</span>, t1<span class="op">=</span><span class="fl">10.0</span>, shape<span class="op">=</span>(nw,), dW<span class="op">=</span><span class="va">None</span></span>
<span id="cb38-936"><a href="#cb38-936" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-937"><a href="#cb38-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-938"><a href="#cb38-938" aria-hidden="true" tabindex="-1"></a><span class="co"># Use in integration</span></span>
<span id="cb38-939"><a href="#cb38-939" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> DiffraxSDEIntegrator(sde_system, method<span class="op">=</span><span class="st">'euler'</span>, dt<span class="op">=</span><span class="fl">0.01</span>, backend<span class="op">=</span><span class="st">'jax'</span>)</span>
<span id="cb38-940"><a href="#cb38-940" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">0.5</span>])</span>
<span id="cb38-941"><a href="#cb38-941" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb38-942"><a href="#cb38-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-943"><a href="#cb38-943" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(</span>
<span id="cb38-944"><a href="#cb38-944" aria-hidden="true" tabindex="-1"></a>    x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), brownian_path<span class="op">=</span>brownian</span>
<span id="cb38-945"><a href="#cb38-945" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-946"><a href="#cb38-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-947"><a href="#cb38-947" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Deterministic SDE integration (zero noise)"</span>)</span>
<span id="cb38-948"><a href="#cb38-948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-949"><a href="#cb38-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-950"><a href="#cb38-950" aria-hidden="true" tabindex="-1"></a>**Important notes:**</span>
<span id="cb38-951"><a href="#cb38-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-952"><a href="#cb38-952" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Time span matching**: <span class="in">`CustomBrownianPath(t0, t1, dW)`</span> must match <span class="in">`t_span`</span></span>
<span id="cb38-953"><a href="#cb38-953" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Single dW for entire integration**: Unlike <span class="in">`step()`</span>, provide one <span class="in">`dW`</span> for the full interval</span>
<span id="cb38-954"><a href="#cb38-954" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Automatic interpolation**: Diffrax handles internal time queries</span>
<span id="cb38-955"><a href="#cb38-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-956"><a href="#cb38-956" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integration Result Types {#sec-result-types}</span></span>
<span id="cb38-957"><a href="#cb38-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-958"><a href="#cb38-958" aria-hidden="true" tabindex="-1"></a><span class="fu">### IntegrationResult (Deterministic ODEs) {#sec-integrationresult}</span></span>
<span id="cb38-959"><a href="#cb38-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-960"><a href="#cb38-960" aria-hidden="true" tabindex="-1"></a>All ODE integrators return a TypedDict with consistent fields:</span>
<span id="cb38-961"><a href="#cb38-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-962"><a href="#cb38-962" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-963"><a href="#cb38-963" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb38-964"><a href="#cb38-964" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t'</span>: array,              <span class="co"># Time points (T,)</span></span>
<span id="cb38-965"><a href="#cb38-965" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x'</span>: array,              <span class="co"># States (T, nx) - time-major format</span></span>
<span id="cb38-966"><a href="#cb38-966" aria-hidden="true" tabindex="-1"></a>    <span class="st">'success'</span>: <span class="bu">bool</span>,         <span class="co"># Integration succeeded</span></span>
<span id="cb38-967"><a href="#cb38-967" aria-hidden="true" tabindex="-1"></a>    <span class="st">'message'</span>: <span class="bu">str</span>,          <span class="co"># Status message</span></span>
<span id="cb38-968"><a href="#cb38-968" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nfev'</span>: <span class="bu">int</span>,             <span class="co"># Function evaluations</span></span>
<span id="cb38-969"><a href="#cb38-969" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nsteps'</span>: <span class="bu">int</span>,           <span class="co"># Steps taken</span></span>
<span id="cb38-970"><a href="#cb38-970" aria-hidden="true" tabindex="-1"></a>    <span class="st">'integration_time'</span>: <span class="bu">float</span>,  <span class="co"># Wall clock time (seconds)</span></span>
<span id="cb38-971"><a href="#cb38-971" aria-hidden="true" tabindex="-1"></a>    <span class="st">'solver'</span>: <span class="bu">str</span>,           <span class="co"># Integrator name</span></span>
<span id="cb38-972"><a href="#cb38-972" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-973"><a href="#cb38-973" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optional (adaptive methods only):</span></span>
<span id="cb38-974"><a href="#cb38-974" aria-hidden="true" tabindex="-1"></a>    <span class="st">'njev'</span>: <span class="bu">int</span>,             <span class="co"># Jacobian evaluations</span></span>
<span id="cb38-975"><a href="#cb38-975" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nlu'</span>: <span class="bu">int</span>,              <span class="co"># LU decompositions</span></span>
<span id="cb38-976"><a href="#cb38-976" aria-hidden="true" tabindex="-1"></a>    <span class="st">'status'</span>: <span class="bu">int</span>,           <span class="co"># Solver-specific status code</span></span>
<span id="cb38-977"><a href="#cb38-977" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sol'</span>: <span class="bu">object</span>,           <span class="co"># Dense output object (if requested)</span></span>
<span id="cb38-978"><a href="#cb38-978" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dense_output'</span>: <span class="bu">bool</span>,    <span class="co"># Dense output available</span></span>
<span id="cb38-979"><a href="#cb38-979" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-980"><a href="#cb38-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-981"><a href="#cb38-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-982"><a href="#cb38-982" aria-hidden="true" tabindex="-1"></a><span class="fu">### SDEIntegrationResult (Stochastic SDEs) {#sec-sdeintegrationresult}</span></span>
<span id="cb38-983"><a href="#cb38-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-984"><a href="#cb38-984" aria-hidden="true" tabindex="-1"></a>SDE integrators extend <span class="in">`IntegrationResult`</span> with stochastic-specific fields:</span>
<span id="cb38-985"><a href="#cb38-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-986"><a href="#cb38-986" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-987"><a href="#cb38-987" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb38-988"><a href="#cb38-988" aria-hidden="true" tabindex="-1"></a>    <span class="co"># All IntegrationResult fields, plus:</span></span>
<span id="cb38-989"><a href="#cb38-989" aria-hidden="true" tabindex="-1"></a>    <span class="st">'diffusion_evals'</span>: <span class="bu">int</span>,     <span class="co"># Diffusion function calls</span></span>
<span id="cb38-990"><a href="#cb38-990" aria-hidden="true" tabindex="-1"></a>    <span class="st">'noise_samples'</span>: array,     <span class="co"># Brownian increments used</span></span>
<span id="cb38-991"><a href="#cb38-991" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_paths'</span>: <span class="bu">int</span>,             <span class="co"># Number of trajectories</span></span>
<span id="cb38-992"><a href="#cb38-992" aria-hidden="true" tabindex="-1"></a>    <span class="st">'convergence_type'</span>: <span class="bu">str</span>,    <span class="co"># 'strong' or 'weak'</span></span>
<span id="cb38-993"><a href="#cb38-993" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sde_type'</span>: <span class="bu">str</span>,            <span class="co"># 'ito' or 'stratonovich'</span></span>
<span id="cb38-994"><a href="#cb38-994" aria-hidden="true" tabindex="-1"></a>    <span class="st">'noise_type'</span>: <span class="bu">str</span>,          <span class="co"># 'additive', 'diagonal', 'scalar', 'general'</span></span>
<span id="cb38-995"><a href="#cb38-995" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-996"><a href="#cb38-996" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For Monte Carlo (n_paths &gt; 1):</span></span>
<span id="cb38-997"><a href="#cb38-997" aria-hidden="true" tabindex="-1"></a>    <span class="st">'x'</span>: array,                 <span class="co"># (n_paths, T, nx)</span></span>
<span id="cb38-998"><a href="#cb38-998" aria-hidden="true" tabindex="-1"></a>    <span class="st">'statistics'</span>: <span class="bu">dict</span>,         <span class="co"># {'mean', 'std', 'q25', 'q50', 'q75'}</span></span>
<span id="cb38-999"><a href="#cb38-999" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-1000"><a href="#cb38-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1001"><a href="#cb38-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1002"><a href="#cb38-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical Usage Examples {#sec-usage-examples}</span></span>
<span id="cb38-1003"><a href="#cb38-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1004"><a href="#cb38-1004" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb38-1005"><a href="#cb38-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recommended Usage Pattern</span></span>
<span id="cb38-1006"><a href="#cb38-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1007"><a href="#cb38-1007" aria-hidden="true" tabindex="-1"></a>The examples below show **direct integrator instantiation for documentation purposes**. In practice, most users should use the system's <span class="in">`integrate()`</span> method which delegates to the appropriate integrator automatically:</span>
<span id="cb38-1008"><a href="#cb38-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1009"><a href="#cb38-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-1010"><a href="#cb38-1010" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended approach</span></span>
<span id="cb38-1011"><a href="#cb38-1011" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(x0<span class="op">=</span>x0, method<span class="op">=</span><span class="st">'RK45'</span>, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-1012"><a href="#cb38-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1013"><a href="#cb38-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced approach (shown in examples below)</span></span>
<span id="cb38-1014"><a href="#cb38-1014" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.auto(system)</span>
<span id="cb38-1015"><a href="#cb38-1015" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb38-1016"><a href="#cb38-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1017"><a href="#cb38-1017" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-1018"><a href="#cb38-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1019"><a href="#cb38-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 1: Recommended High-Level Interface</span></span>
<span id="cb38-1020"><a href="#cb38-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1023"><a href="#cb38-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-1024"><a href="#cb38-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-recommended</span></span>
<span id="cb38-1025"><a href="#cb38-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1026"><a href="#cb38-1026" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-1027"><a href="#cb38-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1028"><a href="#cb38-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># Most users should use this approach - system handles delegation</span></span>
<span id="cb38-1029"><a href="#cb38-1029" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">0.1</span>, <span class="fl">0.0</span>])</span>
<span id="cb38-1030"><a href="#cb38-1030" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(</span>
<span id="cb38-1031"><a href="#cb38-1031" aria-hidden="true" tabindex="-1"></a>    x0<span class="op">=</span>x0,</span>
<span id="cb38-1032"><a href="#cb38-1032" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'RK45'</span>,  <span class="co"># Optional: auto-selected if not specified</span></span>
<span id="cb38-1033"><a href="#cb38-1033" aria-hidden="true" tabindex="-1"></a>    t_span<span class="op">=</span>(<span class="fl">0.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb38-1034"><a href="#cb38-1034" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-1035"><a href="#cb38-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1036"><a href="#cb38-1036" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1037"><a href="#cb38-1037" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1038"><a href="#cb38-1038" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Success: </span><span class="sc">{</span>result[<span class="st">'success'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1039"><a href="#cb38-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1040"><a href="#cb38-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1041"><a href="#cb38-1041" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 2: Advanced - Direct Integrator Access</span></span>
<span id="cb38-1042"><a href="#cb38-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1045"><a href="#cb38-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-1046"><a href="#cb38-1046" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-quickstart</span></span>
<span id="cb38-1047"><a href="#cb38-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1048"><a href="#cb38-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced: Direct integrator instantiation for reuse or fine control</span></span>
<span id="cb38-1049"><a href="#cb38-1049" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-1050"><a href="#cb38-1050" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> IntegratorFactory.auto(system)</span>
<span id="cb38-1051"><a href="#cb38-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1052"><a href="#cb38-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># Can reuse integrator for multiple integrations</span></span>
<span id="cb38-1053"><a href="#cb38-1053" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">0.1</span>, <span class="fl">0.0</span>])</span>
<span id="cb38-1054"><a href="#cb38-1054" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb38-1055"><a href="#cb38-1055" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(x0, u_func, t_span<span class="op">=</span>(<span class="fl">0.0</span>, <span class="fl">10.0</span>))</span>
<span id="cb38-1056"><a href="#cb38-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1057"><a href="#cb38-1057" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method: </span><span class="sc">{</span>result[<span class="st">'solver'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1058"><a href="#cb38-1058" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Steps: </span><span class="sc">{</span>result[<span class="st">'nsteps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1059"><a href="#cb38-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1060"><a href="#cb38-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1061"><a href="#cb38-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 3: High-Accuracy Julia Integration</span></span>
<span id="cb38-1062"><a href="#cb38-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1065"><a href="#cb38-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-1066"><a href="#cb38-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-julia-accuracy</span></span>
<span id="cb38-1067"><a href="#cb38-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1068"><a href="#cb38-1068" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended: System-level interface</span></span>
<span id="cb38-1069"><a href="#cb38-1069" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-1070"><a href="#cb38-1070" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span>
<span id="cb38-1071"><a href="#cb38-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1072"><a href="#cb38-1072" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> system.integrate(</span>
<span id="cb38-1073"><a href="#cb38-1073" aria-hidden="true" tabindex="-1"></a>    x0<span class="op">=</span>x0,</span>
<span id="cb38-1074"><a href="#cb38-1074" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'Vern9'</span>,  <span class="co"># Julia's 9th order method</span></span>
<span id="cb38-1075"><a href="#cb38-1075" aria-hidden="true" tabindex="-1"></a>    rtol<span class="op">=</span><span class="fl">1e-12</span>,</span>
<span id="cb38-1076"><a href="#cb38-1076" aria-hidden="true" tabindex="-1"></a>    atol<span class="op">=</span><span class="fl">1e-14</span>,</span>
<span id="cb38-1077"><a href="#cb38-1077" aria-hidden="true" tabindex="-1"></a>    t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb38-1078"><a href="#cb38-1078" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-1079"><a href="#cb38-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1080"><a href="#cb38-1080" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>result[<span class="st">'nfev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1081"><a href="#cb38-1081" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Integration time: </span><span class="sc">{</span>result[<span class="st">'integration_time'</span>]<span class="sc">:.4f}</span><span class="ss">s"</span>)</span>
<span id="cb38-1082"><a href="#cb38-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1083"><a href="#cb38-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1084"><a href="#cb38-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 4: GPU-Accelerated Neural ODE</span></span>
<span id="cb38-1085"><a href="#cb38-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1088"><a href="#cb38-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-1089"><a href="#cb38-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-neural-ode</span></span>
<span id="cb38-1090"><a href="#cb38-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1091"><a href="#cb38-1091" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> Pendulum(m_val<span class="op">=</span><span class="fl">1.0</span>, l_val<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-1092"><a href="#cb38-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1093"><a href="#cb38-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># Switch to PyTorch backend for gradients</span></span>
<span id="cb38-1094"><a href="#cb38-1094" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> system.use_backend(<span class="st">'torch'</span>):</span>
<span id="cb38-1095"><a href="#cb38-1095" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> torch.tensor([<span class="fl">1.0</span>, <span class="fl">0.0</span>], requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-1096"><a href="#cb38-1096" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-1097"><a href="#cb38-1097" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> system.integrate(</span>
<span id="cb38-1098"><a href="#cb38-1098" aria-hidden="true" tabindex="-1"></a>        x0<span class="op">=</span>x0,</span>
<span id="cb38-1099"><a href="#cb38-1099" aria-hidden="true" tabindex="-1"></a>        method<span class="op">=</span><span class="st">'dopri5'</span>,</span>
<span id="cb38-1100"><a href="#cb38-1100" aria-hidden="true" tabindex="-1"></a>        device<span class="op">=</span><span class="st">'cpu'</span>,  <span class="co"># Use 'cuda:0' for GPU</span></span>
<span id="cb38-1101"><a href="#cb38-1101" aria-hidden="true" tabindex="-1"></a>        t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb38-1102"><a href="#cb38-1102" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-1103"><a href="#cb38-1103" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-1104"><a href="#cb38-1104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gradient computation works seamlessly</span></span>
<span id="cb38-1105"><a href="#cb38-1105" aria-hidden="true" tabindex="-1"></a>    final_state <span class="op">=</span> result[<span class="st">'x'</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-1106"><a href="#cb38-1106" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> final_state.<span class="bu">sum</span>()</span>
<span id="cb38-1107"><a href="#cb38-1107" aria-hidden="true" tabindex="-1"></a>    loss.backward()</span>
<span id="cb38-1108"><a href="#cb38-1108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-1109"><a href="#cb38-1109" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Gradient w.r.t. x0: </span><span class="sc">{</span>x0<span class="sc">.</span>grad<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1110"><a href="#cb38-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1111"><a href="#cb38-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1112"><a href="#cb38-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 5: Stochastic Simulation with Monte Carlo</span></span>
<span id="cb38-1113"><a href="#cb38-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1116"><a href="#cb38-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-1117"><a href="#cb38-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-monte-carlo</span></span>
<span id="cb38-1118"><a href="#cb38-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1119"><a href="#cb38-1119" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic <span class="im">import</span> get_trajectory_statistics</span>
<span id="cb38-1120"><a href="#cb38-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1121"><a href="#cb38-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># Create stochastic system</span></span>
<span id="cb38-1122"><a href="#cb38-1122" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-1123"><a href="#cb38-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1124"><a href="#cb38-1124" aria-hidden="true" tabindex="-1"></a><span class="co"># Use integrator for Monte Carlo (don't specify backend, it's handled internally)</span></span>
<span id="cb38-1125"><a href="#cb38-1125" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> SDEIntegratorFactory.for_monte_carlo(</span>
<span id="cb38-1126"><a href="#cb38-1126" aria-hidden="true" tabindex="-1"></a>    sde_system, n_paths<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb38-1127"><a href="#cb38-1127" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-1128"><a href="#cb38-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1129"><a href="#cb38-1129" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.array([<span class="fl">1.0</span>])</span>
<span id="cb38-1130"><a href="#cb38-1130" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: np.zeros(<span class="dv">1</span>)</span>
<span id="cb38-1131"><a href="#cb38-1131" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate_monte_carlo(</span>
<span id="cb38-1132"><a href="#cb38-1132" aria-hidden="true" tabindex="-1"></a>    x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), n_paths<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb38-1133"><a href="#cb38-1133" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-1134"><a href="#cb38-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1135"><a href="#cb38-1135" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract statistics</span></span>
<span id="cb38-1136"><a href="#cb38-1136" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> get_trajectory_statistics(result)</span>
<span id="cb38-1137"><a href="#cb38-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1138"><a href="#cb38-1138" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract scalar values from arrays</span></span>
<span id="cb38-1139"><a href="#cb38-1139" aria-hidden="true" tabindex="-1"></a>mean_final <span class="op">=</span> <span class="bu">float</span>(stats[<span class="st">'mean'</span>][<span class="op">-</span><span class="dv">1</span>].flat[<span class="dv">0</span>])</span>
<span id="cb38-1140"><a href="#cb38-1140" aria-hidden="true" tabindex="-1"></a>std_final <span class="op">=</span> <span class="bu">float</span>(stats[<span class="st">'std'</span>][<span class="op">-</span><span class="dv">1</span>].flat[<span class="dv">0</span>])</span>
<span id="cb38-1141"><a href="#cb38-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1142"><a href="#cb38-1142" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean at t=10: </span><span class="sc">{</span>mean_final<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-1143"><a href="#cb38-1143" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std at t=10: </span><span class="sc">{</span>std_final<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-1144"><a href="#cb38-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1145"><a href="#cb38-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1146"><a href="#cb38-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 6: Deterministic Testing with Custom Noise</span></span>
<span id="cb38-1147"><a href="#cb38-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1150"><a href="#cb38-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-1151"><a href="#cb38-1151" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ex-custom-noise</span></span>
<span id="cb38-1152"><a href="#cb38-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1153"><a href="#cb38-1153" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cdesym.systems.base.numerical_integration.stochastic.custom_brownian <span class="im">import</span> CustomBrownianPath</span>
<span id="cb38-1154"><a href="#cb38-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1155"><a href="#cb38-1155" aria-hidden="true" tabindex="-1"></a>sde_system <span class="op">=</span> OrnsteinUhlenbeck(alpha<span class="op">=</span><span class="fl">2.0</span>, sigma<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb38-1156"><a href="#cb38-1156" aria-hidden="true" tabindex="-1"></a>nw <span class="op">=</span> sde_system.nw</span>
<span id="cb38-1157"><a href="#cb38-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1158"><a href="#cb38-1158" aria-hidden="true" tabindex="-1"></a><span class="co"># Zero noise for deterministic testing</span></span>
<span id="cb38-1159"><a href="#cb38-1159" aria-hidden="true" tabindex="-1"></a>dW <span class="op">=</span> jnp.zeros((nw,))</span>
<span id="cb38-1160"><a href="#cb38-1160" aria-hidden="true" tabindex="-1"></a>brownian <span class="op">=</span> CustomBrownianPath(t0<span class="op">=</span><span class="fl">0.0</span>, t1<span class="op">=</span><span class="fl">10.0</span>, dW<span class="op">=</span>dW)</span>
<span id="cb38-1161"><a href="#cb38-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1162"><a href="#cb38-1162" aria-hidden="true" tabindex="-1"></a><span class="co"># Create JAX integrator</span></span>
<span id="cb38-1163"><a href="#cb38-1163" aria-hidden="true" tabindex="-1"></a>integrator <span class="op">=</span> SDEIntegratorFactory.create(</span>
<span id="cb38-1164"><a href="#cb38-1164" aria-hidden="true" tabindex="-1"></a>    sde_system,</span>
<span id="cb38-1165"><a href="#cb38-1165" aria-hidden="true" tabindex="-1"></a>    backend<span class="op">=</span><span class="st">'jax'</span>,</span>
<span id="cb38-1166"><a href="#cb38-1166" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="st">'Euler'</span>,</span>
<span id="cb38-1167"><a href="#cb38-1167" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.01</span>,</span>
<span id="cb38-1168"><a href="#cb38-1168" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>SEED</span>
<span id="cb38-1169"><a href="#cb38-1169" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-1170"><a href="#cb38-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1171"><a href="#cb38-1171" aria-hidden="true" tabindex="-1"></a><span class="co"># Integrate with custom noise</span></span>
<span id="cb38-1172"><a href="#cb38-1172" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> jnp.array([<span class="fl">0.5</span>])</span>
<span id="cb38-1173"><a href="#cb38-1173" aria-hidden="true" tabindex="-1"></a>u_func <span class="op">=</span> <span class="kw">lambda</span> t, x: jnp.zeros(<span class="dv">1</span>)</span>
<span id="cb38-1174"><a href="#cb38-1174" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> integrator.integrate(</span>
<span id="cb38-1175"><a href="#cb38-1175" aria-hidden="true" tabindex="-1"></a>    x0, u_func, t_span<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), brownian_path<span class="op">=</span>brownian</span>
<span id="cb38-1176"><a href="#cb38-1176" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-1177"><a href="#cb38-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1178"><a href="#cb38-1178" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Deterministic integration complete"</span>)</span>
<span id="cb38-1179"><a href="#cb38-1179" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Final state: </span><span class="sc">{</span>result[<span class="st">'x'</span>][<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1180"><a href="#cb38-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1181"><a href="#cb38-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1182"><a href="#cb38-1182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Integrator Selection Guide {#sec-selection-guide}</span></span>
<span id="cb38-1183"><a href="#cb38-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1184"><a href="#cb38-1184" aria-hidden="true" tabindex="-1"></a><span class="fu">### By Use Case</span></span>
<span id="cb38-1185"><a href="#cb38-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1186"><a href="#cb38-1186" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Use Case <span class="pp">|</span> Recommended Approach <span class="pp">|</span> Rationale <span class="pp">|</span></span>
<span id="cb38-1187"><a href="#cb38-1187" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|---------------------|-----------|</span></span>
<span id="cb38-1188"><a href="#cb38-1188" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> General ODE <span class="pp">|</span> <span class="in">`IntegratorFactory.for_production(system)`</span> <span class="pp">|</span> LSODA auto-stiffness detection <span class="pp">|</span></span>
<span id="cb38-1189"><a href="#cb38-1189" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Neural ODE <span class="pp">|</span> <span class="in">`IntegratorFactory.for_neural_ode(system)`</span> <span class="pp">|</span> Adjoint method for memory efficiency <span class="pp">|</span></span>
<span id="cb38-1190"><a href="#cb38-1190" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Optimization <span class="pp">|</span> <span class="in">`IntegratorFactory.for_optimization(system)`</span> <span class="pp">|</span> JAX with XLA compilation <span class="pp">|</span></span>
<span id="cb38-1191"><a href="#cb38-1191" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> High Accuracy <span class="pp">|</span> <span class="in">`IntegratorFactory.for_julia(system, 'Vern9')`</span> <span class="pp">|</span> Julia 9th order methods <span class="pp">|</span></span>
<span id="cb38-1192"><a href="#cb38-1192" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Stiff ODE <span class="pp">|</span> <span class="in">`ScipyIntegrator(system, method='BDF')`</span> <span class="pp">|</span> Backward differentiation <span class="pp">|</span></span>
<span id="cb38-1193"><a href="#cb38-1193" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Simple ODE <span class="pp">|</span> <span class="in">`RK4Integrator(system, dt=0.01)`</span> <span class="pp">|</span> Classic fixed-step <span class="pp">|</span></span>
<span id="cb38-1194"><a href="#cb38-1194" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> General SDE <span class="pp">|</span> <span class="in">`SDEIntegratorFactory.auto(sde_system)`</span> <span class="pp">|</span> Automatic noise detection <span class="pp">|</span></span>
<span id="cb38-1195"><a href="#cb38-1195" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Monte Carlo <span class="pp">|</span> <span class="in">`SDEIntegratorFactory.for_monte_carlo(...)`</span> <span class="pp">|</span> Parallelized trajectories <span class="pp">|</span></span>
<span id="cb38-1196"><a href="#cb38-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1197"><a href="#cb38-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">### By Backend Capabilities</span></span>
<span id="cb38-1198"><a href="#cb38-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1199"><a href="#cb38-1199" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Backend <span class="pp">|</span> ODE Integrator <span class="pp">|</span> SDE Integrator <span class="pp">|</span> Best For <span class="pp">|</span></span>
<span id="cb38-1200"><a href="#cb38-1200" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|---------------|----------------|----------|</span></span>
<span id="cb38-1201"><a href="#cb38-1201" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> NumPy <span class="pp">|</span> ScipyIntegrator, DiffEqPyIntegrator <span class="pp">|</span> DiffEqPySDEIntegrator <span class="pp">|</span> General purpose, highest compatibility <span class="pp">|</span></span>
<span id="cb38-1202"><a href="#cb38-1202" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> PyTorch <span class="pp">|</span> TorchDiffEqIntegrator <span class="pp">|</span> TorchSDEIntegrator <span class="pp">|</span> GPU acceleration, neural networks <span class="pp">|</span></span>
<span id="cb38-1203"><a href="#cb38-1203" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> JAX <span class="pp">|</span> DiffraxIntegrator <span class="pp">|</span> DiffraxSDEIntegrator <span class="pp">|</span> Optimization, functional programming <span class="pp">|</span></span>
<span id="cb38-1204"><a href="#cb38-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1205"><a href="#cb38-1205" aria-hidden="true" tabindex="-1"></a><span class="fu">### By System Properties</span></span>
<span id="cb38-1206"><a href="#cb38-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1207"><a href="#cb38-1207" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> System Type <span class="pp">|</span> Best Method <span class="pp">|</span> Convergence Order <span class="pp">|</span> Notes <span class="pp">|</span></span>
<span id="cb38-1208"><a href="#cb38-1208" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------------|-------------|-------------------|-------|</span></span>
<span id="cb38-1209"><a href="#cb38-1209" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Non-stiff <span class="pp">|</span> RK45, Tsit5, dopri5 <span class="pp">|</span> 5(4) <span class="pp">|</span> General purpose <span class="pp">|</span></span>
<span id="cb38-1210"><a href="#cb38-1210" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Stiff <span class="pp">|</span> BDF, Radau, Rodas5 <span class="pp">|</span> Variable <span class="pp">|</span> Implicit methods required <span class="pp">|</span></span>
<span id="cb38-1211"><a href="#cb38-1211" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Very stiff <span class="pp">|</span> BDF, LSODA <span class="pp">|</span> Variable <span class="pp">|</span> Automatic stiffness detection <span class="pp">|</span></span>
<span id="cb38-1212"><a href="#cb38-1212" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> High accuracy <span class="pp">|</span> Vern9, DOP853 <span class="pp">|</span> 9(8) or 8(5,3) <span class="pp">|</span> For precision-critical applications <span class="pp">|</span></span>
<span id="cb38-1213"><a href="#cb38-1213" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Real-time <span class="pp">|</span> RK4, euler <span class="pp">|</span> 4 or 1 <span class="pp">|</span> Fixed step, predictable timing <span class="pp">|</span></span>
<span id="cb38-1214"><a href="#cb38-1214" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Additive noise SDE <span class="pp">|</span> reversible_heun, adaptive_heun <span class="pp">|</span> 1.0 (strong) <span class="pp">|</span> Exploits simplified noise structure <span class="pp">|</span></span>
<span id="cb38-1215"><a href="#cb38-1215" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> General SDE <span class="pp">|</span> Euler-Maruyama <span class="pp">|</span> 0.5 (strong) <span class="pp">|</span> Robust for any noise type <span class="pp">|</span></span>
<span id="cb38-1216"><a href="#cb38-1216" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Diagonal noise SDE <span class="pp">|</span> Milstein <span class="pp">|</span> 1.0 (strong) <span class="pp">|</span> Higher order for independent channels <span class="pp">|</span></span>
<span id="cb38-1217"><a href="#cb38-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1218"><a href="#cb38-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">## Design Principles {#sec-design-principles}</span></span>
<span id="cb38-1219"><a href="#cb38-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1220"><a href="#cb38-1220" aria-hidden="true" tabindex="-1"></a><span class="fu">### Backend Abstraction</span></span>
<span id="cb38-1221"><a href="#cb38-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1222"><a href="#cb38-1222" aria-hidden="true" tabindex="-1"></a>All integrators provide consistent interfaces across computational backends. Switch between NumPy, PyTorch, and JAX without changing integration code:</span>
<span id="cb38-1223"><a href="#cb38-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1224"><a href="#cb38-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-1225"><a href="#cb38-1225" aria-hidden="true" tabindex="-1"></a><span class="co"># Same interface, different backends</span></span>
<span id="cb38-1226"><a href="#cb38-1226" aria-hidden="true" tabindex="-1"></a>integrator_numpy <span class="op">=</span> IntegratorFactory.auto(system, backend<span class="op">=</span><span class="st">'numpy'</span>)</span>
<span id="cb38-1227"><a href="#cb38-1227" aria-hidden="true" tabindex="-1"></a>integrator_torch <span class="op">=</span> IntegratorFactory.auto(system, backend<span class="op">=</span><span class="st">'torch'</span>)</span>
<span id="cb38-1228"><a href="#cb38-1228" aria-hidden="true" tabindex="-1"></a>integrator_jax <span class="op">=</span> IntegratorFactory.auto(system, backend<span class="op">=</span><span class="st">'jax'</span>)</span>
<span id="cb38-1229"><a href="#cb38-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1230"><a href="#cb38-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1231"><a href="#cb38-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factory Pattern for Complexity Management</span></span>
<span id="cb38-1232"><a href="#cb38-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1233"><a href="#cb38-1233" aria-hidden="true" tabindex="-1"></a>Factories encapsulate the complexity of choosing appropriate integrators:</span>
<span id="cb38-1234"><a href="#cb38-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1235"><a href="#cb38-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-1236"><a href="#cb38-1236" aria-hidden="true" tabindex="-1"></a><span class="co"># User specifies intent, factory handles details</span></span>
<span id="cb38-1237"><a href="#cb38-1237" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_production(system)  <span class="co"># → LSODA</span></span>
<span id="cb38-1238"><a href="#cb38-1238" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_neural_ode(system)  <span class="co"># → dopri5 with adjoint</span></span>
<span id="cb38-1239"><a href="#cb38-1239" aria-hidden="true" tabindex="-1"></a>IntegratorFactory.for_optimization(system)  <span class="co"># → tsit5 with JAX</span></span>
<span id="cb38-1240"><a href="#cb38-1240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1241"><a href="#cb38-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1242"><a href="#cb38-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Unified Result Types</span></span>
<span id="cb38-1243"><a href="#cb38-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1244"><a href="#cb38-1244" aria-hidden="true" tabindex="-1"></a>TypedDict results provide consistent structure with IDE support:</span>
<span id="cb38-1245"><a href="#cb38-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1246"><a href="#cb38-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-1247"><a href="#cb38-1247" aria-hidden="true" tabindex="-1"></a>result: IntegrationResult <span class="op">=</span> integrator.integrate(...)</span>
<span id="cb38-1248"><a href="#cb38-1248" aria-hidden="true" tabindex="-1"></a><span class="co"># IDE knows 'success', 'nfev', 'x', 't' are available</span></span>
<span id="cb38-1249"><a href="#cb38-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1250"><a href="#cb38-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1251"><a href="#cb38-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">### Composition Over Inheritance</span></span>
<span id="cb38-1252"><a href="#cb38-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1253"><a href="#cb38-1253" aria-hidden="true" tabindex="-1"></a>Integrators compose with systems rather than inheriting deeply:</span>
<span id="cb38-1254"><a href="#cb38-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1255"><a href="#cb38-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-1256"><a href="#cb38-1256" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Integrator:</span>
<span id="cb38-1257"><a href="#cb38-1257" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, system: ContinuousSystemBase):</span>
<span id="cb38-1258"><a href="#cb38-1258" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.system <span class="op">=</span> system  <span class="co"># Composition</span></span>
<span id="cb38-1259"><a href="#cb38-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1260"><a href="#cb38-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1261"><a href="#cb38-1261" aria-hidden="true" tabindex="-1"></a><span class="fu">### Built-in Performance Tracking</span></span>
<span id="cb38-1262"><a href="#cb38-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1263"><a href="#cb38-1263" aria-hidden="true" tabindex="-1"></a>All integrators track statistics automatically:</span>
<span id="cb38-1264"><a href="#cb38-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1265"><a href="#cb38-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb38-1266"><a href="#cb38-1266" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Function evaluations: </span><span class="sc">{</span>integrator<span class="sc">.</span>_stats[<span class="st">'total_fev'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1267"><a href="#cb38-1267" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Integration steps: </span><span class="sc">{</span>integrator<span class="sc">.</span>_stats[<span class="st">'total_steps'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-1268"><a href="#cb38-1268" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Computation time: </span><span class="sc">{</span>integrator<span class="sc">.</span>_stats[<span class="st">'total_time'</span>]<span class="sc">:.4f}</span><span class="ss">s"</span>)</span>
<span id="cb38-1269"><a href="#cb38-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-1270"><a href="#cb38-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1271"><a href="#cb38-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Strengths {#sec-strengths}</span></span>
<span id="cb38-1272"><a href="#cb38-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1273"><a href="#cb38-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Multi-backend support**: Seamless NumPy/PyTorch/JAX switching</span>
<span id="cb38-1274"><a href="#cb38-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Extensive method library**: 40+ integration methods across ODE and SDE</span>
<span id="cb38-1275"><a href="#cb38-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Centralized method registry**: Unified method normalization, validation, and discovery</span>
<span id="cb38-1276"><a href="#cb38-1276" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Canonical name support**: Use portable names (<span class="in">`euler_maruyama`</span>, <span class="in">`rk45`</span>) across backends</span>
<span id="cb38-1277"><a href="#cb38-1277" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Intelligent factories**: Automatic method selection based on system properties</span>
<span id="cb38-1278"><a href="#cb38-1278" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Type safety**: TypedDict results with full IDE support</span>
<span id="cb38-1279"><a href="#cb38-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**GPU acceleration**: First-class support via PyTorch and JAX</span>
<span id="cb38-1280"><a href="#cb38-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**XLA compilation**: Near-native performance with JAX</span>
<span id="cb38-1281"><a href="#cb38-1281" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>**Julia integration**: Access to world-class DifferentialEquations.jl ecosystem</span>
<span id="cb38-1282"><a href="#cb38-1282" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>**SDE support**: Comprehensive stochastic integration framework</span>
<span id="cb38-1283"><a href="#cb38-1283" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>**Noise exploitation**: Automatic detection and optimization for noise structure</span>
<span id="cb38-1284"><a href="#cb38-1284" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>**Monte Carlo**: Built-in multi-trajectory simulation</span>
<span id="cb38-1285"><a href="#cb38-1285" aria-hidden="true" tabindex="-1"></a><span class="ss">13. </span>**Custom noise**: Deterministic testing with user-provided Brownian paths</span>
<span id="cb38-1286"><a href="#cb38-1286" aria-hidden="true" tabindex="-1"></a><span class="ss">14. </span>**Production ready**: Professional error control and performance tracking</span>
<span id="cb38-1287"><a href="#cb38-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1288"><a href="#cb38-1288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb38-1289"><a href="#cb38-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-1290"><a href="#cb38-1290" aria-hidden="true" tabindex="-1"></a>The ControlDESymulation integration framework provides a comprehensive, production-ready solution for numerical integration across deterministic and stochastic systems. With support for multiple backends, extensive method libraries, and intelligent automation through factory patterns, it enables efficient development of control theory and machine learning applications requiring state-of-the-art numerical integration.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gilbenezer/ControlDESymulation/edit/main/architecture/Integration_Framework_Architecture.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gilbenezer/ControlDESymulation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>